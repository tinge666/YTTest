window.__require=function e(t,n,a){function o(r,c){if(!n[r]){if(!t[r]){var s=r.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+r+"'")}}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){return o(t[r][1][e]||e)},d,d.exports,e,t,n,a)}return n[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<a.length;r++)o(a[r]);return o}({AtlasCardView:[function(e,t,n){"use strict";cc._RF.push(t,"ea5b04NckRHaJThWrjHpb1+","AtlasCardView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("../../Common/DataManager"),i=e("../../Core/ResourcesManager"),r=e("../../Logic/PlantLogic"),c=e("../../Data/GardenData"),s=e("../Teach/TeachView"),l=e("../../Logic/TeachLogic"),d=e("../../Logic/AtlasLogic"),u=cc._decorator,p=u.ccclass,f=u.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inside=null,t.outside=null,t.pic=null,t.name1=null,t.name2=null,t.desc=null,t.detail=null,t.isAniPlaying=!1,t.isUnlock=!1,t}return __extends(t,e),t.prototype.start=function(){this.AddEvents()},t.prototype.Init=function(e,t,n){var a=this;this.isUnlock=n,this.inside.scaleX=0,this.outside.scaleX=1,this.isAniPlaying=!1,this.name1.string=t,this.name2.string=t;var d=o.default.instance.GetDescConfig(e);d?this.desc.string=d.desc:console.log("The current description does not exist:"+e),o.default.instance.GetDetailConfig(e)?this.detail.string=o.default.instance.GetDetailConfig(e).desc:console.log("The current detailed description does not exist:"+e),this.pic.node.active=!1,i.default.instance.load(e+".png",function(e){a.pic.node.active=!0,a.pic.spriteFrame=e},cc.SpriteFrame,!1,!1,r.default.instance.ShareRoot),n&&(2==c.default.data.level?this.closeCallBack=function(){o.default.instance.beginerStage=l.TeachStageEnum.UNLOCKPLANT,s.default.getInstance().then(function(e){e.ShowTeach()}),a.closeCallBack=null}:c.default.data.level==l.default.instance.buffUnlockLv?this.closeCallBack=function(){o.default.instance.beginerStage=l.TeachStageEnum.UNLOCKBUFF,s.default.getInstance().then(function(e){e.ShowTeach()}),a.closeCallBack=null}:c.default.data.level==l.default.instance.shopUnlockLv?this.closeCallBack=function(){o.default.instance.beginerStage=l.TeachStageEnum.UNLOCKSHOP,s.default.getInstance().then(function(e){e.ShowTeach()}),a.closeCallBack=null}:c.default.data.level==l.default.instance.rankUnlockLv&&(this.closeCallBack=function(){o.default.instance.beginerStage=l.TeachStageEnum.UNLOCKRANK,s.default.getInstance().then(function(e){e.ShowTeach()}),a.closeCallBack=null}))},t.prototype.AddEvents=function(){this.inside.getChildByName("TurnBtn").on(cc.Node.EventType.TOUCH_END,this.OnTurnOutBtnTap,this),this.outside.getChildByName("TurnBtn").on(cc.Node.EventType.TOUCH_END,this.OnTurnInBtnTap,this)},t.prototype.OnFlauntBtnTap=function(e){var t=this;this.pic.node.active&&(d.default.instance.Flaunt(this.pic.spriteFrame.getTexture().url,this.desc.string),this.isUnlock&&this.scheduleOnce(function(){t.OnCloseBtnTap(null)},1))},t.prototype.OnTurnOutBtnTap=function(e){var t=this;this.isAniPlaying||(this.isAniPlaying=!0,this.inside.scaleX=1,this.outside.scaleX=0,this.inside.runAction(cc.sequence(cc.scaleTo(.8,0,1).easing(cc.easeBackIn()),cc.callFunc(function(){t.outside.runAction(cc.sequence(cc.scaleTo(.8,1,1).easing(cc.easeBackOut()),cc.callFunc(function(){t.isAniPlaying=!1})))}))))},t.prototype.OnTurnInBtnTap=function(e){var t=this;this.isAniPlaying||(this.isAniPlaying=!0,this.outside.scaleX=1,this.inside.scaleX=0,this.outside.runAction(cc.sequence(cc.scaleTo(.5,0,1).easing(cc.easeBackIn()),cc.callFunc(function(){t.inside.runAction(cc.sequence(cc.scaleTo(.5,1,1).easing(cc.easeBackOut()),cc.callFunc(function(){t.isAniPlaying=!1})))}))))},__decorate([f({type:cc.Node,displayName:"\u6b63\u9875"})],t.prototype,"inside",void 0),__decorate([f({type:cc.Node,displayName:"\u80cc\u9762"})],t.prototype,"outside",void 0),__decorate([f({type:cc.Sprite,displayName:"\u690d\u7269\u56fe\u7247"})],t.prototype,"pic",void 0),__decorate([f({type:cc.Label,displayName:"\u690d\u7269\u540d\u79f01"})],t.prototype,"name1",void 0),__decorate([f({type:cc.Label,displayName:"\u690d\u7269\u540d\u79f02"})],t.prototype,"name2",void 0),__decorate([f({type:cc.Label,displayName:"\u690d\u7269\u7b80\u5355\u63cf\u8ff0"})],t.prototype,"desc",void 0),__decorate([f({type:cc.Label,displayName:"\u690d\u7269\u8be6\u7ec6\u63cf\u8ff0"})],t.prototype,"detail",void 0),t=__decorate([p],t)}(a.default);n.default=h,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Core/ResourcesManager":"ResourcesManager","../../Data/GardenData":"GardenData","../../Logic/AtlasLogic":"AtlasLogic","../../Logic/PlantLogic":"PlantLogic","../../Logic/TeachLogic":"TeachLogic","../Base/View":"View","../Teach/TeachView":"TeachView"}],AtlasItem:[function(e,t,n){"use strict";cc._RF.push(t,"3d3eepg/6hLR6rTVk5XvRO7","AtlasItem"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Core/ResourcesPool"),o=e("../../Core/ResourcesManager"),i=e("../../Logic/PlantLogic"),r=cc._decorator,c=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconBg=null,t.icon=null,t.lockSF=null,t.index=0,t.resId="",t.plantName="",t}return __extends(t,e),t.prototype.init=function(e,t,n,a){var r=this;void 0===n&&(n=""),void 0===a&&(a=""),console.log("Incoming number: "+n+" Incoming plant name:"+a),this.index=t,this.resId=n,this.plantName=a,e?(this.iconBg.setState(cc.Sprite.State.GRAY),this.icon.node.scale=1,this.icon.spriteFrame=this.lockSF):(this.iconBg.setState(cc.Sprite.State.NORMAL),this.icon.node.active=!1,o.default.instance.load(n+"_5",function(e){r.icon.node.active=!0,r.icon.node.scale=.7,r.icon.spriteFrame=e},cc.SpriteFrame,!1,!1,i.default.instance.FlowerRoot))},t.prototype.getKey=function(){return"AtlasItem"},t.prototype.awake=function(){this.node.active=!0},t.prototype.sleep=function(){this.node.active=!1},t.prototype.destroySelf=function(){a.default.instance.put(this,100)},__decorate([s({type:cc.Sprite,displayName:"\u56fe\u6807\u80cc\u666f"})],t.prototype,"iconBg",void 0),__decorate([s({type:cc.Sprite,displayName:"\u690d\u7269\u56fe\u6807"})],t.prototype,"icon",void 0),__decorate([s({type:cc.SpriteFrame,displayName:"\u9501\u4f4f\u56fe\u6807"})],t.prototype,"lockSF",void 0),t=__decorate([c],t)}(cc.Component);n.default=l,cc._RF.pop()},{"../../Core/ResourcesManager":"ResourcesManager","../../Core/ResourcesPool":"ResourcesPool","../../Logic/PlantLogic":"PlantLogic"}],AtlasLogic:[function(e,t,n){"use strict";cc._RF.push(t,"435f0rJyK9Bs6MsdETu9uDG","AtlasLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Data/GardenData"),o=e("../UI/UIManager"),i=e("../Common/DataManager"),r=e("../Core/ShareLogic"),c=e("../Core/GameHelper"),s=function(){function e(){this.atlasIds=[]}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e,this._instance.Init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.AddAtlasId=function(e,t,n){this.atlasIds.push(e),this.OpenAtlasCardView(t,n,!0)},e.prototype.OpenAtlasCardView=function(e,t,n){void 0===n&&(n=!1),o.default.instance.OpenView(o.ViewName.AtlasCardView,function(a){a.Init(e,t,n)})},e.prototype.Init=function(){for(var e=i.default.instance.PlantCnf.filter(function(e){return e.ul<=a.default.data.level}),t=0;t<e.length;++t)this.atlasIds.push(e[t].id)},e.prototype.Flaunt=function(e,t){var n="";n=cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(e):e;var a=r.default.instance.GetShareConfig(r.ShareTypeEnum.FLAUNT);a.title=t,wx.env?a.pic=wx.env.USER_DATA_PATH+"/"+n:a.pic=n,c.default.Log("\u5206\u4eab\u56fe\u7247Url:"+n),r.default.instance.Share(r.ShareTypeEnum.FLAUNT,a)},e}();n.default=s,cc._RF.pop()},{"../Common/DataManager":"DataManager","../Core/GameHelper":"GameHelper","../Core/ShareLogic":"ShareLogic","../Data/GardenData":"GardenData","../UI/UIManager":"UIManager"}],AtlasView:[function(e,t,n){"use strict";cc._RF.push(t,"8c2aaIs7eZK25EPVtrAIqGn","AtlasView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("./AtlasItem"),i=e("../../Core/ResourcesPool"),r=e("../../Core/GameHelper"),c=e("../../Core/ResourcesManager"),s=e("../../Common/PrefabID"),l=e("../../Common/EventID"),d=e("../../Common/DataManager"),u=e("../../Logic/AtlasLogic"),p=e("../../Logic/PlantLogic"),f=e("../../Data/GardenData"),h=cc._decorator,g=h.ccclass,m=h.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.content=null,t.detailBtn=null,t.unlockTxt=null,t.seled=null,t.plantName=null,t.plantDesc=null,t.plantIcon=null,t.isAutoSel=!1,t.items=[],t.curResId="",t.curPlantName="",t}return __extends(t,e),t.prototype.start=function(){this.AddEvents(),this.content.height=140*Math.ceil(d.default.instance.PlantCnf.length/4),this.seled.zIndex=999},t.prototype.onEnable=function(){e.prototype.onEnable.call(this);var t=d.default.instance.PlantCnf;this.unlockTxt.string="Unlock progress "+t.filter(function(e){return e.ul<=f.default.data.level}).length+"/"+t.length,this.isAutoSel=!0,this.scrollView.scrollToTop(),this.OnScrolling(null)},t.prototype.AddEvents=function(){this.scrollView.node.on(l.default.scrolling,this.OnScrolling,this),this.content.on(cc.Node.EventType.TOUCH_END,this.OnContentTap,this),this.detailBtn.node.on(cc.Node.EventType.TOUCH_END,this.OnDetailBtnTap,this)},t.prototype.OnScrolling=function(e){for(var t=this,n=function(e){var n=Math.floor(e/4);a.content.y-.5*a.scrollView.node.height>140*n+150||a.content.y+.5*a.scrollView.node.height<140*n-10?a.items[e]&&(r.default.Log("Swipe to remove item"),a.items[e].destroySelf(),a.items[e]=null):a.items[e]||(r.default.Log("Swipe to add items"),a.GetAtlasItem().then(function(a){t.items[e]=a,-1==u.default.instance.atlasIds.indexOf(d.default.instance.PlantCnf[e].id)?t.items[e].init(!0,e):t.items[e].init(!1,e,d.default.instance.PlantCnf[e].res,d.default.instance.PlantCnf[e].name),t.items[e].node.parent||t.content.addChild(t.items[e].node),t.items[e].node.x=e%4*135-202,t.items[e].node.y=140*-n-70,t.isAutoSel&&0==e&&(t.isAutoSel=!1,t.SelResId(0))}))},a=this,o=0;o<d.default.instance.PlantCnf.length;++o)n(o)},t.prototype.OnContentTap=function(e){for(var t in this.items)this.items[t]&&""!=this.items[t].resId&&this.items[t].node.getBoundingBoxToWorld().contains(e.getLocation())&&(console.log("Currently selected",this.items[t].plantName),this.SelResId(this.items[t].index))},t.prototype.OnFlauntBtnTap=function(e){var t=this;SDK.showLoading("Loading",!0),c.default.instance.load(this.curResId+".png",function(e){SDK.hideLoading(),u.default.instance.Flaunt(e.getTexture().url,t.plantDesc.string)},cc.SpriteFrame,!1,!1,p.default.instance.ShareRoot)},t.prototype.OnDetailBtnTap=function(e){u.default.instance.OpenAtlasCardView(this.curResId,this.curPlantName)},t.prototype.SelResId=function(e){var t=this;this.items[e]&&(this.curResId=this.items[e].resId,this.curPlantName=this.items[e].plantName,this.plantName.string=this.curPlantName,this.plantIcon.node.active=!1,c.default.instance.load(this.curResId+"_5",function(e){t.plantIcon.node.active=!0,t.plantIcon.spriteFrame=e},cc.SpriteFrame,!1,!1,p.default.instance.FlowerRoot),this.plantDesc.string=d.default.instance.GetDescConfig(this.curResId).desc,this.seled.position=this.items[e].node.position)},t.prototype.GetAtlasItem=function(){return __awaiter(this,void 0,Promise,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return(e=i.default.instance.get("AtlasItem"))?[3,2]:[4,c.default.instance.load(s.default.AtlasItem,function(t){e=t.getComponent(o.default)})];case 1:return t.sent(),this.content.addChild(e.node,0),[3,3];case 2:r.default.Log("Use old items"),t.label=3;case 3:return[2,e]}})})},__decorate([m({type:cc.ScrollView,displayName:"\u5212\u52a8\u5217\u8868"})],t.prototype,"scrollView",void 0),__decorate([m({type:cc.Node,displayName:"\u5217\u8868\u5185\u5bb9"})],t.prototype,"content",void 0),__decorate([m({type:cc.Button,displayName:"\u8be6\u60c5\u6309\u94ae"})],t.prototype,"detailBtn",void 0),__decorate([m({type:cc.Label,displayName:"\u89e3\u9501\u8fdb\u5ea6"})],t.prototype,"unlockTxt",void 0),__decorate([m({type:cc.Node,displayName:"\u9009\u4e2d\u56fe\u9274\u6807\u8bc6"})],t.prototype,"seled",void 0),__decorate([m({type:cc.Label,displayName:"\u690d\u7269\u540d\u79f0"})],t.prototype,"plantName",void 0),__decorate([m({type:cc.Label,displayName:"\u690d\u7269\u63cf\u8ff0"})],t.prototype,"plantDesc",void 0),__decorate([m({type:cc.Sprite,displayName:"\u690d\u7269\u56fe\u6807"})],t.prototype,"plantIcon",void 0),t=__decorate([g],t)}(a.default);n.default=y,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Common/EventID":"EventID","../../Common/PrefabID":"PrefabID","../../Core/GameHelper":"GameHelper","../../Core/ResourcesManager":"ResourcesManager","../../Core/ResourcesPool":"ResourcesPool","../../Data/GardenData":"GardenData","../../Logic/AtlasLogic":"AtlasLogic","../../Logic/PlantLogic":"PlantLogic","../Base/View":"View","./AtlasItem":"AtlasItem"}],Base64:[function(e,t,n){"use strict";cc._RF.push(t,"a4f2eIioQ5PWaIy3OQ+iTo1","Base64");var a={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,o,i,r,c,s,l="",d=0;for(e=a._utf8_encode(e);d<e.length;)i=(t=e.charCodeAt(d++))>>2,r=(3&t)<<4|(n=e.charCodeAt(d++))>>4,c=(15&n)<<2|(o=e.charCodeAt(d++))>>6,s=63&o,isNaN(n)?c=s=64:isNaN(o)&&(s=64),l=l+this._keyStr.charAt(i)+this._keyStr.charAt(r)+this._keyStr.charAt(c)+this._keyStr.charAt(s);return l},decode:function(e){var t,n,o,i,r,c,s="",l=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");l<e.length;)t=this._keyStr.indexOf(e.charAt(l++))<<2|(i=this._keyStr.indexOf(e.charAt(l++)))>>4,n=(15&i)<<4|(r=this._keyStr.indexOf(e.charAt(l++)))>>2,o=(3&r)<<6|(c=this._keyStr.indexOf(e.charAt(l++))),s+=String.fromCharCode(t),64!=r&&(s+=String.fromCharCode(n)),64!=c&&(s+=String.fromCharCode(o));return s=a._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t+=String.fromCharCode(a):a>127&&a<2048?(t+=String.fromCharCode(a>>6|192),t+=String.fromCharCode(63&a|128)):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128),t+=String.fromCharCode(63&a|128))}return t},_utf8_decode:function(e){for(var t="",n=0,a=0,o=0;n<e.length;)(a=e.charCodeAt(n))<128?(t+=String.fromCharCode(a),n++):a>191&&a<224?(o=e.charCodeAt(n+1),t+=String.fromCharCode((31&a)<<6|63&o),n+=2):(o=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&a)<<12|(63&o)<<6|63&c3),n+=3);return t}};window.Base64=t.exports=a,cc._RF.pop()},{}],BgSoundClip:[function(e,t,n){"use strict";cc._RF.push(t,"55b43/MlypGNavaonI/Czvm","BgSoundClip"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=cc._decorator,i=o.ccclass,r=o.property;(function(e){e[e.none=0]="none",e[e.main=1]="main",e[e.level1=2]="level1",e[e.level2=3]="level2",e[e.level3=4]="level3"})(a=n.BgSoundClipType||(n.BgSoundClipType={}));var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clipName="",t.type=a.none,t.clip=null,t}return __extends(t,e),__decorate([r(cc.String)],t.prototype,"clipName",void 0),__decorate([r({type:cc.Enum(a)})],t.prototype,"type",void 0),__decorate([r({type:cc.AudioClip})],t.prototype,"clip",void 0),t=__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{}],BottomToolBar:[function(e,t,n){"use strict";cc._RF.push(t,"f829eJV62FIwaEfxolpaRF3","BottomToolBar"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../../Sound/SoundManager"),i=e("../UIManager"),r=e("../../Logic/GardenLogic"),c=e("../../Sound/SoundClip"),s=e("../../Data/GardenData"),l=e("../../Logic/EconomicLogic"),d=e("../Shop/ShopView"),u=e("../../Logic/BuffLogic"),p=e("../../Data/BuffData"),f=e("../../Common/DataManager"),h=e("../../Logic/PlantLogic"),g=e("../../Core/GameHelper"),m=e("../../Data/PlantData");(function(e){e[e.PLANT=0]="PLANT",e[e.BUFF=1]="BUFF",e[e.SHOP=2]="SHOP",e[e.RANK=3]="RANK",e[e.NONE=4]="NONE"})(a=n.BottomBtnEnum||(n.BottomBtnEnum={}));var y=cc._decorator,v=y.ccclass,_=y.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.productNode=null,t.placeNode=null,t.signinBtn=null,t.btns=[],t.backBtn=null,t.storeBtn=null,t.storeNumTxt=null,t.mask=null,t.openViewType=a.NONE,t.storeNum=0,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n._instance=this},t.prototype.start=function(){var e=s.default.data.plants.filter(function(e){return-1==e.pos}).length;e>0&&this.ChangeStoreNum(e),this.Update(),this.AddEvents(),u.default.instance,this.RefreshRedDot()},t.prototype.AddEvents=function(){this.signinBtn.on(cc.Node.EventType.TOUCH_END,this.OnSigninBtnTap,this),this.backBtn.on(cc.Node.EventType.TOUCH_END,this.OnBackBtnTap,this),this.storeBtn.on(cc.Node.EventType.TOUCH_END,this.OnStoreBtnTap,this),this.mask.on(cc.Node.EventType.TOUCH_END,this.OnMaskTap,this);for(var e=0;e<this.btns.length;++e)this.btns[e].node.on(cc.Node.EventType.TOUCH_END,this.OnBtnTap,{that:this,i:e});this.schedule(this.Update,3)},t.prototype.Update=function(){i.default.instance.GetViewStatus(i.ViewName.BuffView)!=i.ViewStatusEnum.OPEN&&(u.default.instance.CheckCD(p.BuffTypeEnum.PHOTOSYNTHESIS),u.default.instance.CheckCD(p.BuffTypeEnum.WATERING),u.default.instance.CheckCD(p.BuffTypeEnum.FERTILIZER)),this.RefreshPlantRedDot(),this.RefreshBuffRedDot()},t.prototype.RefreshRedDot=function(){this.RefreshPlantRedDot(),this.RefreshBuffRedDot(),l.default.instance.diamond>=d.default.MinDiamond&&this.ShowShopRedDot()},t.prototype.RefreshPlantRedDot=function(){for(var e=this.btns[a.PLANT].node.getChildByName("Redot"),t=f.default.instance.PlantCnf.filter(function(e){return e.ul<=s.default.data.level}),n=function(n){var a=s.default.data.plants.filter(function(e){return e.id==t[n].id});if(0==a.length){if(-1!=l.default.instance.oxy.comparedTo(t[n].coin))return e.active=!0,{value:void 0}}else if(a[a.length-1].level!=m.default.MaxLv&&-1!=l.default.instance.oxy.comparedTo(a[a.length-1].nextOxy))return e.active=!0,{value:void 0}},o=0;o<t.length;++o){var i=n(o);if("object"==typeof i)return i.value}e.active=!1},t.prototype.RefreshBuffRedDot=function(){var e=this.btns[a.BUFF].node.getChildByName("Redot");if(u.default.instance.isCd[p.BuffTypeEnum.PHOTOSYNTHESIS]&&u.default.instance.isCd[p.BuffTypeEnum.WATERING]&&u.default.instance.isCd[p.BuffTypeEnum.FERTILIZER]){for(var t=0;t<s.default.data.buff.length;++t){var n=f.default.instance.GetBuffConfig(s.default.data.buff[t].type,s.default.data.buff[t].level);if(s.default.data.level>=n.level&&-1!=l.default.instance.oxy.comparedTo(n.coin))return void(e.active=!0)}e.active=!1}else e.active=!0},t.prototype.ShowPlantRedDot=function(){var e=this.btns[a.PLANT].node.getChildByName("Redot");e.active||(e.active=!0)},t.prototype.ShowBuffRedDot=function(){var e=this.btns[a.BUFF].node.getChildByName("Redot");i.default.instance.GetViewStatus(i.ViewName.BuffView)==i.ViewStatusEnum.OPEN||e.active||(e.active=!0)},t.prototype.ShowShopRedDot=function(){var e=this.btns[a.SHOP].node.getChildByName("Redot");i.default.instance.GetViewStatus(i.ViewName.ShopView)!=i.ViewStatusEnum.OPEN?e.active=l.default.instance.diamond>d.default.MinDiamond:d.default.instance.RefreshBtns()},t.prototype.OnSigninBtnTap=function(e){o.default.instance.playAudioClip(c.SoundClipType.click),i.default.instance.OpenView(i.ViewName.SignInView)},t.prototype.OnBtnTap=function(e){var t=this.that,n=this.i;if(n==a.SHOP){var o=t.btns[n].node;o.getChildByName("Redot").active&&(o.getChildByName("Redot").active=!1)}t.ChangeView(n)},t.prototype.OnMaskTap=function(e){this.ShrinkPage()},t.prototype.ChangeStoreNum=function(e){this.storeNum+=e,this.storeNumTxt.string=this.storeNum.toString()},t.prototype.ChangeView=function(e){var t=this;switch(o.default.instance.playAudioClip(c.SoundClipType.click),this.CloseCurView(!1),this.SetBtnState(e,!1),e){case a.PLANT:this.OpenView(i.ViewName.PlantView,function(){t.openViewType=e});break;case a.BUFF:this.OpenView(i.ViewName.BuffView,function(){t.openViewType=e});break;case a.SHOP:this.OpenView(i.ViewName.ShopView,function(){t.openViewType=e});break;case a.RANK:this.OpenView(i.ViewName.RankView,function(){t.openViewType=e})}},t.prototype.SetBtnState=function(e,t){for(var n=0;n<this.btns.length;++n)n==e&&(this.btns[n].interactable=t)},t.prototype.ShrinkPageCallback=function(){this.CloseCurView(),h.default.instance.RecoverScroll(),PlatformMgr.showBanner(),i.default.hasBanner=!0},t.prototype.ShrinkPage=function(e){var t=this;void 0===e&&(e=!1),this.productNode.stopAllActions(),e?(this.productNode.y=i.default.bottomPageY,this.ShrinkPageCallback()):this.productNode.runAction(cc.sequence(cc.moveTo(.3,cc.v2(0,i.default.bottomPageY)),cc.callFunc(function(){t.ShrinkPageCallback()}))),this.mask.active=!1},t.prototype.OpenView=function(e,t){var n=this;g.default.Log("Currently open page:"+this.openViewType),i.default.instance.OpenView(e,function(o){n.openViewType==a.NONE?(g.default.Log("No interface currently selected"),n.StretchPage(),e==i.ViewName.RankView&&o.scheduleOnce(o.OnOpen,.6),SDK.hideBanner()):(n.StretchPage(!0),e==i.ViewName.RankView&&o.scheduleOnce(o.OnOpen,.1),SDK.hideBanner()),i.default.hasBanner=!1,t&&t()},i.LayerType.PAGE)},t.prototype.CloseCurView=function(e){if(void 0===e&&(e=!0),this.openViewType!=a.NONE){switch(this.openViewType){case a.PLANT:i.default.instance.closeView(i.ViewName.PlantView);break;case a.BUFF:i.default.instance.closeView(i.ViewName.BuffView);break;case a.SHOP:i.default.instance.closeView(i.ViewName.ShopView);break;case a.RANK:i.default.instance.closeView(i.ViewName.RankView)}this.SetBtnState(this.openViewType,!0),e&&(this.openViewType=a.NONE)}},t.prototype.StretchPage=function(e){void 0===e&&(e=!1),this.productNode.stopAllActions(),e?this.productNode.y=i.default.bottomPageHeight:this.productNode.runAction(cc.moveTo(.5,cc.v2(0,i.default.bottomPageHeight))),this.mask.active=!0},t.prototype.OnBackBtnTap=function(e){o.default.instance.playAudioClip(c.SoundClipType.click),r.default.instance.ToProductMode()},t.prototype.OnStoreBtnTap=function(e){o.default.instance.playAudioClip(c.SoundClipType.click),i.default.instance.OpenView(i.ViewName.StoreView)},t.prototype.ResetHeight=function(){this.node.height=i.default.bannerHeight;var e=this.productNode.getComponent(cc.Widget);e.updateAlignment(),(e=this.placeNode.getComponent(cc.Widget)).updateAlignment(),i.default.bottomPageY=this.placeNode.y},__decorate([_({type:cc.Node,displayName:"\u751f\u4ea7\u6a21\u5f0f\u7684\u5bb9\u5668"})],t.prototype,"productNode",void 0),__decorate([_({type:cc.Node,displayName:"\u5e03\u7f6e\u6a21\u5f0f\u7684\u5bb9\u5668"})],t.prototype,"placeNode",void 0),__decorate([_({type:cc.Node,displayName:"\u7b7e\u5230\u6309\u94ae"})],t.prototype,"signinBtn",void 0),__decorate([_({type:cc.Button,displayName:"\u6309\u94ae"})],t.prototype,"btns",void 0),__decorate([_({type:cc.Node,displayName:"\u8fd4\u56de\u6309\u94ae"})],t.prototype,"backBtn",void 0),__decorate([_({type:cc.Node,displayName:"\u4ed3\u5e93\u6309\u94ae"})],t.prototype,"storeBtn",void 0),__decorate([_({type:cc.Label,displayName:"\u4ed3\u5e93\u690d\u7269\u6570\u91cf"})],t.prototype,"storeNumTxt",void 0),__decorate([_({type:cc.Node,displayName:"\u906e\u7f69"})],t.prototype,"mask",void 0),t=n=__decorate([v],t)}(cc.Component);n.default=S,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Core/GameHelper":"GameHelper","../../Data/BuffData":"BuffData","../../Data/GardenData":"GardenData","../../Data/PlantData":"PlantData","../../Logic/BuffLogic":"BuffLogic","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../../Logic/PlantLogic":"PlantLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../Shop/ShopView":"ShopView","../UIManager":"UIManager"}],Bubble:[function(e,t,n){"use strict";cc._RF.push(t,"84e4de0yYJOTIGugdZIyKIv","Bubble"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Core/ResourcesPool"),o=cc._decorator,i=o.ccclass,r=o.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ani=null,t}return __extends(t,e),t.prototype.start=function(){var e=this;this.ani.on(cc.Animation.EventType.FINISHED,function(){e.destroySelf()},this)},t.prototype.getKey=function(){return this.node.name},t.prototype.awake=function(){this.node.active=!0},t.prototype.sleep=function(){this.node.setParent(null),this.node.active=!1},t.prototype.destroySelf=function(){a.default.instance.put(this)},__decorate([r({type:cc.Animation,displayName:"\u52a8\u753b"})],t.prototype,"ani",void 0),t=__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{"../../Core/ResourcesPool":"ResourcesPool"}],BuffBtn:[function(e,t,n){"use strict";cc._RF.push(t,"1a022UxdTlKYbsQOCHfT9dm","BuffBtn"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Data/BuffData"),o=e("../../Logic/BuffLogic"),i=e("../../Sound/SoundManager"),r=e("../../Sound/SoundClip"),c=e("../../Core/GameHelper"),s=e("../../Logic/TeachLogic"),l=e("../../Core/Server"),d=e("../../Common/ReportEventID"),u=cc._decorator,p=u.ccclass,f=u.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buffType=a.BuffTypeEnum.PHOTOSYNTHESIS,t.countDownTxt=null,t.progressBar=null,t.readyTxt=null,t}return __extends(t,e),t.prototype.start=function(){this.AddEvents()},t.prototype.AddEvents=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.OnBtnTap,this)},t.prototype.SetBtnState=function(e){this.countDownTxt.node.parent.active=e,this.readyTxt.active=!e},t.prototype.OnBtnTap=function(e){var t=this;if(i.default.instance.playAudioClip(r.SoundClipType.click),o.default.instance.isCd[this.buffType])return c.default.Log("The skills are still cooling"),void o.default.instance.ClearBuffCD(this.buffType,function(){t.SetBtnState(!1)});switch(this.buffType){case a.BuffTypeEnum.PHOTOSYNTHESIS:o.default.instance.UsePhotosynthesis(),l.default.reportEvent(d.default.prop_sun_use,d.default.def_page);break;case a.BuffTypeEnum.WATERING:o.default.instance.UseWater(),l.default.reportEvent(d.default.prop_water_use,d.default.def_page);break;case a.BuffTypeEnum.FERTILIZER:o.default.instance.UseFertilizer(),l.default.reportEvent(d.default.prop_fertilize_use,d.default.def_page)}this.CheckCD(),this.SetBtnState(!0),s.default.instance.isPropComp&&(s.default.instance.isPropComp=!1,l.default.reportEvent(d.default.bs_prop_use,d.default.def_page))},t.prototype.CheckCD=function(){var e=o.default.instance.CheckCD(this.buffType);if(e>0){var t=o.default.instance.GetCurData(this.buffType);this.countDownTxt.string=c.default.TransClockTime(1e3*e),this.progressBar.progress=(t.cdLong-e)/t.cdLong,c.default.Log("Remaining cooling time:"+c.default.TransClockTime(1e3*e)),this.SetBtnState(!0)}else this.SetBtnState(!1)},__decorate([f({type:cc.Enum(a.BuffTypeEnum),displayName:"\u9053\u5177\u7c7b\u578b"})],t.prototype,"buffType",void 0),__decorate([f({type:cc.Label,displayName:"\u5012\u8ba1\u65f6\u6587\u672c"})],t.prototype,"countDownTxt",void 0),__decorate([f({type:cc.ProgressBar,displayName:"\u5012\u8ba1\u65f6\u8fdb\u5ea6\u6761"})],t.prototype,"progressBar",void 0),__decorate([f({type:cc.Node,displayName:"\u51c6\u5907\u6587\u5b57"})],t.prototype,"readyTxt",void 0),t=__decorate([p],t)}(cc.Component);n.default=h,cc._RF.pop()},{"../../Common/ReportEventID":"ReportEventID","../../Core/GameHelper":"GameHelper","../../Core/Server":"Server","../../Data/BuffData":"BuffData","../../Logic/BuffLogic":"BuffLogic","../../Logic/TeachLogic":"TeachLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager"}],BuffConfig:[function(e,t,n){"use strict";cc._RF.push(t,"6e11bxIqyBDqL+VzcpuhHr3","BuffConfig"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){return function(){this.lv=0}}();n.default=a,cc._RF.pop()},{}],BuffData:[function(e,t,n){"use strict";cc._RF.push(t,"d1889iap9pN/qC39bMkARgi","BuffData"),Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.PHOTOSYNTHESIS=1]="PHOTOSYNTHESIS",e[e.WATERING=2]="WATERING",e[e.FERTILIZER=3]="FERTILIZER",e[e.OFFLINE=4]="OFFLINE",e[e.ALL=5]="ALL"}(n.BuffTypeEnum||(n.BuffTypeEnum={}));var a=function(){function e(){this.level=1,this.cdTime=0,this.cdLong=0,this.drTime=0,this.drLong=0}return e.New=function(t){var n=new e;return n.type=t.type,n},e.MaxLv=100,e}();n.default=a,cc._RF.pop()},{}],BuffItem:[function(e,t,n){"use strict";cc._RF.push(t,"c7df4D2LwZOwbZFmRfSh4L/","BuffItem"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Data/BuffData"),o=e("../../Data/GardenData"),i=e("../../Common/DataManager"),r=e("../../Logic/EconomicLogic"),c=e("../../Core/GameHelper"),s=e("../../Sound/SoundManager"),l=e("../../Sound/SoundClip"),d=e("../../Logic/GardenLogic"),u=e("../../Logic/TeachLogic"),p=e("../../Core/Server"),f=e("../../Common/ReportEventID"),h=e("../ToolBar/BottomToolBar"),g=e("../../Common/EventID"),m=cc._decorator,y=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buffType=a.BuffTypeEnum.PHOTOSYNTHESIS,t.upgradeBtn=null,t.upgradePrice=null,t.upgradeDecBtn=null,t.upgradeDecPrice=null,t.buffLv=null,t.buffDesc=null,t.needLvBtn=null,t.isInit=!1,t.curBuffCnf=null,t.curBuffData=null,t.nextDecOxy=0,t}return __extends(t,e),t.prototype.start=function(){var e=this;this.curBuffData=o.default.data.buff.filter(function(t){return t.type==e.buffType})[0],this.curBuffCnf=i.default.instance.GetBuffConfig(this.buffType,this.curBuffData.level),this.AddEvents(),this.RefreshLevel(),this.isInit=!0},t.prototype.onEnable=function(){this.isInit&&this.RefreshLevel(),cc.systemEvent.on(g.default.level_changed,this.RefreshLevel,this)},t.prototype.onDisable=function(){cc.systemEvent.off(g.default.level_changed,this.RefreshLevel,this)},t.prototype.AddEvents=function(){this.upgradeBtn.on(cc.Node.EventType.TOUCH_END,this.OnUpgradeBtnTap,this),this.upgradeDecBtn.on(cc.Node.EventType.TOUCH_END,this.OnUpgradeDecBtnTap,this)},t.prototype.Upgrade=function(e){void 0===e&&(e=1),this.curBuffData.level+=e,this.curBuffCnf=i.default.instance.GetBuffConfig(this.buffType,this.curBuffData.level),h.default.instance.RefreshBuffRedDot(),u.default.instance.isPropComp&&(u.default.instance.isPropComp=!1,p.default.reportEvent(f.default.bs_prop_upgrade,f.default.def_page))},t.prototype.OnUpgradeBtnTap=function(e){s.default.instance.playAudioClip(l.SoundClipType.click),o.default.data.level<this.curBuffCnf.level?c.default.Log("insufficient level"):-1!=r.default.instance.oxy.comparedTo(this.curBuffCnf.coin)&&(c.default.Log("Upgrade one level"),r.default.instance.SubOxy(this.curBuffCnf.coin),this.Upgrade(),this.RefreshLevel())},t.prototype.OnUpgradeDecBtnTap=function(e){if(s.default.instance.playAudioClip(l.SoundClipType.click),o.default.data.level<this.curBuffCnf.level)c.default.Log("Not enough level required");else if(0!=this.nextDecOxy&&-1!=r.default.instance.oxy.comparedTo(this.nextDecOxy)){c.default.Log("Rise ten"),r.default.instance.SubOxy(this.nextDecOxy);var t=a.default.MaxLv-this.curBuffData.level;t>10&&(t=10),this.Upgrade(t),this.RefreshLevel()}},t.prototype.RefreshLevel=function(){switch(this.buffType){case a.BuffTypeEnum.PHOTOSYNTHESIS:this.buffDesc.string="Double output continues "+this.curBuffCnf.effect+" second";break;case a.BuffTypeEnum.WATERING:this.buffDesc.string="continued "+this.curBuffCnf.effect+" Click automatically in seconds";break;case a.BuffTypeEnum.FERTILIZER:this.buffDesc.string="get it right now "+r.default.instance.number2UnitFormat(this.curBuffCnf.effect)+" oxygen";break;case a.BuffTypeEnum.OFFLINE:this.buffDesc.string="Get offline every second "+r.default.instance.number2UnitFormat(Math.floor(.9*d.default.instance.GainProduct(1)+this.curBuffCnf.effect))+" oxygen"}this.buffLv.string="lv:"+Math.min(this.curBuffData.level,a.default.MaxLv).toString(),this.curBuffData.level>=a.default.MaxLv?(this.upgradeBtn.active=!1,this.needLvBtn.active=!0,this.needLvBtn.getChildByName("Label").getComponent(cc.Label).string="Full class"):o.default.data.level<this.curBuffCnf.level?(this.upgradeBtn.active=!1,this.needLvBtn.active=!0,this.needLvBtn.getChildByName("Label").getComponent(cc.Label).string="Need lv :"+this.curBuffCnf.level):(this.upgradeBtn.active=!0,this.needLvBtn.active=!1),this.curBuffData.level>=a.default.MaxLv?this.upgradeBtn.active=!1:this.upgradePrice.string=r.default.instance.number2UnitFormat(this.curBuffCnf.coin)},t.prototype.RefreshOxy=function(){!this.curBuffData||this.curBuffData.level>=a.default.MaxLv||(-1==r.default.instance.oxy.comparedTo(this.curBuffCnf.coin)?this.upgradeBtn.getComponent(cc.Button).interactable&&(this.upgradeBtn.getComponent(cc.Button).interactable=!1,this.upgradeBtn.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.GRAY)):this.upgradeBtn.getComponent(cc.Button).interactable||(this.upgradeBtn.getComponent(cc.Button).interactable=!0,this.upgradeBtn.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL)))},__decorate([v({type:cc.Enum(a.BuffTypeEnum),displayName:"\u9053\u5177\u7c7b\u578b"})],t.prototype,"buffType",void 0),__decorate([v({type:cc.Node,displayName:"\u5347\u7ea7\u6309\u94ae"})],t.prototype,"upgradeBtn",void 0),__decorate([v({type:cc.Label,displayName:"\u5347\u7ea7\u4ef7\u683c"})],t.prototype,"upgradePrice",void 0),__decorate([v({type:cc.Node,displayName:"\u5347\u5341\u7ea7\u6309\u94ae"})],t.prototype,"upgradeDecBtn",void 0),__decorate([v({type:cc.Label,displayName:"\u5347\u5341\u7ea7\u4ef7\u683c"})],t.prototype,"upgradeDecPrice",void 0),__decorate([v({type:cc.Label,displayName:"\u9053\u5177\u7b49\u7ea7"})],t.prototype,"buffLv",void 0),__decorate([v({type:cc.Label,displayName:"\u9053\u5177\u8bf4\u660e"})],t.prototype,"buffDesc",void 0),__decorate([v({type:cc.Node,displayName:"\u9700\u8981\u7b49\u7ea7\u6807\u8bc6"})],t.prototype,"needLvBtn",void 0),t=__decorate([y],t)}(cc.Component);n.default=_,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Common/EventID":"EventID","../../Common/ReportEventID":"ReportEventID","../../Core/GameHelper":"GameHelper","../../Core/Server":"Server","../../Data/BuffData":"BuffData","../../Data/GardenData":"GardenData","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../../Logic/TeachLogic":"TeachLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../ToolBar/BottomToolBar":"BottomToolBar"}],BuffLogic:[function(e,t,n){"use strict";cc._RF.push(t,"88dea/oLAdDCLoIr0qgP6x3","BuffLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Data/BuffData"),o=e("../Data/GardenData"),i=e("../Common/DataManager"),r=e("../Core/GameHelper"),c=e("../UI/UIManager"),s=e("../UI/Garden/Garden"),l=e("../UI/ToolBar/BottomToolBar"),d=function(){function e(){this._curDatas={},this._curCnfs={},this._curLv={},this.isUse={},this.isCd={},this.cdTime=[1200,900,300]}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e,this._instance.Init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.GetCurData=function(e){return null==this._curDatas[e]&&(this._curDatas[e]=o.default.data.buff.filter(function(t){return t.type==e})[0]),this._curDatas[e]},e.prototype.GetCurCnf=function(e){return this._curLv[e]!=this.GetCurData(e).level&&(this._curCnfs[e]=i.default.instance.GetBuffConfig(e,this.GetCurData(e).level),this._curLv[e]=this.GetCurData(e).level),this._curCnfs[e]},e.prototype.Init=function(){this.isCd[a.BuffTypeEnum.PHOTOSYNTHESIS]=!0,this.isCd[a.BuffTypeEnum.WATERING]=!0,this.isCd[a.BuffTypeEnum.FERTILIZER]=!0},e.prototype.CalcCostDiamond=function(e){return Math.round(Math.pow(e,1.5)/10*(1-e/(e+10)))},e.prototype.ClearBuffCD=function(e,t){var n=this;void 0===t&&(t=null);var a=this.GetCurData(e).cdTime-i.default.instance.Now();c.default.instance.OpenView(c.ViewName.PurchaseView,function(o){o.Init(e,!1,n.CalcCostDiamond(a/1e3),function(){n.ClearCD(e),l.default.instance.RefreshBuffRedDot(),t&&t()})})},e.prototype.UseClearCD=function(e){var t=this;void 0===e&&(e=null);var n=this.CheckAllCD();n<=0?PlatformMgr.showToast("No items to reset"):c.default.instance.OpenView(c.ViewName.PurchaseView,function(o){o.Init(a.BuffTypeEnum.ALL,PlatformMgr.hasVideo(),t.CalcCostDiamond(n/1e3),function(){t.ClearCD(a.BuffTypeEnum.PHOTOSYNTHESIS),t.ClearCD(a.BuffTypeEnum.WATERING),t.ClearCD(a.BuffTypeEnum.FERTILIZER),l.default.instance.RefreshBuffRedDot(),e&&e()})})},e.prototype.CheckAllCD=function(){var e=0,t=i.default.instance.Now();return this.isCd[a.BuffTypeEnum.FERTILIZER]&&this.GetCurData(a.BuffTypeEnum.FERTILIZER).cdTime>t&&(e+=this.GetCurData(a.BuffTypeEnum.FERTILIZER).cdTime-t),this.isCd[a.BuffTypeEnum.WATERING]&&this.GetCurData(a.BuffTypeEnum.WATERING).cdTime>t&&(e+=this.GetCurData(a.BuffTypeEnum.WATERING).cdTime-t),this.isCd[a.BuffTypeEnum.PHOTOSYNTHESIS]&&this.GetCurData(a.BuffTypeEnum.PHOTOSYNTHESIS).cdTime>t&&(e+=this.GetCurData(a.BuffTypeEnum.PHOTOSYNTHESIS).cdTime-t),e},e.prototype.CheckBuffCD=function(e){return this.GetCurData(e).cdTime-i.default.instance.Now()},e.prototype.UsePhotosynthesis=function(){r.default.Log("Use light");var e=a.BuffTypeEnum.PHOTOSYNTHESIS,t=this.GetCurData(e);t.drTime=i.default.instance.Now()+1e3*this.GetCurCnf(e).effect,t.drLong=this.GetCurCnf(e).effect,t.cdLong=this.cdTime[e-1],t.cdTime=i.default.instance.Now()+1e3*t.cdLong,this.isCd[e]=!0},e.prototype.UseWater=function(){r.default.Log("Use watering");var e=a.BuffTypeEnum.WATERING,t=this.GetCurData(e);t.drTime=i.default.instance.Now()+1e3*this.GetCurCnf(e).effect,t.drLong=this.GetCurCnf(e).effect,t.cdLong=this.cdTime[e-1],t.cdTime=i.default.instance.Now()+1e3*t.cdLong,this.isCd[e]=!0},e.prototype.UseFertilizer=function(){r.default.Log("Use fertilizer");var e=a.BuffTypeEnum.FERTILIZER,t=this.GetCurData(e);t.cdLong=this.cdTime[e-1],t.cdTime=i.default.instance.Now()+1e3*t.cdLong;var n=this.GetCurCnf(e);this.isCd[e]=!0,s.default.instance.fertilizerAni.active=!0,setTimeout(function(){s.default.instance.fertilizerAni.active=!1},3e3),c.default.instance.OpenView(c.ViewName.BuffMotiveView,function(e){e.Init(n.effect)})},e.prototype.CheckCD=function(e){if(!this.isCd[e])return 0;var t=this.GetCurData(e),n=(t.cdTime-i.default.instance.Now())/1e3;return n<0&&(r.default.Log("Cooldown time is up"),this.isCd[e]=!1,t.cdTime=0,l.default.instance.RefreshBuffRedDot()),n},e.prototype.UseTime=function(e,t){var n=this.GetCurData(a.BuffTypeEnum.PHOTOSYNTHESIS),o=Math.floor((n.cdTime-n.cdLong)/1e3),i=Math.floor(n.cdTime/1e3),r=Math.min(t,i)-Math.max(e,o);n=this.GetCurData(a.BuffTypeEnum.WATERING),o=Math.floor((n.cdTime-n.cdLong)/1e3),i=Math.floor(n.cdTime/1e3);var c=Math.min(t,i)-Math.max(e,o),s=0;return r<=0&&c<=0||(r==c?s=19*r:r>c?(s=19*c,s+=r-c):(s=19*r,s+=9*(c-r))),s},e.prototype.ClearCD=function(e){r.default.Log("EmptyCD"),this.GetCurData(e).cdTime=0},e}();n.default=d,cc._RF.pop()},{"../Common/DataManager":"DataManager","../Core/GameHelper":"GameHelper","../Data/BuffData":"BuffData","../Data/GardenData":"GardenData","../UI/Garden/Garden":"Garden","../UI/ToolBar/BottomToolBar":"BottomToolBar","../UI/UIManager":"UIManager"}],BuffMotiveView:[function(e,t,n){"use strict";cc._RF.push(t,"4161fEclEZPwIMl1avNfdgu","BuffMotiveView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("../../Core/RewardLogic"),i=e("../../Core/ShareLogic"),r=e("../../Sound/SoundManager"),c=e("../../Sound/SoundClip"),s=e("../../Logic/EconomicLogic"),l=e("../UIManager"),d=e("../../Core/MathUtil"),u=e("../../Logic/GardenLogic"),p=e("../../Common/CommonUils"),f=e("../../Core/Server"),h=e("../../Common/ReportEventID"),g=e("../../Common/DataManager"),m=e("../../Logic/TeachLogic"),y=e("../Garden/Garden"),v=e("../../Core/GameHelper"),_=cc._decorator,S=_.ccclass,w=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.oxyTxt=null,t.getBtn=null,t.videoBtn=null,t.title=null,t.multipleRate=.7,t.ratioTypes=[5,10,20,30,50,80],t.oxyNum=0,t.ratio=50,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.closeCallBack=function(){t.GetReward()}},t.prototype.start=function(){this.AddEvents()},t.prototype.AddEvents=function(){this.getBtn.on(cc.Node.EventType.TOUCH_END,this.OnGetBtnTap,this),this.videoBtn.on(cc.Node.EventType.TOUCH_END,this.OnGetBtnTap,this)},t.prototype.OnGetBtnTap=function(e){var t=this;r.default.instance.playAudioClip(c.SoundClipType.click),this.rewardMethod==o.RewardMethodEnum.SHARE?o.default.instance.ShareReward(i.ShareTypeEnum.PHOTOSYNTHESIS,function(){f.default.reportEvent(h.default.prop_fertilize_share,h.default.def_page),t.GetReward(!0)}):this.rewardMethod==o.RewardMethodEnum.VIDEO&&o.default.instance.VideoReward(!0,function(){f.default.reportEvent(h.default.prop_fertilize_video,h.default.def_page),t.GetReward(!0)})},t.prototype.GetReward=function(e){void 0===e&&(e=!1);var t=e?this.oxyNum*this.ratio:this.oxyNum,n=p.default.transRelativeFromPos(this.oxyTxt.node,this.oxyTxt.node.getChildByName("Icon").position);if(s.default.instance.effectEco(t,s.EconomicTypeEnum.COIN,10,n),u.default.instance.ShowPopupEcoNum(cc.Vec2.ZERO,s.EconomicTypeEnum.COIN,"+"+s.default.instance.number2UnitFormat(t)),m.default.instance.CheckFinger(m.TeachStageEnum.FERTILIZER,9),e)switch(this.ratio){case 2:f.default.reportEvent(h.default.prop_fertilize_reward2,h.default.def_page);break;case 5:f.default.reportEvent(h.default.prop_fertilize_reward5,h.default.def_page);break;case 10:f.default.reportEvent(h.default.prop_fertilize_reward10,h.default.def_page);break;case 20:f.default.reportEvent(h.default.prop_fertilize_reward20,h.default.def_page);break;case 30:f.default.reportEvent(h.default.prop_fertilize_reward30,h.default.def_page);break;case 50:f.default.reportEvent(h.default.prop_fertilize_reward50,h.default.def_page);break;case 80:f.default.reportEvent(h.default.prop_fertilize_reward80,h.default.def_page)}l.default.instance.closeView(this.node.name,!1)},t.prototype.Init=function(e){this.oxyNum=e,this.RefreshRewardMethod()},t.prototype.RefreshRewardMethod=function(){if(this.rewardMethod=o.default.instance.ShareOrVideo(i.ShareTypeEnum.PHOTOSYNTHESIS),this.rewardMethod==o.RewardMethodEnum.NONE)return this.title.string="Harvest oxygen",this.getBtn.active=!1,this.oxyTxt.string="+"+s.default.instance.number2UnitFormat(this.oxyNum),void(v.default.IsQQ?this.videoBtn.active=!1:(this.videoBtn.active=!0,this.videoBtn.getComponent(cc.Button).interactable=!1,this.videoBtn.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.GRAY)));g.default.instance.beginerStage==m.TeachStageEnum.UNLOCKSHOP&&y.default.instance.finger.active?(this.rewardMethod=o.RewardMethodEnum.VIDEO,this.ratio=20,this.title.string=this.ratio+"Double harvest"):Math.random()<this.multipleRate?(this.ratio=d.default.RandomArr(this.ratioTypes),this.title.string=this.ratio+"Double harvest"):(this.ratio=2,this.title.string="Harvest oxygen"),this.rewardMethod==o.RewardMethodEnum.SHARE?(this.videoBtn.active=!1,this.getBtn.active=!0,this.getBtn.getChildByName("Label").getComponent(cc.Label).string="Reward x "+this.ratio):this.rewardMethod==o.RewardMethodEnum.VIDEO&&(this.getBtn.active=!1,this.videoBtn.active=!0,this.videoBtn.getComponent(cc.Button).interactable=!0,this.videoBtn.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL),this.videoBtn.getChildByName("Label").getComponent(cc.Label).string="Reward x "+this.ratio),this.oxyTxt.string="+"+s.default.instance.number2UnitFormat(this.oxyNum*this.ratio)},__decorate([w({type:cc.Label,displayName:"\u6c27\u6c14\u6570"})],t.prototype,"oxyTxt",void 0),__decorate([w({type:cc.Node,displayName:"\u9886\u53d6\u6309\u94ae"})],t.prototype,"getBtn",void 0),__decorate([w({type:cc.Node,displayName:"\u89c6\u9891\u6309\u94ae"})],t.prototype,"videoBtn",void 0),__decorate([w({type:cc.Label,displayName:"\u6807\u9898"})],t.prototype,"title",void 0),t=__decorate([S],t)}(a.default);n.default=C,cc._RF.pop()},{"../../Common/CommonUils":"CommonUils","../../Common/DataManager":"DataManager","../../Common/ReportEventID":"ReportEventID","../../Core/GameHelper":"GameHelper","../../Core/MathUtil":"MathUtil","../../Core/RewardLogic":"RewardLogic","../../Core/Server":"Server","../../Core/ShareLogic":"ShareLogic","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../../Logic/TeachLogic":"TeachLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../Base/View":"View","../Garden/Garden":"Garden","../UIManager":"UIManager"}],BuffView:[function(e,t,n){"use strict";cc._RF.push(t,"78dbe4gTXxOA6EW8NYuc+9k","BuffView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("./BuffBtn"),i=e("./BuffItem"),r=e("../../Logic/BuffLogic"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buffBtns=[],t.buffItems=[],t.clearBtn=null,t.scrollView=null,t.content=null,t}return __extends(t,e),t.prototype.start=function(){this.AddEvents();for(var e=0;e<this.buffBtns.length;++e)this.buffBtns[e].CheckCD()},t.prototype.onEnable=function(){e.prototype.onEnable.call(this),this.Update()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.AddEvents=function(){this.clearBtn.node.on(cc.Node.EventType.TOUCH_END,this.OnClearBtnTap,this),this.schedule(this.Update,1)},t.prototype.OnClearBtnTap=function(e){r.default.instance.UseClearCD()},t.prototype.Update=function(){for(var e=0;e<this.buffBtns.length;++e)this.buffBtns[e].CheckCD();for(e=0;e<this.buffItems.length;++e)this.buffItems[e].RefreshOxy()},t.prototype.DelayResetWidget=function(){this.scheduleOnce(this.ResetWidget,1)},t.prototype.ResetWidget=function(){this.node.getComponent(cc.Widget).updateAlignment();var e=this.node.getChildByName("Win");e.getComponent(cc.Widget).updateAlignment(),e.getChildByName("Title").getComponent(cc.Widget).updateAlignment(),this.scrollView.node.parent.getComponent(cc.Widget).updateAlignment(),this.scrollView.getComponent(cc.Widget).updateAlignment(),this.content.parent.getComponent(cc.Widget).updateAlignment(),this.content.getComponent(cc.Widget).updateAlignment()},__decorate([l({type:o.default,tooltip:"\u9053\u5177\u6309\u94ae"})],t.prototype,"buffBtns",void 0),__decorate([l({type:i.default,tooltip:"\u9053\u5177\u5347\u7ea7\u9879"})],t.prototype,"buffItems",void 0),__decorate([l({type:cc.Button,displayName:"\u6e05\u7a7aCD\u6309\u94ae"})],t.prototype,"clearBtn",void 0),__decorate([l({type:cc.ScrollView,displayName:"\u5212\u52a8\u5bb9\u5668"})],t.prototype,"scrollView",void 0),__decorate([l({type:cc.Node,displayName:"\u5185\u5bb9"})],t.prototype,"content",void 0),t=__decorate([s],t)}(a.default);n.default=d,cc._RF.pop()},{"../../Logic/BuffLogic":"BuffLogic","../Base/View":"View","./BuffBtn":"BuffBtn","./BuffItem":"BuffItem"}],CCActionConvert:[function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}cc._RF.push(t,"9d28fYtI6ROFo9JEX/KvfFh","CCActionConvert"),cc.FloatBy=cc.Class({name:"cc.FloatBy",extends:cc.ActionInterval,ctor:function(e,t,n,a){this._deltaValue=n,this._startValue=t,this._previousValue=t,this._curValue=t,this._callback=a,this._args=arguments,cc.FloatBy.prototype.initWithDuration.call(this,e)},clone:function(){var e=new(Function.prototype.bind.apply(cc.FloatBy,[null].concat(a(this._args))));return this._cloneDecoration(e),e.initWithDuration(this._duration),e},update:function(e){e=this._computeEaseTime(e);var t=this._deltaValue*e,n=this._startValue;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var a=this._curValue;t+=n+=a-this._previousValue,this._previousValue=t,this._curValue=t,this._callback&&this._callback(this._curValue,t-a)}else this._callback&&this._callback(n+t)},reverse:function(){var e=new cc.FloatBy(this._duration,this._startValue,-this._deltaValue,this._callback);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.floatBy=function(e,t,n,a){return new cc.FloatBy(e,t,n,a)},cc.FloatTo=cc.Class({name:"cc.FloatTo",extends:cc.FloatBy,ctor:function(e,t,n,a){this._startValue=t,this._endValue=n,this._deltaValue=this._endValue-this._startValue,this._curValue=t,this._previousValue=t,this._callback=a,this._args=arguments,this.initWithDuration(e)},clone:function(){var e=new(Function.prototype.bind.apply(cc.FloatTo,[null].concat(a(this._args))));this._cloneDecoration(e),e.initWithDuration(this._duration)}}),cc.floatTo=function(e,t,n,a){return new cc.FloatTo(e,t,n,a)},cc.CircleBy=cc.Class({name:"cc.CircleBy",extends:cc.ActionInterval,ctor:function(e,t,n,a,o){this._center=t,this._radius=n,this._deltaDegress=o,this._startDegress=a,this._previousDegress=a,this._curDegress=a,this._args=arguments,cc.CircleBy.prototype.initWithDuration.call(this,e)},clone:function(){var e=new(Function.prototype.bind.apply(cc.CircleBy,[null].concat(a(this._args))));return this._cloneDecoration(e),e.initWithDuration(this._duration),e},update:function(e){if(e=this._computeEaseTime(e),this.target){var t=this._deltaDegress*e,n=this._startDegress;if(cc.macro.ENABLE_STACKABLE_ACTIONS){t+=n+=this._curDegress-this._previousDegress,this._previousDegress=t,this._curDegress=t;var a=cc.misc.degreesToRadians(this._curDegress),o=this._center.x+Math.sin(a)*this._radius,i=this._center.y+Math.cos(a)*this._radius;this.target.position=cc.v2(o,i)}else{this._curDegress=n+t;var r=cc.misc.degreesToRadians(this._curDegress),c=this._center.x+Math.sin(r)*this._radius,s=this._center.y+Math.cos(r)*this._radius;this.target.position=cc.v2(c,s)}}},reverse:function(){var e=new cc.CircleBy(this._duration,this._center,this._radius,this._startDegress,-this._deltaDegress);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.circleBy=function(e,t,n,a,o){return new cc.CircleBy(e,t,n,a,o)},cc.CircleTo=cc.Class({name:"cc.CircleTo",extends:cc.CircleBy,ctor:function(e,t,n,a,o){this._center=t,this._radius=n,this._deltaDegress=o-a,this._startDegress=a,this._previousDegress=a,this._curDegress=a,this._args=arguments,this.initWithDuration(e)},clone:function(){var e=new(Function.prototype.bind.apply(cc.CircleTo,[null].concat(a(this._args))));return this._cloneDecoration(e),e.initWithDuration(this._duration),e}}),cc.circleTo=function(e,t,n,a,o){return new cc.CircleTo(e,t,n,a,o)},cc._RF.pop()},{}],ClickCircle:[function(e,t,n){"use strict";cc._RF.push(t,"bdf37kM4MtEu7SAYGZ62tia","ClickCircle"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Core/ResourcesPool"),o=cc._decorator,i=o.ccclass,r=o.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ani=null,t}return __extends(t,e),t.prototype.start=function(){var e=this;this.ani.on(cc.Animation.EventType.FINISHED,function(){e.destroySelf()},this)},t.prototype.getKey=function(){return this.node.name},t.prototype.awake=function(){this.node.active=!0},t.prototype.sleep=function(){this.node.setParent(null),this.node.active=!1},t.prototype.destroySelf=function(){a.default.instance.put(this)},__decorate([r({type:cc.Animation,displayName:"\u52a8\u753b"})],t.prototype,"ani",void 0),t=__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{"../../Core/ResourcesPool":"ResourcesPool"}],CollectLogic:[function(e,t,n){"use strict";cc._RF.push(t,"4655aWioWVPdq/je6SH+6Ch","CollectLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../Core/DataStorage"),i=e("../Common/DataID"),r=e("../UI/ToolBar/MiddleToolBar"),c=e("../UI/UIManager"),s=e("../UI/Reward/RewardView"),l=e("../Core/ShareLogic");(function(e){e[e.NO=0]="NO",e[e.COLLECTED=1]="COLLECTED",e[e.GET=2]="GET"})(a=n.CollectStateEnum||(n.CollectStateEnum={}));var d=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.getCollectState=function(){this.collectState||(this.collectState=o.default.getIntItem(i.default.collectState,a.NO))},e.prototype.SaveCollectState=function(){o.default.setItem(i.default.collectState,this.collectState)},e.prototype.GetCollectReward=function(){if(e.instance.collectState==a.COLLECTED){var t=new s.RewardData;t.shareType=l.ShareTypeEnum.NONE,t.rewardTypes=[s.RewardTypeEnum.DIAMOND],t.rewardVals=[e.RewardDiamond],t.ratio=1,t.title="Collection reward",t.desc3="obtain:",t.callback=function(){r.default.instance.collectBtn.node.active=!1,e.instance.collectState=a.GET,e.instance.SaveCollectState(),c.default.instance.GetViewStatus(c.ViewName.CollectView)==c.ViewStatusEnum.OPEN&&c.default.instance.closeView(c.ViewName.CollectView,!0)},c.default.instance.rewardDatas.push(t)}},e.prototype.appear=function(){var e=this,t=r.default.instance.collectBtn.node;t.active=!0;var n=cc.view.getVisibleSize(),a=.5*n.height+274,o=.5*n.height+11;t.stopAllActions(),t.setPosition(-100,a),t.runAction(cc.sequence(cc.moveTo(.7,-100,o).easing(cc.easeBounceOut()),cc.callFunc(function(){e.pendular(t)})))},e.prototype.pendular=function(e){e.stopAllActions(),e.runAction(cc.repeatForever(cc.sequence(cc.rotateTo(.5,-20).easing(cc.easeSineOut()),cc.rotateTo(1,20).easing(cc.easeSineInOut()),cc.rotateTo(.5,0).easing(cc.easeSineIn()))))},e.RewardDiamond=1200,e}();n.default=d,cc._RF.pop()},{"../Common/DataID":"DataID","../Core/DataStorage":"DataStorage","../Core/ShareLogic":"ShareLogic","../UI/Reward/RewardView":"RewardView","../UI/ToolBar/MiddleToolBar":"MiddleToolBar","../UI/UIManager":"UIManager"}],CollectView:[function(e,t,n){"use strict";cc._RF.push(t,"e54740n8rhJvrgdr9gaGSRG","CollectView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../base/View"),o=e("../../core/GameHelper"),i=e("../../Logic/CollectLogic"),r=cc._decorator,c=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getBtn=null,t.tipArror=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){this.AddEvents();var e=SDK.isIphoneX()?cc.v2(140,cc.winSize.height/2-150):cc.v2(110,cc.winSize.height/2-100),t=cc.v2(e.x+44,e.y+6);this.tipArror.position=e,this.tipArror.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.5,t),cc.moveTo(.5,e))))},t.prototype.onEnable=function(){e.prototype.onEnable.call(this),o.default.Log("Collection status:"+i.default.instance.collectState),this.RefreshGetBtnState()},t.prototype.AddEvents=function(){this.getBtn.node.on(cc.Node.EventType.TOUCH_END,i.default.instance.GetCollectReward,this)},t.prototype.RefreshGetBtnState=function(){this.getBtn.interactable=i.default.instance.collectState==i.CollectStateEnum.COLLECTED},__decorate([s({type:cc.Button,displayName:"\u9886\u53d6\u5956\u52b1\u6309\u94ae"})],t.prototype,"getBtn",void 0),__decorate([s({type:cc.Node,displayName:"\u63d0\u793a\u7bad\u5934"})],t.prototype,"tipArror",void 0),t=__decorate([c],t)}(a.default);n.default=l,cc._RF.pop()},{"../../Logic/CollectLogic":"CollectLogic","../../core/GameHelper":"GameHelper","../base/View":"View"}],CommonUils:[function(e,t,n){"use strict";cc._RF.push(t,"d03a0cezstHyKqPKricZv+P","CommonUils"),Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,o=a.ccclass,i=(a.property,function(){function e(){}return e.transRelativePos=function(e,t){var n=t.getParent().convertToWorldSpaceAR(t.position);return e.getParent().convertToNodeSpaceAR(n)},e.transRelativeFromPos=function(e,t){var n=e.convertToWorldSpaceAR(t);return cc.v2(n.x-.5*cc.winSize.width,n.y-.5*cc.winSize.height)},e.converCHNumber=function(e){return(e=Math.floor(e))<0&&(e=0),e>9&&(e=9),this.chNumArr[e]},e.chNumArr=["zero","One","two","three","four","Fives","six","Seven","Eight","nine"],e=__decorate([o],e)}());n.default=i,cc._RF.pop()},{}],ConfigID:[function(e,t,n){"use strict";cc._RF.push(t,"6173e1Y70hLdqnK5aGClIKP","ConfigID"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(){}return e.Garden="garden",e.Plant="plant",e.Buff="buff",e.Pot="pot",e.Teach="teach",e.Desc="desc",e.Detail="detail",e}();n.default=a,cc._RF.pop()},{}],ConfirmView:[function(e,t,n){"use strict";cc._RF.push(t,"8ccc42W/jFK7LdCDZQWizwi","ConfirmView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("../UIManager"),i=e("../../Core/ResourcesManager"),r=cc._decorator,c=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.confirmBtn=null,t.closeBtn2=null,t.desc=null,t.icon=null,t.confirmTxt=null,t.cancelTxt=null,t.callBack=null,t}return __extends(t,e),t.prototype.start=function(){this.AddEvents()},t.prototype.Init=function(e){var t=this;e.iconPath&&e.iconRoot?(this.icon.node.parent.active=!0,i.default.instance.load(e.iconPath,function(e){t.icon.spriteFrame=e},cc.SpriteFrame,!1,!1,e.iconRoot)):this.icon.node.parent.active=!1,e.desc?(this.desc.node.parent.active=!0,this.desc.string=e.desc):this.desc.node.parent.active=!1,this.callBack=e.callback,this.confirmTxt.string=e.confirmStr?e.confirmStr:"Yes",this.cancelTxt.string=e.cancelStr?e.cancelStr:"cancel"},t.prototype.AddEvents=function(){this.confirmBtn.on(cc.Node.EventType.TOUCH_END,this.OnConfirmBtnTap,this),this.closeBtn2.on(cc.Node.EventType.TOUCH_END,this.OnCloseBtn2Tap,this)},t.prototype.OnConfirmBtnTap=function(e){this.callBack&&this.callBack(),o.default.instance.closeView(this.node.name)},t.prototype.OnCloseBtn2Tap=function(e){o.default.instance.closeView(this.node.name)},__decorate([s({type:cc.Node,displayName:"\u786e\u5b9a\u6309\u94ae"})],t.prototype,"confirmBtn",void 0),__decorate([s({type:cc.Node,displayName:"\u5173\u95ed\u6309\u94ae"})],t.prototype,"closeBtn2",void 0),__decorate([s({type:cc.Label,displayName:"\u63cf\u8ff0\u6587\u5b57"})],t.prototype,"desc",void 0),__decorate([s({type:cc.Sprite,displayName:"\u56fe\u6807"})],t.prototype,"icon",void 0),__decorate([s({type:cc.Label,displayName:"\u786e\u8ba4\u6587\u672c"})],t.prototype,"confirmTxt",void 0),__decorate([s({type:cc.Label,displayName:"\u53d6\u6d88\u6587\u672c"})],t.prototype,"cancelTxt",void 0),t=__decorate([c],t)}(a.default);n.default=l,cc._RF.pop()},{"../../Core/ResourcesManager":"ResourcesManager","../Base/View":"View","../UIManager":"UIManager"}],DataID:[function(e,t,n){"use strict";cc._RF.push(t,"63b6aU6+gJBD7WS91AmZdha","DataID"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(){}return e.sts="sts",e.sdate="sdate",e.oxy="oxy",e.toxy="toxy",e.gameData="gd",e.rv="rv",e.gardenData="gard",e.day="day",e.bs="bs",e.signInData="sid",e.collectState="cs",e.firstPlayDate="fpd",e.addProductTimes="adt",e}();n.default=a,cc._RF.pop()},{}],DataManager:[function(e,t,n){"use strict";cc._RF.push(t,"6519e8HX/RFX5wIXaX6kZBd","DataManager"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Core/Server"),o=e("../Core/GameHelper"),i=e("../Core/ResourcesManager"),r=e("./ConfigID"),c=e("../Data/BuffData"),s=e("../Data/GameData"),l=e("./DataID"),d=e("../Data/GardenData"),u=e("../Data/SignInData"),p=e("../Core/RewardLogic"),f=e("../Core/DataStorage"),h=e("../UI/UIManager"),g=e("../Logic/EconomicLogic"),m=e("../Libs/bignumber"),y=e("../Logic/ShopLogic"),v=e("../Logic/CollectLogic"),_=cc._decorator,S=_.ccclass,w=(_.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollEventInterval=2,t.lastDate=0,t.leaveTime=-1,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GardenCnf",{get:function(){return this._gardenCnf},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PlantCnf",{get:function(){return this._plantCnf},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BuffCnf",{get:function(){return this._buffCnf},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TeachCnf",{get:function(){return this._teachCnf},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this;return new Promise(function(t,n){e.LoadDataFromServer().then(function(n){if("string"==typeof n&&""!=n&&"null"!=n){var a=JSON.parse(n);void 0===a[l.default.toxy]||-1!=new m.default(f.default.getItem(l.default.toxy,"0")).comparedTo(a[l.default.toxy])?(o.default.Log("\u670d\u52a1\u7aef\u6570\u636e\u4e0d\u5982\u672c\u5730"),e.LoadDataFromLocal()):e.SetServerData(a)}else o.default.Log("\u670d\u52a1\u7aef\u6ca1\u6570\u636e"),e.LoadDataFromLocal();e.updateDataEveryDay(),t()},function(n){o.default.Log("\u670d\u52a1\u7aef\u8bf7\u6c42\u5931\u8d25:",n),e.LoadDataFromLocal(),e.updateDataEveryDay(),t()})})},t.prototype.LoadDataFromLocal=function(){var e=this;o.default.Log("\u4ece\u672c\u5730\u52a0\u8f7d\u6570\u636e"),p.default.instance.shareTimes=f.default.getIntItem(l.default.sts,0),p.default.instance.shareDate=f.default.getItem(l.default.sdate,""),this.lastDate=f.default.getIntItem(l.default.day,Date.now()-1728e5),console.log("\u8bfb\u53d6\u5230\u7684\u4e0a\u6b21\u65e5\u671f"+this.lastDate),this.beginerStage=f.default.getIntItem(l.default.bs,1),this.firstPlayDay=f.default.getIntItem(l.default.firstPlayDate,0),0==this.firstPlayDay&&n.instance.GetNow(!0).then(function(t){-1==t&&(t=n.instance.Now()),e.firstPlayDay=t,f.default.setItem(l.default.firstPlayDate,e.firstPlayDay)}),g.default.instance.oxy=new m.default(f.default.getItem(l.default.oxy,"500")),g.default.instance.toxy=new m.default(f.default.getItem(l.default.toxy,"500")),y.default.instance.LoadAddProductTimes(),s.default.data,d.default.data,u.default.data,v.default.instance.getCollectState()},t.prototype.SetServerData=function(e){var t=this;o.default.Log("\u8bbe\u7f6e\u670d\u52a1\u7aef\u6570\u636e");var a=new m.default(e[l.default.oxy]),i=new m.default(e[l.default.toxy]);g.default.instance.SetEcoData(a,i),void 0===e[l.default.sts]?p.default.instance.shareTimes=e[l.default.sts]:(p.default.instance.shareTimes=f.default.getIntItem(l.default.sts,0),p.default.instance.SaveShareTimes()),void 0===e[l.default.sdate]?p.default.instance.shareDate=e[l.default.sdate]:(p.default.instance.shareDate=f.default.getItem(l.default.sdate,""),p.default.instance.SaveLastShareDate()),void 0===e[l.default.gameData]?s.default.data:s.default.SetData(e[l.default.gameData]),void 0===e[l.default.gardenData]?d.default.data:d.default.SetData(e[l.default.gardenData]),void 0===e[l.default.day]?this.lastDate=f.default.getIntItem(l.default.day,Date.now()-1728e5):(this.lastDate=e[l.default.day],f.default.setItem(l.default.day,this.lastDate)),void 0===e[l.default.signInData]?u.default.data:u.default.SetData(e[l.default.signInData]),void 0===e[l.default.bs]?this.beginerStage=f.default.getIntItem(l.default.bs,1):(this.beginerStage=e[l.default.bs],f.default.setItem(l.default.bs,this.beginerStage)),void 0===e[l.default.firstPlayDate]?(this.firstPlayDay=f.default.getIntItem(l.default.firstPlayDate,0),0==this.firstPlayDay&&n.instance.GetNow(!0).then(function(e){-1==e&&(e=n.instance.Now()),t.firstPlayDay=e,f.default.setItem(l.default.firstPlayDate,t.firstPlayDay)})):(this.firstPlayDay=e[l.default.firstPlayDate],f.default.setItem(l.default.firstPlayDate,this.firstPlayDay)),void 0===e[l.default.addProductTimes]?y.default.instance.LoadAddProductTimes():(y.default.instance.addProductTimes=e[l.default.addProductTimes],y.default.instance.SaveAddProductTimes()),void 0===e[l.default.collectState]?v.default.instance.getCollectState():(v.default.instance.collectState=e[l.default.collectState],v.default.instance.SaveCollectState())},t.prototype.LoadDataFromServer=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,t){a.default.GetData(function(t){o.default.Log("\u8bfb\u53d6\u5230\u7684\u670d\u52a1\u7aef\u6570\u636e:",t),e(t)},function(e){t(e)})})]})})},t.prototype.SaveDataToServer=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return(e={})[l.default.oxy]=g.default.instance.oxy.toString(),e[l.default.toxy]=g.default.instance.toxy.toString(),e[l.default.sts]=p.default.instance.shareTimes,e[l.default.sdate]=p.default.instance.shareDate,e[l.default.gameData]=s.default.data,e[l.default.gardenData]=d.default.data,e[l.default.signInData]=u.default.data,e[l.default.bs]=this.beginerStage,[4,n.instance.GetNow(!0).then(function(t){e[l.default.day]=t})];case 1:return t.sent(),e[l.default.firstPlayDate]=this.firstPlayDay,e[l.default.addProductTimes]=y.default.instance.addProductTimes,e[l.default.collectState]=v.default.instance.collectState,o.default.Log("\u51c6\u5907\u4fdd\u5b58\u6570\u636e\u5230\u670d\u52a1\u5668",e),a.default.saveData(JSON.stringify(e),function(e){}),[2]}})})},t.prototype.SaveLocalData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return g.default.instance.SaveEconomic(),[4,this.GetNow(!0).then(function(e){s.default.data.lastPlayTime=e})];case 1:return e.sent(),s.default.SaveData(),d.default.SaveData(),[2]}})})},t.prototype.ScheduleSaveData=function(){var e=this,t=0;this.schedule(function(){++t%4&&e.SaveDataToServer(),e.SaveLocalData()},30)},t.prototype.LoadConfigDatas=function(e){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){switch(n.label){case 0:return[4,i.default.instance.loadJson(r.default.Buff).then(function(e){t._buffCnf=e})];case 1:return n.sent(),[4,i.default.instance.loadJson(r.default.Garden).then(function(e){t._gardenCnf=e})];case 2:return n.sent(),[4,i.default.instance.loadJson(r.default.Plant).then(function(e){t._plantCnf=e})];case 3:return n.sent(),[4,i.default.instance.loadJson(r.default.Teach).then(function(e){t._teachCnf=e})];case 4:return n.sent(),[4,i.default.instance.loadJson(r.default.Desc).then(function(e){t._descCnf=e})];case 5:return n.sent(),[4,i.default.instance.loadJson(r.default.Detail).then(function(e){t._detailCnf=e})];case 6:return n.sent(),this.OnConfigLoadComp(),e&&e(),[2]}})})},t.prototype.OnConfigLoadComp=function(){},t.prototype.updateDataEveryDay=function(){var e=this;this.GetNow(!0).then(function(t){e.RefreshNewDayData(t,e.lastDate)})},t.prototype.RefreshNewDayData=function(e,t){var n,a=u.default.data;if(-1!=t?n=new Date(t):this.lastDate=e,-1!=t&&-1!=e&&new Date(e-216e5).toDateString()!=new Date(n.getTime()-216e5).toDateString()){if(o.default.Log("Today's date:"+new Date(e-216e5).toDateString()),o.default.Log("Last date:"+new Date(n.getTime()-216e5).toDateString()),o.default.Log("New day is here"),p.default.instance.checkDate(),a.loginTimes++,o.default.Log("Landing"+a.loginTimes+"day"),8==a.loginTimes)a.loginTimes=1,a.signInDay=[1,0,0,0,0,0,0];else for(var i=0;i<a.signInDay.length;i++)i<a.loginTimes?0==a.signInDay[i]&&(a.signInDay[i]=1):a.signInDay[i]=0;u.default.SaveData(),this.lastDate=e,f.default.setItem(l.default.day,this.lastDate)}else o.default.Log("Do not refresh data");h.default.isPopSignIn=!1;for(i=0;i<a.signInDay.length;++i)if(1==a.signInDay[i]){h.default.isPopSignIn=!0;break}},t.prototype.GetPlantConfig=function(e){return this._plantCnf[e-1]},t.prototype.GetGardenConfig=function(e){return e>d.default.MaxLv&&(e=d.default.MaxLv),this._gardenCnf.filter(function(t){return t.lv==e})[0]},t.prototype.GetBuffConfig=function(e,t){return t>c.default.MaxLv&&(t=c.default.MaxLv),this._buffCnf.filter(function(n){return n.type==e&&n.lv==t})[0]},t.prototype.GetTeachConfig=function(e){return this._teachCnf.filter(function(t){return t.id==e})},t.prototype.GetDescConfig=function(e){return this._descCnf.filter(function(t){return t.id==parseInt(e)})[0]},t.prototype.GetDetailConfig=function(e){return this._detailCnf.filter(function(t){return t.id==parseInt(e)})[0]},t.prototype.GetNow=function(e){return void 0===e&&(e=!1),__awaiter(this,void 0,Promise,function(){return __generator(this,function(t){return[2,new Promise(function(t,n){e?a.default.getServerDate(function(e){t(e)}):t(Date.now())})]})})},t.prototype.Now=function(){return Date.now()},t.prototype.SetBeginerStage=function(e){console.log("Setting up the novice stage:"+e),this.beginerStage=e,f.default.setItem(l.default.bs,this.beginerStage)},t=n=__decorate([S],t)}(cc.Component));n.default=w,cc._RF.pop()},{"../Core/DataStorage":"DataStorage","../Core/GameHelper":"GameHelper","../Core/ResourcesManager":"ResourcesManager","../Core/RewardLogic":"RewardLogic","../Core/Server":"Server","../Data/BuffData":"BuffData","../Data/GameData":"GameData","../Data/GardenData":"GardenData","../Data/SignInData":"SignInData","../Libs/bignumber":"bignumber","../Logic/CollectLogic":"CollectLogic","../Logic/EconomicLogic":"EconomicLogic","../Logic/ShopLogic":"ShopLogic","../UI/UIManager":"UIManager","./ConfigID":"ConfigID","./DataID":"DataID"}],DataStorage:[function(e,t,n){"use strict";cc._RF.push(t,"68008FatJBC2oG9+1Dpf9RR","DataStorage"),Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,o=a.ccclass,i=(a.property,function(){function e(){}return e.getItem=function(e,t){void 0===t&&(t=null);var n=cc.sys.localStorage.getItem(e);return n||t},e.getIntItem=function(e,t){var n=parseInt(cc.sys.localStorage.getItem(e));return n||t},e.getFloatItem=function(e,t){var n=parseFloat(cc.sys.localStorage.getItem(e));return n||t},e.setItem=function(e,t){"undefined"!=typeof wx?wx.setStorage({key:e,data:t,success:null,fail:null,complete:null}):cc.sys.localStorage.setItem(e,t)},e.removeItem=function(e){return cc.sys.localStorage.removeItem(e)},e=__decorate([o],e)}());n.default=i,cc._RF.pop()},{}],DescConfig:[function(e,t,n){"use strict";cc._RF.push(t,"542adKIaTlG+6ZcNdnliW4Z","DescConfig"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){return function(){this.id=0,this.desc=""}}();n.default=a,cc._RF.pop()},{}],DetailConfig:[function(e,t,n){"use strict";cc._RF.push(t,"d63dfYm6mVAna3rpK1ZP2nB","DetailConfig"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){return function(){this.id=0,this.desc=""}}();n.default=a,cc._RF.pop()},{}],Diamond:[function(e,t,n){"use strict";cc._RF.push(t,"dc803GzOu9KAasvQS5MD8G8","Diamond"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Core/ResourcesPool"),o=cc._decorator,i=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){},t.prototype.getKey=function(){return"Diamond"},t.prototype.awake=function(){this.node.position=cc.Vec2.ZERO,this.node.active=!0},t.prototype.sleep=function(){this.node.stopAllActions(),this.node.setParent(null),this.node.active=!1},t.prototype.destroySelf=function(){a.default.instance.put(this,50)},t=__decorate([i],t)}(cc.Component));n.default=r,cc._RF.pop()},{"../../Core/ResourcesPool":"ResourcesPool"}],EconomicLogic:[function(e,t,n){"use strict";cc._RF.push(t,"ae453mJdmhG5L9HLlm1j98h","EconomicLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../Libs/bignumber"),i=e("../Common/EventID"),r=e("../Data/GameData"),c=e("../Core/DataStorage"),s=e("../Common/DataID"),l=e("../UI/ToolBar/BottomToolBar"),d=e("../UI/UIManager"),u=e("../Common/CommonUils"),p=e("../UI/ToolBar/TopToolBar"),f=e("../UI/Garden/Oxy"),h=e("../UI/Garden/Diamond"),g=e("./GardenLogic"),m=e("../Sound/SoundManager"),y=e("../Sound/SoundClip");(function(e){e[e.COIN=1]="COIN",e[e.DIAMOND=2]="DIAMOND"})(a=n.EconomicTypeEnum||(n.EconomicTypeEnum={}));var v=function(){function e(){this.unitArr=[""," K"," M"," G"," T"," P"," E"," KM"," KM"," KG"," KT"]}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oxy",{get:function(){return this._oxy},set:function(e){this._oxy=e,cc.systemEvent.emit(i.default.oxy_changed)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toxy",{get:function(){return this._toxy},set:function(e){this._toxy=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diamond",{get:function(){return r.default.data.diamond},set:function(e){r.default.data.diamond!=e&&(r.default.data.diamond=e,l.default.instance.ShowShopRedDot(),cc.systemEvent.emit(i.default.diamond_changed))},enumerable:!0,configurable:!0}),e.prototype.SetEcoData=function(e,t){this.oxy=e,this.toxy=t,this.SaveEconomic()},e.prototype.SaveEconomic=function(){c.default.setItem(s.default.oxy,this.oxy.toString()),c.default.setItem(s.default.toxy,this.toxy.toString())},e.prototype.AddOxy=function(e){0!=e&&(this.oxy=this.oxy.plus(e),this.toxy=this.toxy.plus(e))},e.prototype.SubOxy=function(e){0!=e&&(this.oxy=this.oxy.minus(e))},e.prototype.getOxyUnitFormat=function(){return this.oxy?this.converUnitFormat(this.oxy):"0"},e.prototype.number2UnitFormat=function(e){return this.converUnitFormat(new o.default(e))},e.prototype.converUnitFormat=function(e){for(var t=e.toFixed(0),n=[],a=t.length;a>0;)n.push(t.substring(a-3,a)),a-=3;if(n.length<=1)return t;n.reverse();var o="";if((a=n.length)>this.unitArr.length){for(var i=0;i<=a-this.unitArr.length;++i)o+=n[i];if(o.length<4){o+=".";for(i=0;i<4-o.length;++i)i==3-o.length?o+=parseFloat(n[a-this.unitArr.length+1][i]+"."+n[a-this.unitArr.length+1][i+1]).toFixed():o+=n[a-this.unitArr.length+1][i]}return o+this.unitArr[this.unitArr.length-1]}return o=n[0],"0"==n[1][1]?"0"==n[1][0]||(o+="."+n[1][0]):o+="."+n[1][0]+n[1][1],o+this.unitArr[a-1]},e.prototype.getUnitRound=function(e){for(var t=e.toFixed(),n=[],a=t.length;a>0;)n.push(t.substring(a-4,a)),a-=4;return n.length<=1?e:(a=n.length)<this.unitArr.length?Math.round(e/Math.pow(10,4*(a-1)))*Math.pow(10,4*(a-1)):Math.round(e/Math.pow(10,4*(this.unitArr.length-1)))*Math.pow(10,4*(this.unitArr.length-1))},e.prototype.effectEco=function(e,t,n,i,r,c,s){var l,v=this;void 0===r&&(r=null),void 0===c&&(c=null),void 0===s&&(s=null),l=t==a.COIN?new o.default(e).dividedBy(n):e/n;for(var _=0,S=(Math.floor(n/7),0);S<n;++S){var w=void 0;switch(t){case a.COIN:w=g.default.instance.getOxy();break;case a.DIAMOND:w=g.default.instance.getDiamond()}w.node.setParent(d.default.instance.viewLayers[d.LayerType.FRONT]),w.node.position=i;var C=void 0;if(c)C=c;else switch(t){case a.COIN:C=p.default.instance.coinIco;break;case a.DIAMOND:C=p.default.instance.diamondIco}var T=u.default.transRelativePos(w.node,C);w.node.opacity=0,w.node.zIndex=200,w.node.runAction(cc.sequence(cc.delayTime(.2*Math.random()),cc.callFunc(function(e){e.opacity=255}),cc.bezierTo(.6*Math.random()+.4,[i,cc.v2((T.x+w.node.x)/2+400*Math.random()-200,(T.y+w.node.y)/2+400*Math.random()-200),T]).easing(cc.easeOut(.5)),cc.callFunc(function(e){switch(_++,t){case a.COIN:e.getComponent(f.default).destroySelf(),v.AddOxy(l.toString()),g.default.instance.PlayWaterSound();break;case a.DIAMOND:e.getComponent(h.default).destroySelf(),v.diamond+=l,m.default.instance.playAudioClip2(y.SoundClipType.diamond)}_!==n||r&&r()})))}},e}();n.default=v,cc._RF.pop()},{"../Common/CommonUils":"CommonUils","../Common/DataID":"DataID","../Common/EventID":"EventID","../Core/DataStorage":"DataStorage","../Data/GameData":"GameData","../Libs/bignumber":"bignumber","../Sound/SoundClip":"SoundClip","../Sound/SoundManager":"SoundManager","../UI/Garden/Diamond":"Diamond","../UI/Garden/Oxy":"Oxy","../UI/ToolBar/BottomToolBar":"BottomToolBar","../UI/ToolBar/TopToolBar":"TopToolBar","../UI/UIManager":"UIManager","./GardenLogic":"GardenLogic"}],EventID:[function(e,t,n){"use strict";cc._RF.push(t,"2102fuc0kpFnZIeCa6DNV4V","EventID"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(){}return e.scrolling="scrolling",e.banner_changed="banner_changed",e.oxy_changed="oxy_changed",e.diamond_changed="diamond_changed",e.level_changed="level_changed",e.levelexp_changed="levelexp_changed",e}();n.default=a,cc._RF.pop()},{}],GameData:[function(e,t,n){"use strict";cc._RF.push(t,"98bccinPspE5ZazeHNYX2OM","GameData"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Core/DataStorage"),o=e("../Common/DataID"),i=e("../Core/GameHelper"),r=function(){function e(){this.diamond=0,this.lastPlayTime=0,this.offlineTime=0,this.mute=0}return Object.defineProperty(e,"data",{get:function(){if(null==this._data){var t=a.default.getItem(o.default.gameData);t&&(this._data=JSON.parse(t)),this._data||(this._data=new e)}return this._data},enumerable:!0,configurable:!0}),e.SetData=function(e){this._data=e,this.SaveData()},e.SaveData=function(){i.default.Log("Save game data"),this._data&&a.default.setItem(o.default.gameData,JSON.stringify(this._data))},e}();n.default=r,cc._RF.pop()},{"../Common/DataID":"DataID","../Core/DataStorage":"DataStorage","../Core/GameHelper":"GameHelper"}],GameHelper:[function(e,t,n){"use strict";cc._RF.push(t,"b9d69xsZqVIfoivJ3S8zBqJ","GameHelper"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Common/EventID"),o=function(){function e(){}return e.Log=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.log(e,t)},e.DispatchEvent=function(e,t,n,a){void 0===n&&(n=null),void 0===a&&(a=!1);var o=new cc.Event.EventCustom(t,a);o.setUserData(n),e.dispatchEvent(o)},e.UploadUserScore=function(e){var t={score:e,bscore:JSON.stringify({wxgame:{score:e,update_time:Math.floor((new Date).getTime())}})};SDK.updateScore(t,null,null,null)},e.nextFile=function(t,n,a,o,i){if(t<n.files.length){var r=a+"/"+n.files[t];o.statSync(r).isDirectory()?this.cleanAllFiles(r,function(){e.nextFile(t+1,n,a,o,i)}):o.unlink({filePath:r,success:function(){cc.log("unlink local file "+r+" successfully!")},fail:function(e){cc.warn("failed to unlink file("+r+"): "+e?e.errMsg:"unknown error")},complete:function(){e.nextFile(t+1,n,a,o,i)}})}else i&&i()},e.cleanAllFiles=function(t,n){var a=wx.getFileSystemManager();a.readdir({dirPath:t,success:function(o){e.nextFile(0,o,t,a,n)},fail:function(e){n&&n()}})},e.GetClockTime=function(e){return e-e%36e5},e.TransClockTime=function(e){e=Math.floor(e/1e3);var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),a=e%60;return(t<10?"0":"")+t+":"+(n<10?"0":"")+n+":"+(a<10?"0":"")+a},e.getLocaleDateString=function(e){var t=e.getFullYear().toString(),n=e.getMonth()+1;return t+"/"+(n<10?"0"+n:n.toString())+"/"+(e.getDate()<10?"0"+e.getDate():e.getDate().toString())},e.SetDebugPos=function(e){if(cc.profiler){var t=cc.director.getScene().getChildByName("PROFILER-NODE");if(t){t.position=e;var n=t.getChildByName("LEFT-PANEL");n&&(n.getComponent(cc.Label).fontSize=30);var a=t.getChildByName("RIGHT-PANEL");a&&(a.x=350,a.getComponent(cc.Label).fontSize=30)}}},Object.defineProperty(e,"IsWX",{get:function(){return"undefined"!=typeof wx},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsQQ",{get:function(){return void 0!==window.qq},enumerable:!0,configurable:!0}),e.getIntervalDays=function(e,t,n){return void 0===n&&(n=8),this.getDay(t,n)-this.getDay(e,n)},e.isSameDay=function(e,t,n){return void 0===n&&(n=8),this.getDay(e,n)==this.getDay(t,n)},e.isToday=function(e,t){return void 0===t&&(t=8),this.getDay((new Date).getTime(),t)==this.getDay(e,t)},e.getDay=function(e,t){return void 0===t&&(t=8),Math.floor(new Date(e).getTime()/864e5+t/24)},e.InitBannerHeight=function(){void 0===window.qq||this.bannerHeight>0||(this.bannerHeight=234,cc.systemEvent.emit(a.default.banner_changed))},e.loginTime=0,e.bannerHeight=0,e}();n.default=o,cc._RF.pop()},{"../Common/EventID":"EventID"}],GardenConfig:[function(e,t,n){"use strict";cc._RF.push(t,"dd37cQEJKZAYqKApZ/Yq0lH","GardenConfig"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){return function(){this.lv=0,this.exp=0,this.coin=0}}();n.default=a,cc._RF.pop()},{}],GardenData:[function(e,t,n){"use strict";cc._RF.push(t,"fbc3b1hfLZE1a3A01F2R6t5","GardenData"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Core/DataStorage"),o=e("../Common/DataID"),i=e("./BuffData"),r=e("../Logic/PlantLogic"),c=function(){function e(){this.level=1,this.exp=0,this.unlockTier=2,this.plants=[],this.buff=[]}return Object.defineProperty(e,"data",{get:function(){if(null==this._data){var t=a.default.getItem(o.default.gardenData);console.log("Data string:"+t),void 0!==t&&(this._data=JSON.parse(t)),this._data||(this._data=new e,this._data.plants.push(r.default.instance.New({id:1,pos:0})),this._data.buff.push(i.default.New({type:i.BuffTypeEnum.PHOTOSYNTHESIS})),this._data.buff.push(i.default.New({type:i.BuffTypeEnum.WATERING})),this._data.buff.push(i.default.New({type:i.BuffTypeEnum.FERTILIZER})),this._data.buff.push(i.default.New({type:i.BuffTypeEnum.OFFLINE})))}return this._data},enumerable:!0,configurable:!0}),e.SetData=function(e){this._data=e,this.SaveData()},e.SaveData=function(){this._data&&a.default.setItem(o.default.gardenData,JSON.stringify(this._data))},e.MaxLv=1e4,e.MaxTier=26,e}();n.default=c,cc._RF.pop()},{"../Common/DataID":"DataID","../Core/DataStorage":"DataStorage","../Logic/PlantLogic":"PlantLogic","./BuffData":"BuffData"}],GardenLogic:[function(e,t,n){"use strict";cc._RF.push(t,"6be4fnzn+pAdJCWNhuL6guR","GardenLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../UI/ToolBar/TopToolBar"),i=e("../UI/ToolBar/BottomToolBar"),r=e("../Data/GardenData"),c=e("../Common/DataManager"),s=e("../Common/EventID"),l=e("../UI/Garden/Garden"),d=e("./EconomicLogic"),u=e("../Core/GameHelper"),p=e("./PlantLogic"),f=e("../Data/GameData"),h=e("../Core/RewardLogic"),g=e("../Core/ShareLogic"),m=e("../Data/BuffData"),y=e("../UI/UIManager"),v=e("../UI/Reward/RewardView"),_=e("../UI/Garden/PopupEcoTip"),S=e("../Core/ResourcesManager"),w=e("../Common/PrefabID"),C=e("../Core/ResourcesPool"),T=e("../UI/Garden/Diamond"),D=e("../UI/Garden/Oxy"),b=e("./BuffLogic"),B=e("./TeachLogic"),L=e("../Core/MathUtil"),P=e("../Sound/SoundClip"),N=e("../Sound/SoundManager"),E=e("../Core/Server"),I=e("../Common/ReportEventID"),A=e("../UI/Teach/TeachView"),R=e("./AtlasLogic");(function(e){e[e.PRODUCT=0]="PRODUCT",e[e.PLACE=1]="PLACE",e[e.BUY=2]="BUY",e[e.STORE=3]="STORE"})(a=n.TapModeEnum||(n.TapModeEnum={}));var O=function(){function e(){this.tierFirHeight=120,this.tierHeight=320,this.tapMode=a.PRODUCT,this.plantId=-1,this.isCanUpgrade=!1,this.plants=[],this.plantOffset=[cc.v2(-195,50),cc.v2(-65,50),cc.v2(65,50),cc.v2(195,50)],this.canPopUpgrade=!1,this.lastTapTime=0,this.lastUsePropTime=0}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e,this._instance.Init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.Init=function(){this.curLvCnf=c.default.instance.GetGardenConfig(r.default.data.level),this.isCanUpgrade=this.CheckUpgrade(),this.lastTapTime=c.default.instance.Now()-1e3},e.prototype.ToProductMode=function(){this.tapMode=a.PRODUCT,o.default.instance.placeNode.active=!1,i.default.instance.productNode.active=!0,this.ShowProductNode(),l.default.instance.HideAllArea(),l.default.instance.scrollView.enabled=!0},e.prototype.ToPlaceMode=function(){this.tapMode=a.PLACE,this.HideProductNode(),o.default.instance.placeNode.active=!0,i.default.instance.placeNode.active=!0,l.default.instance.HideAllArea(),l.default.instance.scrollView.enabled=!1},e.prototype.ToBuyMode=function(e){this.tapMode=a.BUY,this.plantId=e,l.default.instance.ShowAllArea()},e.prototype.ToStoreMode=function(e){this.tapMode=a.STORE,this.plantId=e,l.default.instance.ShowAllArea()},e.prototype.ResetToolBarHeight=function(e){void 0===e&&(e=0)},e.prototype.PlantItem=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,o,s,f,h=this;return __generator(this,function(g){switch(g.label){case 0:if(-1==this.plantId)return this.tapMode==a.BUY&&this.ToProductMode(),u.default.Log("Planting failure!"),[2];if(l.default.instance.RemovePlant(e),t=r.default.data.plants.filter(function(e){return e.id==h.plantId}).length+1,n=c.default.instance.GetPlantConfig(this.plantId),1==t)switch(o=n.coin,d.default.instance.SubOxy(o),n.ul){case 2:E.default.reportEvent(I.default.plant_buy_lv2,I.default.def_page);break;case 5:E.default.reportEvent(I.default.plant_buy_lv5,I.default.def_page);break;case 10:E.default.reportEvent(I.default.plant_buy_lv10,I.default.def_page);break;case 15:E.default.reportEvent(I.default.plant_buy_lv15,I.default.def_page);break;case 20:E.default.reportEvent(I.default.plant_buy_lv20,I.default.def_page)}else switch(n.ul){case 1:E.default.reportEvent(I.default.plant_rebuy_lv1,I.default.def_page);break;case 2:E.default.reportEvent(I.default.plant_rebuy_lv2,I.default.def_page);break;case 5:E.default.reportEvent(I.default.plant_rebuy_lv5,I.default.def_page);break;case 10:E.default.reportEvent(I.default.plant_rebuy_lv10,I.default.def_page);break;case 15:E.default.reportEvent(I.default.plant_rebuy_lv15,I.default.def_page);break;case 20:E.default.reportEvent(I.default.plant_rebuy_lv20,I.default.def_page)}return s=p.default.instance.New({id:this.plantId,pos:e,seed:t}),r.default.data.plants.push(s),this.plants.push(s),f=this.Pos2RC(e),[4,l.default.instance.AddPlant(s,f[0],f[1])];case 1:return g.sent(),this.ToProductMode(),i.default.instance.RefreshPlantRedDot(),[2]}})})},e.prototype.StoreItem=function(e){if(-1!=this.plantId)if(l.default.instance.plants.filter(function(t){return t.pos==e}).length>0)console.log("There are plants at the current location!");else{var t=r.default.data.plants[this.plantId];t.pos=e,this.plants.push(t);var n=this.Pos2RC(e);l.default.instance.AddPlant(t,n[0],n[1]),i.default.instance.ChangeStoreNum(-1),this.ToPlaceMode()}},e.prototype.HideProductNode=function(){o.default.instance.productNode.active=!1,i.default.instance.productNode.active=!1},e.prototype.ShowProductNode=function(){o.default.instance.productNode.active=!0,i.default.instance.placeNode.active=!1},e.prototype.CheckUpgrade=function(){return r.default.data.level<r.default.MaxLv&&r.default.data.exp>=this.curLvCnf.exp},e.prototype.PopUpgradeReward=function(){var e=this;u.default.Log("Pop up the upgrade window"),E.default.reportEvent(I.default.upgrade_pop_times,I.default.def_page),e.upgradeReward||(e.upgradeReward=new v.RewardData,e.upgradeReward.shareType=g.ShareTypeEnum.LEVELUP,e.upgradeReward.rewardTypes=[v.RewardTypeEnum.OXY],e.upgradeReward.ratio=3,e.upgradeReward.desc="Can receive upgrade rewards"),e.upgradeReward.rewardVals=[e.curLvCnf.coin],e.curLvCnf.lv<10?e.upgradeReward.rewardMethod=h.RewardMethodEnum.VIDEO:e.upgradeReward.rewardMethod=h.default.instance.ShareOrVideo(g.ShareTypeEnum.LEVELUP),e.upgradeReward.title="Congratulations",e.upgradeReward.callback=function(t){e.Upgrade(),t>1&&(E.default.reportEvent(I.default.upgrade_motive,I.default.def_page),e.upgradeReward.rewardMethod==h.RewardMethodEnum.SHARE?E.default.reportEvent(I.default.upgrade_motive_share,I.default.def_page):e.upgradeReward.rewardMethod==h.RewardMethodEnum.VIDEO&&E.default.reportEvent(I.default.upgrade_motive_video,I.default.def_page))},y.default.instance.OpenView(y.ViewName.RewardView,function(t){t.init(e.upgradeReward)})},e.prototype.Upgrade=function(){r.default.data.level++,u.default.UploadUserScore(r.default.data.level.toString()),this.isCanUpgrade=!1,r.default.data.exp=0,this.curLvCnf=c.default.instance.GetGardenConfig(r.default.data.level),cc.systemEvent.emit(s.default.level_changed),l.default.instance.RefreshUnlockTipTxt(),c.default.instance.SaveDataToServer(),c.default.instance.SaveLocalData();var e=c.default.instance.PlantCnf.filter(function(e){return e.ul==r.default.data.level});switch(e.length>0?R.default.instance.AddAtlasId(e[0].id,e[0].res,e[0].name):2==r.default.data.level?(c.default.instance.beginerStage=B.TeachStageEnum.UNLOCKPLANT,A.default.getInstance().then(function(e){e.ShowTeach()})):r.default.data.level==B.default.instance.buffUnlockLv?(c.default.instance.beginerStage=B.TeachStageEnum.UNLOCKBUFF,A.default.getInstance().then(function(e){e.ShowTeach()})):r.default.data.level==B.default.instance.shopUnlockLv?(c.default.instance.beginerStage=B.TeachStageEnum.UNLOCKSHOP,A.default.getInstance().then(function(e){e.ShowTeach()})):r.default.data.level==B.default.instance.rankUnlockLv&&(c.default.instance.beginerStage=B.TeachStageEnum.UNLOCKRANK,A.default.getInstance().then(function(e){e.ShowTeach()})),r.default.data.level){case 3:new Date(c.default.instance.firstPlayDay).toDateString()==new Date(c.default.instance.Now()).toDateString()&&E.default.reportEvent(I.default.level_3,I.default.def_page);break;case 5:new Date(c.default.instance.firstPlayDay).toDateString()==new Date(c.default.instance.Now()).toDateString()&&E.default.reportEvent(I.default.level_5,I.default.def_page);break;case 10:new Date(c.default.instance.firstPlayDay).toDateString()==new Date(c.default.instance.Now()).toDateString()&&E.default.reportEvent(I.default.level_10,I.default.def_page);break;case 20:new Date(c.default.instance.firstPlayDay).toDateString()==new Date(c.default.instance.Now()).toDateString()&&E.default.reportEvent(I.default.level_20,I.default.def_page)}},e.prototype.AddExp=function(e,t){void 0===t&&(t=0),this.isCanUpgrade?cc.systemEvent.emit(s.default.levelexp_changed):(t>0&&(this.lastTapTime=t),r.default.data.exp+e>=this.curLvCnf.exp?(r.default.data.exp=this.curLvCnf.exp,this.isCanUpgrade=!0,b.default.instance.isUse[m.BuffTypeEnum.WATERING]||b.default.instance.isUse[m.BuffTypeEnum.PHOTOSYNTHESIS]?E.default.reportEvent(I.default.upgrade_prop,I.default.def_page):c.default.instance.Now()-this.lastTapTime<1e3&&E.default.reportEvent(I.default.upgrade_manual,I.default.def_page)):r.default.data.exp+=e,cc.systemEvent.emit(s.default.levelexp_changed))},e.prototype.CalcBottomWidget=function(e){return this.tierFirHeight+e*this.tierHeight},e.prototype.CalcListHeight=function(){var e=r.default.data.unlockTier*this.tierHeight+250;return r.default.data.unlockTier<r.default.MaxTier?e+=this.tierHeight:e+=100,e},e.prototype.ResetContentHeight=function(){var e=this.CalcListHeight(),t=cc.view.getVisibleSize();e<t.height-80&&(e=t.height-80),l.default.instance.content.height=e},e.prototype.GetNextUnlockLv=function(e){return 20*(e-2)},e.prototype.GetNextUnlockOxy=function(e){return Math.round(27.5*Math.pow(this.GetNextUnlockLv(e),3))},e.prototype.CheckTierCanUnlock=function(){var e=this.GetNextUnlockLv(r.default.data.unlockTier+1);return r.default.data.level>=e?d.default.instance.number2UnitFormat(this.GetNextUnlockOxy(r.default.data.unlockTier+1))+"oxygen":"achieve "+e+" lv"},e.prototype.UnlockNewTier=function(){if(r.default.data.level>=this.GetNextUnlockLv(r.default.data.unlockTier+1)){var e=this.GetNextUnlockOxy(r.default.data.unlockTier+1);-1!=d.default.instance.oxy.comparedTo(e)&&(d.default.instance.SubOxy(e),r.default.data.unlockTier++,l.default.instance.UnlockTier(),u.default.Log("Unlock new layer"))}return!1},e.prototype.Pos2RC=function(e){return[Math.floor(e/4),e%4]},e.prototype.RC2Pos=function(e,t){return 4*e+t},e.prototype.Vec2Pos=function(e){if(e.y<this.tierFirHeight)return-2;var t=Math.floor((e.y-this.tierFirHeight)/this.tierHeight);if(t>=r.default.data.unlockTier)return-2;for(var n=-2,a=0;a<this.plantOffset.length;++a)if(e.x>this.plantOffset[a].x-80&&e.x<this.plantOffset[a].x+80){n=a;break}return-2==n?-2:this.RC2Pos(t,n)},e.prototype.Pos2Vec=function(e){var t=this.Pos2RC(e);return this.RC2Vec(t[0],t[1])},e.prototype.RC2Vec=function(e,t){var n=new cc.Vec2;return n.y=this.CalcBottomWidget(e),n.x=this.plantOffset[t].x,n.y+=this.plantOffset[t].y,n},e.prototype.GainProduct=function(e){for(var t=0,n=0;n<this.plants.length;++n)t+=this.plants[n].product;return t=t*p.default.instance.GetProductRatio()*e},e.prototype.CalcOffline=function(t){var n=this;if(-1!=c.default.instance.beginerStage)return y.default.isPopSignIn=!1,void(this.canPopUpgrade=!0);var a=0;if(-1!=t&&f.default.data.lastPlayTime<=0&&(f.default.data.lastPlayTime=t),a=Math.floor((t-f.default.data.lastPlayTime)/1e3),(a+=f.default.data.offlineTime)>28800&&(a=28800),-1!=t&&a>300){f.default.data.offlineTime=a;var o=h.default.instance.ShareOrVideo(g.ShareTypeEnum.OFFLINE),i=r.default.data.buff.filter(function(e){return e.type==m.BuffTypeEnum.OFFLINE})[0];if(i){var s=e.instance.GainProduct(a);s+=Math.floor(c.default.instance.GetBuffConfig(m.BuffTypeEnum.OFFLINE,i.level).effect*a);var l=b.default.instance.UseTime(Math.floor(f.default.data.lastPlayTime/1e3),Math.floor(t/1e3));l>0&&(u.default.Log("Offline item bonus"+l+"second"),s+=c.default.instance.GetBuffConfig(m.BuffTypeEnum.OFFLINE,i.level).effect*l);var d=new v.RewardData;d.rewardMethod=o,d.shareType=g.ShareTypeEnum.OFFLINE,d.rewardTypes=[v.RewardTypeEnum.OXY],d.rewardVals=[s],d.ratio=2,d.title="Offline revenue",d.desc="You accumulate offline"+(a/3600).toFixed(2)+"hour\uff0cAvailable",d.desc2="\uff08Highest obtainable8Hourly offline earnings\uff09",d.callback=function(e){f.default.data.offlineTime=0,n.AddExp(s)},y.default.instance.rewardDatas.push(d)}}else y.default.isPopSignIn?(y.default.isPopSignIn=!1,y.default.instance.OpenView(y.ViewName.SignInView)):this.canPopUpgrade=!0},e.prototype.CalcIncome=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,a;return __generator(this,function(o){switch(o.label){case 0:return c.default.instance.leaveTime<=0?[2]:[4,c.default.instance.GetNow(!0).then(function(t){e=Math.floor(t/1e3)})];case 1:return o.sent(),(t=e-c.default.instance.leaveTime)<=0?[2]:(n=.9*this.GainProduct(t),u.default.Log("Cut backstage income increased"+t+"second"),(a=b.default.instance.UseTime(c.default.instance.leaveTime,e))>0&&(n+=this.GainProduct(a),u.default.Log("Cut backstage props added"+a+"second")),d.default.instance.AddOxy(n),this.AddExp(n),[2])}})})},e.prototype.ShowPopupEcoNum=function(e,t,n,a){void 0===a&&(a=null),a||(a=y.default.instance.viewLayers[y.LayerType.FRONT]);var o=C.default.instance.get(w.default.PopupEcoTip),i=function(o){o.node.setParent(a),o.node.position=e,o.showEcoNum(t,n)};o?i(o):S.default.instance.load(w.default.PopupEcoTip,function(e){o=e.getComponent(_.default),i(o)})},e.prototype.getOxy=function(){var e=C.default.instance.get("Oxy");if(e)return e;var t=new cc.Node("Diamond");return t.addComponent(cc.Sprite).spriteFrame=l.default.instance.ecoIcons[d.EconomicTypeEnum.COIN-1],(e=t.addComponent(D.default)).node.position=cc.Vec2.ZERO,e.init(),e},e.prototype.getDiamond=function(){var e=C.default.instance.get("Diamond");if(e)return e;var t=new cc.Node("Diamond");return t.addComponent(cc.Sprite).spriteFrame=l.default.instance.ecoIcons[d.EconomicTypeEnum.DIAMOND-1],(e=t.addComponent(T.default)).node.position=cc.Vec2.ZERO,e.init(),e},e.prototype.PlayWaterSound=function(){var e=L.default.RandomInt(P.SoundClipType.water1,P.SoundClipType.water9);N.default.instance.playAudioClip2(e)},e}();n.default=O,cc._RF.pop()},{"../Common/DataManager":"DataManager","../Common/EventID":"EventID","../Common/PrefabID":"PrefabID","../Common/ReportEventID":"ReportEventID","../Core/GameHelper":"GameHelper","../Core/MathUtil":"MathUtil","../Core/ResourcesManager":"ResourcesManager","../Core/ResourcesPool":"ResourcesPool","../Core/RewardLogic":"RewardLogic","../Core/Server":"Server","../Core/ShareLogic":"ShareLogic","../Data/BuffData":"BuffData","../Data/GameData":"GameData","../Data/GardenData":"GardenData","../Sound/SoundClip":"SoundClip","../Sound/SoundManager":"SoundManager","../UI/Garden/Diamond":"Diamond","../UI/Garden/Garden":"Garden","../UI/Garden/Oxy":"Oxy","../UI/Garden/PopupEcoTip":"PopupEcoTip","../UI/Reward/RewardView":"RewardView","../UI/Teach/TeachView":"TeachView","../UI/ToolBar/BottomToolBar":"BottomToolBar","../UI/ToolBar/TopToolBar":"TopToolBar","../UI/UIManager":"UIManager","./AtlasLogic":"AtlasLogic","./BuffLogic":"BuffLogic","./EconomicLogic":"EconomicLogic","./PlantLogic":"PlantLogic","./TeachLogic":"TeachLogic"}],Garden:[function(e,t,n){"use strict";cc._RF.push(t,"ffed7vI5OtDFYpWwaZZ5z5t","Garden"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Data/GardenData"),o=e("../../Logic/GardenLogic"),i=e("../../Common/EventID"),r=e("../../Logic/EconomicLogic"),c=e("../../Core/ResourcesManager"),s=e("../../Common/PrefabID"),l=e("./Tier"),d=e("./Plant"),u=e("../../Core/GameHelper"),p=e("../../Logic/BuffLogic"),f=e("../../Data/BuffData"),h=e("../../Common/DataManager"),g=e("../ToolBar/BottomToolBar"),m=e("../../Sound/SoundManager"),y=e("../../Sound/SoundClip"),v=e("../ToolBar/TopToolBar"),_=e("../../Logic/PlantLogic"),S=e("../../Logic/TeachLogic"),w=e("../UIManager"),C=e("../Teach/TeachView"),T=cc._decorator,D=T.ccclass,b=T.property,B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.content=null,t.unlockTip=null,t.unlockTipTxt=null,t.shelfNode=null,t.plantNode=null,t.popNumNode=null,t.bubbleNode=null,t.clickNode=null,t.sunshineAni=null,t.waterAni=null,t.fertilizerAni=null,t.stageUpAni=null,t.ecoIcons=[],t.finger=null,t.circle=null,t.tiers=[],t.plants=[],t.sunSoundId=-1,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n._instance=this},t.prototype.start=function(){var e=this;this.init(),this.schedule(this.Update,1),this.scheduleOnce(function(){o.default.instance.ResetToolBarHeight(),e.InitBeginer(),e.InitFeedbackBtn()},.1)},t.prototype.InitFeedbackBtn=function(){if(void 0===window.qq&&"undefined"!=typeof wx&&"function"==typeof wx.createFeedbackButton){this.btnFeedback=wx.createFeedbackButton({type:"text",text:"Complaint feedback",style:{left:0,top:4,width:60,height:25,lineHeight:25,backgroundColor:"#1e2e2a",color:"#ffffff",textAlign:"center",fontSize:13,borderRadius:4}}),w.default.instance.openViewNum>0&&this.btnFeedback.hide()}else console.log("Not create")},t.prototype.InitBeginer=function(){h.default.instance.beginerStage>-1&&(1==h.default.instance.beginerStage&&C.default.getInstance().then(function(e){e.ShowTeach()}),h.default.instance.beginerStage<=S.TeachStageEnum.UNLOCKRANK&&(a.default.data.level<S.default.instance.rankUnlockLv&&(g.default.instance.btns[g.BottomBtnEnum.RANK].node.active=!1),h.default.instance.beginerStage<=S.TeachStageEnum.UNLOCKSHOP&&(a.default.data.level<S.default.instance.shopUnlockLv&&(g.default.instance.btns[g.BottomBtnEnum.SHOP].node.active=!1),h.default.instance.beginerStage<=S.TeachStageEnum.UNLOCKBUFF&&a.default.data.level<S.default.instance.buffUnlockLv&&(g.default.instance.btns[g.BottomBtnEnum.BUFF].node.active=!1))),a.default.data.level>=S.default.instance.rankUnlockLv&&(h.default.instance.beginerStage=-1,C.default.getInstance().then(function(e){e.ShowTeach()})))},t.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:e=a.default.data.unlockTier,t=0,n.label=1;case 1:return t<e?[4,this.AddTier(t)]:[3,4];case 2:n.sent(),n.label=3;case 3:return++t,[3,1];case 4:return this.RefreshUnlockTip(),this.ResetContentHeight(),this.OnScrolling(),1!=h.default.instance.beginerStage&&this.InitPlant(),this.AddEvents(),h.default.instance.GetNow(!0).then(function(e){o.default.instance.CalcOffline(e)}),[2]}})})},t.prototype.InitPlant=function(){o.default.instance.plants=a.default.data.plants.filter(function(e){return e.pos>-1});for(var e=0;e<o.default.instance.plants.length;++e){var t=Math.floor(o.default.instance.plants[e].pos/4),n=o.default.instance.plants[e].pos%4;t<this.tiers.length&&this.AddPlant(o.default.instance.plants[e],t,n)}},t.prototype.AddEvents=function(){this.unlockTip.on(cc.Node.EventType.TOUCH_END,this.OnUnlockTipTap,this),this.circle.getComponent(cc.Animation).on(cc.Animation.EventType.FINISHED,_.default.instance.LocatePlant,_.default.instance),this.scrollView.node.on(i.default.scrolling,this.OnScrolling,this),cc.systemEvent.on(i.default.banner_changed,o.default.instance.ResetToolBarHeight,this)},t.prototype.ScrollToTop=function(){this.scrollView.scrollToTop(),this.OnScrolling(),console.log("After unlock:"+this.content.y)},t.prototype.OnScrolling=function(){for(var e=function(e){var n=o.default.instance.CalcBottomWidget(t.tiers[e].getComponent(l.default).index);t.content.y+t.scrollView.node.height<-n-o.default.instance.tierHeight||t.content.y>-n?t.tiers[e].active&&(t.tiers[e].active=!1,u.default.Log("hideTier"+e),t.plants.filter(function(t){return t.row==e}).forEach(function(t){t.row==e&&(t.node.active=!1)})):t.tiers[e].active||(t.tiers[e].active=!0,u.default.Log("displayTier"+e),t.plants.filter(function(t){return t.row==e}).forEach(function(t){t.row==e&&(t.node.active=!0)}))},t=this,n=0;n<this.tiers.length;++n)e(n)},t.prototype.Update=function(){if(this.CheckBuff(),!S.default.instance.isTeach){for(var e=0,t=0;t<o.default.instance.plants.length;++t)e+=o.default.instance.plants[t].product;p.default.instance.isUse[f.BuffTypeEnum.PHOTOSYNTHESIS]&&(e*=2),p.default.instance.isUse[f.BuffTypeEnum.WATERING]&&(e*=10),e*=_.default.instance.GetProductRatio(),o.default.instance.AddExp(e),r.default.instance.AddOxy(e),cc.systemEvent.emit(i.default.oxy_changed)}this.UpdatePlants(),S.default.instance.SetFingerState(!0)},t.prototype.CheckBuff=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n;return __generator(this,function(a){return e=p.default.instance.GetCurData(f.BuffTypeEnum.PHOTOSYNTHESIS),t=h.default.instance.Now(),0!=e.drTime&&(t>=e.drTime?(e.drTime=0,p.default.instance.isUse[f.BuffTypeEnum.PHOTOSYNTHESIS]&&(p.default.instance.isUse[f.BuffTypeEnum.PHOTOSYNTHESIS]=!1,u.default.Log("Stop sunlight animation"),this.unschedule(this.RefreshSunBuff),this.sunshineAni.active=!1,this.sunSoundId>-1&&m.default.instance.stopAudioClip(this.sunSoundId),v.default.instance.sunBuff.node.parent.active=!1,o.default.instance.lastUsePropTime=t)):p.default.instance.isUse[f.BuffTypeEnum.PHOTOSYNTHESIS]||(p.default.instance.isUse[f.BuffTypeEnum.PHOTOSYNTHESIS]=!0,u.default.Log("Play sunshine animation"),this.sunshineAni.active=!0,this.schedule(this.RefreshSunBuff,.3),this.sunSoundId=m.default.instance.playAudioClip2(y.SoundClipType.autopick,!0),v.default.instance.sunBuff.node.parent.active=!0,v.default.instance.sunBuff.fillRange=1,S.default.instance.SetFingerState(!1))),0!=(n=p.default.instance.GetCurData(f.BuffTypeEnum.WATERING)).drTime&&(t>=n.drTime?(n.drTime=0,p.default.instance.isUse[f.BuffTypeEnum.WATERING]&&(p.default.instance.isUse[f.BuffTypeEnum.WATERING]=!1,this.unschedule(this.RefreshWaterBuff),this.waterAni.active=!1,u.default.Log("Stop watering animation"),v.default.instance.waterBuff.node.parent.active=!1,o.default.instance.lastUsePropTime=t)):p.default.instance.isUse[f.BuffTypeEnum.WATERING]?(this.scheduleOnce(function(){o.default.instance.PlayWaterSound()},.2),this.scheduleOnce(function(){o.default.instance.PlayWaterSound()},.3),this.scheduleOnce(function(){o.default.instance.PlayWaterSound()},.5)):(p.default.instance.isUse[f.BuffTypeEnum.WATERING]=!0,this.waterAni.active=!0,this.schedule(this.RefreshWaterBuff,.3),u.default.Log("Play watering animation"),v.default.instance.waterBuff.node.parent.active=!0,v.default.instance.waterBuff.fillRange=1,S.default.instance.SetFingerState(!1))),[2]})})},t.prototype.RefreshSunBuff=function(){var e=p.default.instance.GetCurData(f.BuffTypeEnum.PHOTOSYNTHESIS);if(e.drTime<=0)v.default.instance.sunBuff.fillRange=0;else{var t=(e.drTime-h.default.instance.Now())/1e3/e.drLong;v.default.instance.sunBuff.fillRange=t>0?t:0}},t.prototype.RefreshWaterBuff=function(){o.default.instance.PlayWaterSound();var e=p.default.instance.GetCurData(f.BuffTypeEnum.WATERING);if(e.drTime<=0)v.default.instance.waterBuff.fillRange=0;else{var t=(e.drTime-h.default.instance.Now())/1e3/e.drLong;v.default.instance.waterBuff.fillRange=t>0?t:0}},t.prototype.UpdatePlants=function(){for(var e=0;e<this.plants.length;++e)this.plants[e].node.active&&this.plants[e].Update()},t.prototype.OnUnlockTipTap=function(e){o.default.instance.UnlockNewTier()||u.default.Log("Does not meet unlock conditions")},t.prototype.AddTier=function(e){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){switch(n.label){case 0:return[4,c.default.instance.load(s.default.Tier,function(n){var a=n.getComponent(cc.Widget);a.bottom=o.default.instance.CalcBottomWidget(e),a.updateAlignment(),n.getComponent(l.default).index=e,t.shelfNode.addChild(n),t.tiers.push(n)})];case 1:return n.sent(),[2]}})})},t.prototype.AddPlant=function(e,t,n){return __awaiter(this,void 0,void 0,function(){var a=this;return __generator(this,function(o){return c.default.instance.load(s.default.Plant,function(o){var i=a.GetPlantPos(t,n),r=o.getComponent(d.default);r.Init(e,t,n,i),a.plantNode.addChild(o),a.plants.push(r)}),[2]})})},t.prototype.RemovePlant=function(e){var t=o.default.instance.Pos2RC(e),n=this.plants.filter(function(e){return e.row==t[0]&&e.column==t[1]})[0];if(n){n.node.setParent(null),this.plants.splice(this.plants.indexOf(n),1);var i=a.default.data.plants.filter(function(t){return t.pos==e})[0];i&&(i.pos=-1,o.default.instance.plants.splice(o.default.instance.plants.indexOf(i),1)),g.default.instance.ChangeStoreNum(1)}},t.prototype.GetPlantPos=function(e,t){var n=o.default.instance.plantOffset[t];return cc.v2(n.x,n.y+this.tiers[e].getComponent(cc.Widget).bottom)},t.prototype.RefreshUnlockTip=function(){var e=this.unlockTip.getComponent(cc.Widget);e.bottom=o.default.instance.CalcBottomWidget(a.default.data.unlockTier),e.updateAlignment(),a.default.data.unlockTier>=a.default.MaxTier?this.unlockTip.getChildByName("BG").active=!1:this.RefreshUnlockTipTxt()},t.prototype.UnlockTier=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.AddTier(a.default.data.unlockTier-1)];case 1:return e.sent(),this.RefreshUnlockTip(),this.ResetContentHeight(),this.ScrollToTop(),[2]}})})},t.prototype.RefreshUnlockTipTxt=function(){this.unlockTip.active&&(this.unlockTipTxt.string=o.default.instance.CheckTierCanUnlock())},t.prototype.ResetContentHeight=function(){console.log("Before unlock:"+this.content.y),o.default.instance.ResetContentHeight(),this.shelfNode.getComponent(cc.Widget).updateAlignment(),this.popNumNode.getComponent(cc.Widget).updateAlignment()},t.prototype.ShowAllArea=function(){for(var e=0;e<this.tiers.length;++e)this.tiers[e].getComponent(l.default).ShowArea()},t.prototype.HideAllArea=function(){o.default.instance.plantId=-1;for(var e=0;e<this.tiers.length;++e)this.tiers[e].getComponent(l.default).HideArea()},t.prototype.PlayStageUpAni=function(e){var t=this;this.stageUpAni.active=!0,this.stageUpAni.position=e;var n=this.stageUpAni.getComponent(cc.Animation);n.stop(),n.play(),n.on(cc.Animation.EventType.FINISHED,function(){t.stageUpAni.active=!1})},t.prototype.CheckShelfFull=function(){return this.plants.length>=4*a.default.data.unlockTier},t.prototype.ResetWidget=function(){this.content.parent.getComponent(cc.Widget).updateAlignment(),this.content.getComponent(cc.Widget).updateAlignment(),this.unlockTip.getComponent(cc.Widget).updateAlignment(),this.shelfNode.getComponent(cc.Widget).updateAlignment(),this.plantNode.getComponent(cc.Widget).updateAlignment(),this.popNumNode.getComponent(cc.Widget).updateAlignment(),this.bubbleNode.getComponent(cc.Widget).updateAlignment(),this.clickNode.getComponent(cc.Widget).updateAlignment()},__decorate([b({type:cc.ScrollView,displayName:"\u5217\u8868\u5bb9\u5668"})],t.prototype,"scrollView",void 0),__decorate([b({type:cc.Node,displayName:"\u5217\u8868\u5185\u5bb9"})],t.prototype,"content",void 0),__decorate([b({type:cc.Node,displayName:"\u89e3\u9501\u63d0\u793a\u7ed3\u70b9"})],t.prototype,"unlockTip",void 0),__decorate([b({type:cc.Label,displayName:"\u89e3\u9501\u63d0\u793a\u6587\u672c"})],t.prototype,"unlockTipTxt",void 0),__decorate([b({type:cc.Node,displayName:"\u67b6\u5b50\u7ed3\u70b9"})],t.prototype,"shelfNode",void 0),__decorate([b({type:cc.Node,displayName:"\u690d\u7269\u7ed3\u70b9"})],t.prototype,"plantNode",void 0),__decorate([b({type:cc.Node,displayName:"\u98d8\u6570\u5b57\u7684\u7ed3\u70b9"})],t.prototype,"popNumNode",void 0),__decorate([b({type:cc.Node,displayName:"\u5192\u6ce1\u7684\u7ed3\u70b9"})],t.prototype,"bubbleNode",void 0),__decorate([b({type:cc.Node,displayName:"\u70b9\u51fb\u52a8\u753b\u7ed3\u70b9"})],t.prototype,"clickNode",void 0),__decorate([b({type:cc.Node,displayName:"\u9633\u5149\u52a8\u753b"})],t.prototype,"sunshineAni",void 0),__decorate([b({type:cc.Node,displayName:"\u6d47\u6c34\u52a8\u753b"})],t.prototype,"waterAni",void 0),__decorate([b({type:cc.Node,displayName:"\u65bd\u80a5\u52a8\u753b"})],t.prototype,"fertilizerAni",void 0),__decorate([b({type:cc.Node,displayName:"\u5347\u9636\u52a8\u753b"})],t.prototype,"stageUpAni",void 0),__decorate([b({type:[cc.SpriteFrame],tooltip:"\u8d27\u5e01\u56fe\u6807"})],t.prototype,"ecoIcons",void 0),__decorate([b({type:cc.Node,displayName:"\u624b\u6307"})],t.prototype,"finger",void 0),__decorate([b({type:cc.Node,displayName:"\u5706\u5708"})],t.prototype,"circle",void 0),t=n=__decorate([D],t)}(cc.Component);n.default=B,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Common/EventID":"EventID","../../Common/PrefabID":"PrefabID","../../Core/GameHelper":"GameHelper","../../Core/ResourcesManager":"ResourcesManager","../../Data/BuffData":"BuffData","../../Data/GardenData":"GardenData","../../Logic/BuffLogic":"BuffLogic","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../../Logic/PlantLogic":"PlantLogic","../../Logic/TeachLogic":"TeachLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../Teach/TeachView":"TeachView","../ToolBar/BottomToolBar":"BottomToolBar","../ToolBar/TopToolBar":"TopToolBar","../UIManager":"UIManager","./Plant":"Plant","./Tier":"Tier"}],InsideAds2:[function(e,t,n){"use strict";cc._RF.push(t,"59d24cuyvZB/7uah6K2qVsO","InsideAds2");var a=e("../Core/Server"),o=e("sdk"),i=e("JNodePool");window.INSIDEADS_SHOW="insideAds_show",window.INSIDEADS_HIDE="insideAds_hide";var r=o.game_id+"insideAdsShowList",c=cc.Class({extends:cc.Component,properties:{mask:cc.Node,pnl:cc.Node,btn:cc.Node,arrow:cc.Node,layer:cc.Node,content:cc.Node,iconPrefab:cc.Prefab,popDuration:.3,_showList:[]},onLoad:function(){var e=this,t=this.node;o.ADS2=t,this.pool=new i(this.iconPrefab,5),this.node.zIndex=9999,this.pnl.active=!1,this.mask.active=!1,this.mask.opacity=0,this._list=[],this._status="hide",this.layer.active=!1;var n=cc.sys.localStorage.getItem(r);this._localList=n?JSON.parse(n):[],this._checkStatus(),this.btn.on("touchend",function(){"hide"==e._status?e._showMore():e._hideMore()},this),this.mask.on("touchstart",function(){e._hideMore()})},start:function(){var e=this;this._onDataChanged(),o.insideAds.onChanged=function(){e._onDataChanged()}},onDestroy:function(){cc.game.removePersistRootNode(this.node),o.ADS2=null,o.insideAds.onChanged=null},_onDataChanged:function(){o.insideAds.hasAds()||"undefined"==typeof wx?(this._list=o.insideAds.list,this.pnl.active=!0,this._updateContent()):(this._list=[],this.pnl.active=!1),this._checkRedShow()},_updateContent:function(){var e=this;Array.isArray(this._list)&&this._list.length>0&&(this.checkShowListDiff()&&(this._clearContent(),this._list.forEach(function(t,n){e.content.addChild(e._createIcon(t,n))}),this._showList=this._list.slice()))},checkShowListDiff:function(){if(this._list.length===this._showList.length){for(var e=0;e<this._list.length;++e){var t=this._list[e],n=this._showList[e];if(!(t.app_id.toString()+t.app_path.toString()===n.app_id.toString()+n.app_path.toString()))return!0}return!1}return!0},_clearContent:function(){for(var e=this.content.children,t=e.length-1;t>=0;--t){var n=e[t];this.pool.put(n)}},_createIcon:function(e,t){var n=this,i=this.pool.get(),c=i.getChildByName("icon").getComponent(cc.Sprite),s=i.getChildByName("label").getComponent(cc.Label),l=i.getChildByName("red");c.active=!1,i.runAction(cc.sequence(cc.delayTime(.1*t),cc.callFunc(function(t){n._loadAni(c,e.icon,c.node.width,c.node.height)}))),s.string=e.name.substr(0,5),i.targetOff(this),i.on("touchend",function(){var t=function(t){if(e.app_id&&void 0!==e.app_path){var o=e.app_id.toString()+e.app_path.toString();n._localList.indexOf(o)<0&&(n._localList.push(o),l.active=!1,cc.sys.localStorage.setItem(r,JSON.stringify(n._localList)),n._checkRedShow())}a.Server.reportEvent(e.id,t)};1===e.qrcode_flag?o.showImage(e.qrcode_url,function(){t("get_list_scan")}):o.showInsideAds(e,function(){t("get_list")})},this);var d=e.app_id.toString()+e.app_path.toString();return l.active=this._localList.indexOf(d)<0,i},_loadImage:function(e,t,n,a){if(window.wx){var o=wx.createImage();o.onload=function(){var t=new cc.Texture2D;t.initWithElement(o),t.handleLoadedTexture(),e.spriteFrame=new cc.SpriteFrame(t),e.node.width=n,e.node.height=a},o.src=t}},_loadAni:function(e,t,n,a){this.loadJsonAni(e,t).then(function(e){e.active=!0}).catch(function(e){})},_showMore:function(){var e=this;if("hide"===this._status){cc.systemEvent.emit(INSIDEADS_SHOW,this),this._status="none",this._checkStatus(),this.layer.active=!0;var t=this.pnl.x,n=-cc.winSize.width/2+540,a=this.popDuration;this._runAnimation(this.pnl,t,n,a,cc.easeSineOut(),function(){e._status="show"}),this.arrow.stopAllActions(),this.arrow.runAction(cc.rotateTo(a,180)),this.mask.active=!0,this.mask.runAction(cc.fadeTo(a,150))}},_hideMore:function(){var e=this;if("show"===this._status){cc.systemEvent.emit(INSIDEADS_HIDE,this),this._status="none";var t=this.pnl.x,n=-cc.winSize.width/2,a=this.popDuration;this._runAnimation(this.pnl,t,n,a,cc.easeSineIn(),function(){e.layer.active=!1,e._status="hide",e._checkStatus()}),this.arrow.stopAllActions(),this.arrow.runAction(cc.rotateTo(a,0)),this.mask.runAction(cc.sequence(cc.fadeTo(a,0),cc.callFunc(function(t){t.active=!1,e.layer.active=!1})))}},_runAnimation:function(e,t,n,a,o,i){e.stopAllActions(),e.x=t;var r=cc.moveTo(a,n,e.y);o&&r.easing(o),e.runAction(cc.sequence(r,cc.callFunc(function(){i&&i()})))},_checkStatus:function(){"hide"===this._status?(this.btn.stopAllActions(),this.btn.runAction(cc.sequence(cc.scaleTo(1,1.15),cc.scaleTo(1,1)).repeatForever()),this.btn.getChildByName("red1").active=this._checkAppIdListDifference()):(this.btn.stopAllActions(),this.btn.getChildByName("red1").active=!1)},_checkRedShow:function(){this.btn.getChildByName("red1").active=this._checkAppIdListDifference()&&"hide"===this._status},_checkAppIdListDifference:function(){var e=!0,t=!1,n=void 0;try{for(var a,o=this._list[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var i=a.value;if(this._localList.indexOf(i.app_id.toString()+i.app_path.toString())<0)return!0}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}return!1},loadJsonAni:function(e,t){var n=this.getUrlWithoutAsp(t),a=n+".json";return new Promise(function(e,t){cc.loader.load(a,function(n,a){return n?t():a?e(a):t()})}).then(function(t){return new Promise(function(e,a){var o=n+".png";cc.loader.load(o,function(n,o){return n?a():o?e({json:t,png:o}):a()})}).then(function(t){var n=t.json,a=t.png,o=n.mc.gif.frames.map(function(e){var t=n.res[e.res];return new cc.SpriteFrame(a,cc.rect(t.x,t.y,t.w,t.h),!1,cc.v2(e.x,e.y),cc.size(t.w,t.h))}),i=void 0;i=e.getComponent(cc.Animation)?e.getComponent(cc.Animation):e.addComponent(cc.Animation),e.getComponent(cc.Sprite)||e.addComponent(cc.Sprite);var r=n.mc.gif.frameRate,c=cc.AnimationClip.createWithSpriteFrames(o,r);return c.name="ani_frame",c.wrapMode=cc.WrapMode.Loop,i.addClip(c),i.play("ani_frame"),e})},function(){return new Promise(function(e,n){cc.loader.load(t,function(a,o){return a?(console.log("pngErr1:",a),void cc.loader.load({url:t,type:"png"},function(t,a){return t?(console.log("pngErr2:",t),n()):a?e(a):n()})):o?e(o):n()})}).then(function(t){var n=e.getComponent(cc.Sprite);return n||(n=e.addComponent(cc.Sprite)),n.spriteFrame=new cc.SpriteFrame(t),e},function(){})})},getUrlWithoutAsp:function(e){var t=e.lastIndexOf(".");return t>=0?e.substring(0,t):e}});window.InsideAds2=t.exports=c,o.ADS2=null,o.setADS2=function(e){o.ADS2=e},o.createADS2=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cc.director.getScene();arguments[2],arguments[3];if(o.ADS2);else{var n=cc.instantiate(e);n.parent=t,o.ADS2=n}},o.showADS2=function(e,t){cc.log("show"),o.ADS2&&cc.isValid(o.ADS2)?(o.ADS2.active=!0,e&&e()):(console.log("ads2does not exist"),o.ADS2=null,t&&t())},o.hideADS2=function(e,t){cc.log("hide"),o.ADS2&&cc.isValid(o.ADS2)?(o.ADS2.active=!1,e&&e()):(console.log("ads2does not exist"),o.ADS2=null,t&&t())},o.destroyADS2=function(e,t){o.ADS2?(o.ADS2.destroy(),e&&e()):(console.log("ads2does not exist"),t&&t()),o.ADS2=null},cc._RF.pop()},{"../Core/Server":"Server",JNodePool:"JNodePool",sdk:"sdk"}],JNodePool:[function(e,t,n){"use strict";cc._RF.push(t,"5737cUrOatAn7FxRg7M1FC8","JNodePool"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var o=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.mPrefab=t,this.mNodePool=new cc.NodePool;for(var a=0;a<n;++a){var o=cc.instantiate(this.mPrefab);this.mNodePool.put(o)}}return a(e,[{key:"size",value:function(){return this.mNodePool.size()}},{key:"get",value:function(){return 0<this.mNodePool.size()?this.mNodePool.get():cc.instantiate(this.mPrefab)}},{key:"put",value:function(e){this.mNodePool.put(e)}}]),e}();n.default=o,t.exports=n.default,cc._RF.pop()},{}],Loading:[function(e,t,n){"use strict";cc._RF.push(t,"fb7f7H2aohJUrI9KEFwBbM7","Loading"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Common/DataManager"),o=e("./Core/GameHelper"),i=e("./Core/ReportLogic"),r=e("./Core/UserInfoBtn"),c=e("./Core/Server"),s=e("./Common/ReportEventID"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.progressBar=null,t.progressTxt=null,t}return __extends(t,e),t.prototype.onLoad=function(){SDK.pullOtherConfig({inside:!0,wall:!0,share:!0}),SDK.pullMainConfig(function(e){o.default.Log("Pull configuration successfully:",e),i.default.instance.checkNeedAuthList()},function(e){o.default.Log("Failed to pull configuration:",e),i.default.instance.checkNeedAuthList()})},t.prototype.start=function(){i.default.instance.reportAppid(0),this.loadMainScene()},t.prototype.loadMainScene=function(){var e=this;c.default.reportEvent(s.default.game_enter,s.default.def_page),cc.director.preloadScene("Main",function(t,n,a){e.progressBar.progress=t/n,e.progressTxt.string="loading..."+(t/n*100).toFixed(2)+"%"},function(t){e.schedule(e.CheckAuth,.5)})},t.prototype.CheckAuth=function(e){i.default.instance.needAuth>-1&&(this.unschedule(this.CheckAuth),o.default.Log("Pulled"+i.default.instance.needAuth),this.LoadData())},t.prototype.LoadData=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return[4,a.default.instance.LoadConfigDatas(function(){o.default.Log("Loading completed")})];case 1:return t.sent(),[4,a.default.instance.init().then(function(){o.default.Log("Initial loading completed")})];case 2:return t.sent(),"undefined"==typeof wx||1!=i.default.instance.needAuth?(cc.director.loadScene("Main"),[2]):(wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?(o.default.Log("Authorized\uff0cGo directly to the game"),i.default.instance.reportAppid(1),cc.director.loadScene("Main")):e.createUserInfoBtn()},fail:function(){e.createUserInfoBtn()},complete:null}),[2])}})})},t.prototype.createUserInfoBtn=function(){this.progressBar.node.active=!1,this.progressTxt.string="Click anywhere to enter the game",this.progressTxt.getComponent(cc.Animation).play();var e=new r.default;e.createWxBtn(this.node,function(){o.default.Log("Authorized and successfully obtained user information"),i.default.instance.reportAppid(1),cc.director.loadScene("Main"),e.hideWxBtn()},function(){cc.director.loadScene("Main"),e.hideWxBtn()})},__decorate([u({type:cc.ProgressBar,displayName:"\u8fdb\u5ea6\u6761"})],t.prototype,"progressBar",void 0),__decorate([u({type:cc.Label,displayName:"\u8fdb\u5ea6\u6587\u672c"})],t.prototype,"progressTxt",void 0),t=__decorate([d],t)}(cc.Component);n.default=p,cc._RF.pop()},{"./Common/DataManager":"DataManager","./Common/ReportEventID":"ReportEventID","./Core/GameHelper":"GameHelper","./Core/ReportLogic":"ReportLogic","./Core/Server":"Server","./Core/UserInfoBtn":"UserInfoBtn"}],Main:[function(e,t,n){"use strict";cc._RF.push(t,"69c2ahz1MBChLwdK3RwDNMN","Main"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Core/GameHelper"),o=e("./Core/ShareLogic"),i=e("./Common/DataManager"),r=e("./Common/EventID"),c=e("./Logic/GardenLogic"),s=e("./Core/Server"),l=e("./Common/ReportEventID"),d=e("./Logic/CollectLogic"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n._instance=this,cc.game.setFrameRate(60),a.default.Log("current version1"),o.default.instance.Share(o.ShareTypeEnum.SYSTEM)},t.prototype.start=function(){s.default.reportEvent(l.default.game_loaded,l.default.def_page),SDK.onShow("main",function(e){if(e.query.position_id&&(a.default.Log("\u7edf\u8ba1\u5206\u4eab\u70b9:\u5206\u4eab\u4f4d "+e.query.position_id+" \u5206\u4eabid "+e.query.share_id),SDK.shareStat(e.query.position_id,e.query.share_id)),c.default.instance.CalcIncome(),void 0===window.qq){var t=e.scene;1023===t||1104===t?(a.default.Log("Enter from desktop or applet"),d.default.instance.collectState!=d.CollectStateEnum.GET&&(d.default.instance.collectState=d.CollectStateEnum.COLLECTED),-1==i.default.instance.beginerStage&&d.default.instance.GetCollectReward()):d.default.instance.collectState!=d.CollectStateEnum.GET&&(d.default.instance.collectState=d.CollectStateEnum.NO)}},0,!0),a.default.IsWX&&(wx.onHide(function(){i.default.instance.SaveDataToServer(),i.default.instance.SaveLocalData(),i.default.instance.leaveTime=-1,i.default.instance.GetNow(!0).then(function(e){-1!=e&&(i.default.instance.leaveTime=Math.floor(e/1e3))})}),i.default.instance.ScheduleSaveData()),a.default.InitBannerHeight(),PlatformMgr.showBanner()},t.prototype.LoadData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return SDK.showLoading("Loading resources",!0),i.default.instance.init().then(function(){a.default.Log("Initial loading completed")}),[4,i.default.instance.LoadConfigDatas(function(){a.default.Log("Loading completed"),SDK.hideLoading()})];case 1:return e.sent(),[2]}})})},t=n=__decorate([cc._decorator.ccclass],t)}(cc.Component);if(n.default=u,a.default.IsWX){var p=void 0,f=void 0,h=void 0,g=void 0;a.default.IsQQ?(p="farmQQ02",f=1,h="",g=""):(p="farm02",f=7,h="adunit-458b9311a82d45ba",g="adunit-a0fc4b4e6d76a04f"),SDK.init({game_id:p,game_version:f,videoId:h,bannerId:g,autoPullAllConfig:!1,printLog:!0,onBannerResize:function(e,t,n,a,o,i){return setTimeout(function(){cc.systemEvent.emit(r.default.banner_changed)},50),{top:t-a,left:i}}})}cc._RF.pop()},{"./Common/DataManager":"DataManager","./Common/EventID":"EventID","./Common/ReportEventID":"ReportEventID","./Core/GameHelper":"GameHelper","./Core/Server":"Server","./Core/ShareLogic":"ShareLogic","./Logic/CollectLogic":"CollectLogic","./Logic/GardenLogic":"GardenLogic"}],MathUtil:[function(e,t,n){"use strict";cc._RF.push(t,"f4181OJEglM8rWwL6kl7z7j","MathUtil"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(){}return e.RandomInt=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},e.Random=function(e,t){return Math.random()*(t-e)+e},e.RandomArr=function(e,t){if(void 0===t&&(t=!1),t){var n=this.RandomInt(0,e.length-1);return e.splice(n,1)[0]}if(e.length>0)return e[this.RandomInt(0,e.length-1)]},e.GetIntervalDays=function(e,t){var n=new Date(e).toDateString(),a=new Date(t).toDateString(),o=new Date(n).getTime(),i=new Date(a).getTime();return Math.floor((o-i)/864e5)},e.Fixed2=function(e){return e<10?"0"+e:e.toString()},e}();n.default=a,cc._RF.pop()},{}],MiddleToolBar:[function(e,t,n){"use strict";cc._RF.push(t,"4a555euLIlI9pcfaIa8Jiv6","MiddleToolBar"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Logic/CollectLogic"),o=e("../../Sound/SoundManager"),i=e("../../Sound/SoundClip"),r=e("../UIManager"),c=e("../../Common/DataManager"),s=e("../../Logic/TeachLogic"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.collectBtn=null,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n._instance=this},t.prototype.start=function(){this.AddEvents(),this.CheckCollectBtn()},t.prototype.AddEvents=function(){this.collectBtn.node.on(cc.Node.EventType.TOUCH_END,this.OnCollectBtnTap,this)},t.prototype.OnCollectBtnTap=function(e){o.default.instance.playAudioClip(i.SoundClipType.click),r.default.instance.OpenView(r.ViewName.CollectView)},t.prototype.CheckCollectBtn=function(){void 0===window.qq&&c.default.instance.beginerStage==s.TeachStageEnum.OVER&&a.default.instance.collectState!=a.CollectStateEnum.GET&&(this.collectBtn.node.active?this.collectBtn.node.active=!1:a.default.instance.appear())},__decorate([u({type:cc.Sprite,displayName:"\u6536\u85cf\u6309\u94ae"})],t.prototype,"collectBtn",void 0),t=n=__decorate([d],t)}(cc.Component);n.default=p,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Logic/CollectLogic":"CollectLogic","../../Logic/TeachLogic":"TeachLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../UIManager":"UIManager"}],MyToast:[function(e,t,n){"use strict";cc._RF.push(t,"11cceZknINI6aTzDGN2bBdX","MyToast"),Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,o=a.ccclass,i=a.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lb=null,t}return __extends(t,e),t.prototype.showToast=function(e,t,n,a,o,i){t&&t!=1/0||(t=0),t=Math.max(t,1),console.log("showToast msg:"+e+" duration:"+t),this.lb.string=e,this.node.stopAllActions();var r=cc.view.getVisibleSize();this.node.setPosition(.5*r.width,.5*r.height),this.node.runAction(cc.sequence(cc.scaleTo(0,.5),cc.scaleTo(.2,1),cc.delayTime(t),cc.spawn(cc.moveBy(.4,cc.v2(0,200)),cc.fadeOut(.4)),cc.removeSelf(!0)))},__decorate([i({type:cc.Label,displayName:"\u663e\u793a\u7684\u6587\u672c"})],t.prototype,"lb",void 0),t=__decorate([o],t)}(cc.Component);n.default=r,cc._RF.pop()},{}],OpenData:[function(e,t,n){"use strict";var a;cc._RF.push(t,"b0e91ayBdROg7eEtH3rg0at","OpenData"),Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.Success=0]="Success",e[e.Fail=-1]="Fail",e[e.Pending=1]="Pending",e[e.Capacity=2]="Capacity"}(a||(a={}));var o=64,i=function(){function e(){if(this._resolve=null,this._reject=null,this._timer=0,this._timeout=6,this._refreshDuration=.2,this._pixelReader=null,"undefined"!=typeof wx){var e=wx.getOpenDataContext().canvas;e.width=o,e.height=o,this._pixelReader=new r}}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.getUserCloudStorage=function(e){return this._postCommand("getUserCloudStorage",{keyList:e})},e.prototype.getFriendCloudStorage=function(e){return this._postCommand("getFriendCloudStorage",{keyList:e})},e.prototype.getUserInfo=function(e,t){return void 0===e&&(e=["selfOpenId"]),void 0===t&&(t="zh_CN"),this._postCommand("getUserInfo",{openIdList:e,lang:t})},e.prototype.getGroupCloudStorage=function(e,t){return this._postCommand("getGroupCloudStorage",{shareTicket:e,keyList:t})},e.prototype._postCommand=function(e,t){var n=this,a={command:e,param:t};return this._postMessage(a),new Promise(function(e,t){n._addFunc(a,e,t)})},e.prototype._postMessage=function(e){"undefined"!=typeof wx&&wx.getOpenDataContext().postMessage(e)},e.prototype._addFunc=function(e,t,n){var i=this;this._reject&&this._reject(),this._clear(),this._resolve=t,this._reject=n;var r=(new Date).getTime();this._timer=setInterval(function(){var t=i._getContent();if(t){if(t.code==a.Success||t.code==a.Fail)return t.code==a.Success?i._resolve&&i._resolve(t.data):i._reject&&i._reject(t.data),void i._clear();if(t.code==a.Capacity){var n=t.data||o,c=wx.getOpenDataContext().canvas;c.width=n,c.height=n,"undefined"!=typeof wx&&(e.useCache=!0,i._postMessage(e))}}((new Date).getTime()-r)/1e3>=i._timeout&&(i._reject&&i._reject(),i._clear())},1e3*this._refreshDuration)},e.prototype._clear=function(){this._resolve=this._reject=null,clearInterval(this._timer),this._timer=0},e.prototype._getContent=function(){var e=null,t=this._canvasToText();try{e=JSON.parse(t)}catch(t){e=null}return e},e.prototype._canvasToText=function(){var e="";if("undefined"!=typeof wx){var t=this._pixelReader.getPixels();if(!t)return e;for(var n=[],a=function(e){return e%4==3?e+1:e},o=0,i=t.length;o<i;++o){var r=((t[o=a(o)]||0)<<8)+(t[o=a(o+1)]||0);if(0==r)break;n.push(r)}e=String.fromCharCode.apply(String,n),console.log("OpenDatagetting information: ",e)}return e},e}();n.OpenData=i;var r=function(){function e(){this._open_canvas=null,this._canvas=null,this._gl=null,this._cache_texture=null,this._fbo=null;var e=wx.getOpenDataContext();this._open_canvas=e.canvas,this._canvas=window.canvas,this._gl=this._canvas.getContext("webgl")}return e.prototype.getPixels=function(){var e=this._gl,t=this._open_canvas.width,n=this._open_canvas.height,a=this._getCacheTexture(e,t,n),o=this._getFrameBuffer(e);if(e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE)return e.bindFramebuffer(e.FRAMEBUFFER,null),null;var i=new Uint8Array(t*n*4);return e.readPixels(0,0,t,n,e.RGBA,e.UNSIGNED_BYTE,i),e.bindFramebuffer(e.FRAMEBUFFER,null),i},e.prototype._getFrameBuffer=function(e){return this._fbo||(this._fbo=e.createFramebuffer()),this._fbo},e.prototype._getCacheTexture=function(e,t,n){return this._cache_texture||(this._cache_texture=e.createTexture()),this._texParameteri(e,this._cache_texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._open_canvas),this._cache_texture},e.prototype._texParameteri=function(e,t){e.activeTexture(e.TEXTURE6),e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)},e}();cc._RF.pop()},{}],Oxy:[function(e,t,n){"use strict";cc._RF.push(t,"35c2eTpjftIfJrTSXgDfbF9","Oxy"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Core/ResourcesPool"),o=cc._decorator,i=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.farmAreaId=0,t.produce=0,t.cdTimer=1,t.model=null,t}return __extends(t,e),t.prototype.init=function(){},t.prototype.getKey=function(){return"Coin"},t.prototype.awake=function(){this.node.position=cc.Vec2.ZERO,this.node.active=!0},t.prototype.sleep=function(){this.node.stopAllActions(),this.node.setParent(null),this.node.active=!1},t.prototype.destroySelf=function(){a.default.instance.put(this,50)},t=__decorate([i],t)}(cc.Component));n.default=r,cc._RF.pop()},{"../../Core/ResourcesPool":"ResourcesPool"}],PlantConfig:[function(e,t,n){"use strict";cc._RF.push(t,"0a61dhko71Kw6vtseQbO2te","PlantConfig"),Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.UP=1]="UP",e[e.DOWN=2]="DOWN"}(n.UpDownEnum||(n.UpDownEnum={}));var a=function(){return function(){this.id=0,this.name="",this.dr=0,this.pd=0,this.apd=0,this.coin=0,this.acoin=0,this.bt=0,this.ul=0,this.res="",this.ho="0,0,0,0,0"}}();n.default=a,cc._RF.pop()},{}],PlantData:[function(e,t,n){"use strict";cc._RF.push(t,"eb1bbGn9qdKC5rYQqPxzFLs","PlantData"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(){this.id=0,this.level=1,this.seed=1,this.pos=-1,this.product=0,this.buildTime=-1,this.nextOxy=0,this.potColor=0,this.stage=1}return e.MaxLv=50,e}();n.default=a,cc._RF.pop()},{}],PlantItem:[function(e,t,n){"use strict";cc._RF.push(t,"f822aGmBLtAq6NbdlwhNOTv","PlantItem"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../../Common/DataManager"),i=e("../../Logic/EconomicLogic"),r=e("../../Data/PlantData"),c=e("../../Data/GardenData"),s=e("../../Core/GameHelper"),l=e("../../Logic/GardenLogic"),d=e("../../Logic/PlantLogic"),u=e("../../Sound/SoundManager"),p=e("../../Sound/SoundClip"),f=e("../ToolBar/BottomToolBar"),h=e("../../Core/ResourcesManager"),g=e("../Garden/Garden"),m=e("../UIManager"),y=e("../../Logic/TeachLogic"),v=e("../Reward/RewardView"),_=e("../../Core/RewardLogic"),S=e("../../Core/ShareLogic"),w=e("../../Core/Server"),C=e("../../Common/ReportEventID");(function(e){e[e.UNINIT=0]="UNINIT",e[e.LOCK=1]="LOCK",e[e.BUY=2]="BUY",e[e.PLANT=3]="PLANT",e[e.UPGRADE=4]="UPGRADE"})(a=n.PlantItemStatusEnum||(n.PlantItemStatusEnum={}));var T=cc._decorator,D=T.ccclass,b=T.property,B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.purchaseBtn=null,t.upgradeBtn=null,t.upgradePrice=null,t.upgradeDecBtn=null,t.plantBtn=null,t.iconBg=null,t.levelProgress=null,t.plantName=null,t.plantLv=null,t.plantProduct=null,t.plantSeed=null,t.icon=null,t.PlantSpriteFrame=null,t.index=-1,t.state=a.UNINIT,t.curPlantCnf=null,t.curPlantData=null,t.nextDecOxy=0,t.needCheck=!1,t}return __extends(t,e),t.prototype.start=function(){this.AddEvents()},t.prototype.onEnable=function(){var e=this;if(this.needCheck){this.needCheck=!1;var t=c.default.data.plants.filter(function(t){return t.id==e.curPlantCnf.id});t.length>0&&(this.curPlantData=t[t.length-1],this.curPlantData.level<r.default.MaxLv&&(this.SwitchToState(a.UPGRADE),this.RefreshLevel()))}},t.prototype.AddEvents=function(){this.purchaseBtn.on(cc.Node.EventType.TOUCH_END,this.OnPurchaseBtnTap,this),this.upgradeBtn.on(cc.Node.EventType.TOUCH_END,this.OnUpgradeBtnTap,this),this.upgradeDecBtn.on(cc.Node.EventType.TOUCH_END,this.OnUpgradeDecBtnTap,this)},t.prototype.Init=function(e){var t=this;this.index=e,this.curPlantCnf=o.default.instance.PlantCnf[e],this.curPlantCnf.name&&(this.plantName.string=this.curPlantCnf.name);var n=c.default.data.plants.filter(function(e){return e.id==t.curPlantCnf.id});n.length>0?(this.curPlantData=n[n.length-1],this.curPlantData.level>=r.default.MaxLv?this.SwitchToState(a.PLANT):this.SwitchToState(a.UPGRADE),this.RefreshIcon()):c.default.data.level>=this.curPlantCnf.ul?this.SwitchToState(a.BUY):this.SwitchToState(a.LOCK),this.RefreshLevel()},t.prototype.SwitchToState=function(e){if(this.state!=e){switch(e){case a.LOCK:this.iconBg.setState(cc.Sprite.State.GRAY),this.plantBtn.active=!0,this.plantBtn.getChildByName("Label").getComponent(cc.Label).string="lv"+this.curPlantCnf.ul;break;case a.BUY:this.RefreshIcon(),this.iconBg.setState(cc.Sprite.State.NORMAL),this.plantBtn.active=!1,this.plantName.node.active=!1,this.purchaseBtn.active=!0,this.levelProgress.node.active=!1,this.purchaseBtn.getChildByName("Price").getComponent(cc.Label).string=i.default.instance.number2UnitFormat(this.curPlantCnf.coin);break;case a.UPGRADE:this.plantName.node.active=!0,this.purchaseBtn.active=!1,this.upgradeBtn.active=!0,this.plantBtn.active=!1,this.levelProgress.node.active=!0,this.RefreshLevel(e);break;case a.PLANT:this.plantName.node.active=!0,this.upgradeBtn.active=!1,this.plantBtn.active=!0,this.plantBtn.getComponent(cc.Sprite).spriteFrame=this.PlantSpriteFrame,this.plantBtn.getChildByName("Label").getComponent(cc.Label).string="Plant another plant",this.plantBtn.getChildByName("Tip").active=!1,this.plantBtn.getComponent(cc.Button).interactable=!0,this.levelProgress.node.active=!1,this.RefreshLevel(e)}this.state=e}},t.prototype.OnPurchaseBtnTap=function(e){var t=this;if(u.default.instance.playAudioClip(p.SoundClipType.click),!g.default.instance.CheckShelfFull())return this.state!=a.BUY?(s.default.Log("grow"),void m.default.instance.OpenView(m.ViewName.ConfirmView,function(e){e.Init({desc:t.curPlantCnf.name+"Full class\uff0cWhether to plant another plant\uff1f",iconPath:t.curPlantCnf.res.toString(),iconRoot:d.default.instance.IconRoot,callback:function(){t.needCheck=!0,l.default.instance.ToBuyMode(t.curPlantCnf.id),f.default.instance.ShrinkPage()}})})):void(-1!=i.default.instance.oxy.comparedTo(this.curPlantCnf.coin)?(s.default.Log("buy"),this.needCheck=!0,l.default.instance.ToBuyMode(this.curPlantCnf.id),f.default.instance.ShrinkPage()):PlatformMgr.showToast("Insufficient oxygen"));m.default.instance.OpenView(m.ViewName.ConfirmView,function(e){e.Init({desc:"Shelf is full\uff0cNeed to be sorted immediately",confirmStr:"sort out",callback:function(){l.default.instance.ToPlaceMode(),f.default.instance.ShrinkPage(!0)}})})},t.prototype.Upgrade=function(e){var t=this;if(void 0===e&&(e=1),f.default.instance.RefreshPlantRedDot(),this.curPlantData.level+=e,this.curPlantData.nextOxy=d.default.instance.CalcCostOxy(this.curPlantCnf,(this.curPlantData.seed-1)*r.default.MaxLv+this.curPlantData.level),this.curPlantData.product=d.default.instance.CalcProduct(this.curPlantCnf,this.curPlantData.level+1),this.curPlantData.level<r.default.MaxLv&&Math.floor(this.curPlantData.level/10)+1>this.curPlantData.stage){this.curPlantData.stage=Math.floor(this.curPlantData.level/10)+1;var n=g.default.instance.plants.filter(function(e){return e.data.id==t.curPlantCnf.id&&e.data.level<r.default.MaxLv})[0];n&&(n.StageUp(),g.default.instance.PlayStageUpAni(n.vec))}if(this.curPlantData.level>=r.default.MaxLv){this.SwitchToState(a.PLANT);var o=new v.RewardData;o.rewardMethod=_.default.instance.ShareOrVideo(S.ShareTypeEnum.PLANTMAXLV),o.shareType=S.ShareTypeEnum.PLANTMAXLV,o.rewardTypes=[v.RewardTypeEnum.DIAMOND],o.rewardVals=[this.curPlantCnf.dr],o.ratio=2,o.title=this.curPlantCnf.name+"Full class",o.desc3="obtain:",o.callback=function(e){e>1&&(w.default.reportEvent(C.default.plant_maxlv_motive,C.default.def_page),o.rewardMethod==_.RewardMethodEnum.SHARE?w.default.reportEvent(C.default.plant_maxlv_share,C.default.def_page):o.rewardMethod==_.RewardMethodEnum.VIDEO&&w.default.reportEvent(C.default.plant_maxlv_video,C.default.def_page))},m.default.instance.rewardDatas.push(o)}this.RefreshLevel(),d.default.instance.LocatePlantItem(this.curPlantData.pos),y.default.instance.isPropComp&&(y.default.instance.isPropComp=!1,w.default.reportEvent(C.default.bs_prop_upgradeplant,C.default.def_page))},t.prototype.OnUpgradeBtnTap=function(e){this.curPlantData.level>=r.default.MaxLv||(u.default.instance.playAudioClip(p.SoundClipType.click),-1!=i.default.instance.oxy.comparedTo(this.curPlantData.nextOxy)?(s.default.Log("Upgrade one level"),i.default.instance.SubOxy(this.curPlantData.nextOxy),this.Upgrade()):PlatformMgr.showToast("Insufficient oxygen"))},t.prototype.OnUpgradeDecBtnTap=function(e){if(u.default.instance.playAudioClip(p.SoundClipType.click),0!=this.nextDecOxy&&-1!=i.default.instance.oxy.comparedTo(this.nextDecOxy)){s.default.Log("Rise ten"),i.default.instance.SubOxy(this.nextDecOxy);var t=r.default.MaxLv-this.curPlantData.level;t>10&&(t=10),this.Upgrade(t)}},t.prototype.RefreshLevel=function(e){switch(void 0===e&&(e=this.state),e){case a.BUY:break;case a.PLANT:this.plantLv.string="lv:"+this.curPlantData.level.toString(),this.plantProduct.string="Yield:"+(this.curPlantData.product*d.default.instance.GetProductRatio()).toString()+"/second",this.curPlantData.seed>1&&(this.plantSeed.node.active=!0,this.plantSeed.string="Current planting:First"+this.curPlantData.seed+"Strain"),this.HideDecUpgrade();break;case a.UPGRADE:var t=r.default.MaxLv-this.curPlantData.level;t<5||0==this.nextDecOxy||-1==i.default.instance.oxy.comparedTo(this.nextDecOxy)?this.HideDecUpgrade():t>=10?(this.ShowDecUpgrade(),this.upgradeDecBtn.getChildByName("Txt").getComponent(cc.Label).string="lv+10",this.upgradeDecBtn.getChildByName("Price").getComponent(cc.Label).string=""):(this.ShowDecUpgrade(),this.upgradeDecBtn.getChildByName("Txt").getComponent(cc.Label).string="lv+"+t,this.upgradeDecBtn.getChildByName("Price").getComponent(cc.Label).string=""),this.plantLv.string="lv:"+this.curPlantData.level.toString(),this.plantProduct.string="Yield:"+(this.curPlantData.product*d.default.instance.GetProductRatio()).toString()+"/second",this.upgradePrice.string=i.default.instance.number2UnitFormat(this.curPlantData.nextOxy),this.curPlantData.seed>1&&(this.plantSeed.node.active=!0,this.plantSeed.string="Current planting:First"+this.curPlantData.seed+"Strain"),this.levelProgress.progress=this.curPlantData.level%10/10}},t.prototype.RefreshOxy=function(){switch(this.state){case a.PLANT:this.plantProduct.string="Yield:"+(this.curPlantData.product*d.default.instance.GetProductRatio()).toString()+"/second";break;case a.UPGRADE:this.upgradeBtn.active&&(-1==i.default.instance.oxy.comparedTo(this.curPlantData.nextOxy)?this.upgradeBtn.getComponent(cc.Button).interactable&&(this.upgradeBtn.getComponent(cc.Button).interactable=!1,this.upgradeBtn.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.GRAY)):this.upgradeBtn.getComponent(cc.Button).interactable||(this.upgradeBtn.getComponent(cc.Button).interactable=!0,this.upgradeBtn.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL))),this.upgradeDecBtn.active,this.plantProduct.string="Yield:"+(this.curPlantData.product*d.default.instance.GetProductRatio()).toString()+"/second";break;case a.BUY:-1==i.default.instance.oxy.comparedTo(this.curPlantCnf.coin)?this.purchaseBtn.getComponent(cc.Button).interactable&&(this.purchaseBtn.getComponent(cc.Button).interactable=!1,this.purchaseBtn.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.GRAY)):this.purchaseBtn.getComponent(cc.Button).interactable||(this.purchaseBtn.getComponent(cc.Button).interactable=!0,this.purchaseBtn.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL))}},t.prototype.RefreshIcon=function(){var e=this;h.default.instance.load(this.curPlantCnf.res,function(t){e.icon.spriteFrame=t},cc.SpriteFrame,!1,!1,d.default.instance.IconRoot)},t.prototype.CheckLockState=function(){if(this.state==a.LOCK){if(!(c.default.data.level>=this.curPlantCnf.ul))return!1;this.SwitchToState(a.BUY)}return!0},t.prototype.HideDecUpgrade=function(){this.upgradeDecBtn.active&&(this.upgradeDecBtn.active=!1)},t.prototype.ShowDecUpgrade=function(){this.upgradeDecBtn.active||(this.upgradeDecBtn.active=!0)},__decorate([b({type:cc.Node,displayName:"\u8d2d\u4e70\u6309\u94ae"})],t.prototype,"purchaseBtn",void 0),__decorate([b({type:cc.Node,displayName:"\u5347\u7ea7\u6309\u94ae"})],t.prototype,"upgradeBtn",void 0),__decorate([b({type:cc.Label,displayName:"\u5347\u7ea7\u4ef7\u683c"})],t.prototype,"upgradePrice",void 0),__decorate([b({type:cc.Node,displayName:"\u5347\u5341\u6b21\u6309\u94ae"})],t.prototype,"upgradeDecBtn",void 0),__decorate([b({type:cc.Node,displayName:"\u79cd\u690d\u6309\u94ae"})],t.prototype,"plantBtn",void 0),__decorate([b({type:cc.Sprite,displayName:"\u56fe\u6807\u80cc\u666f"})],t.prototype,"iconBg",void 0),__decorate([b({type:cc.ProgressBar,displayName:"\u7b49\u7ea7\u8fdb\u5ea6\u6761"})],t.prototype,"levelProgress",void 0),__decorate([b({type:cc.Label,displayName:"\u690d\u7269\u540d\u79f0"})],t.prototype,"plantName",void 0),__decorate([b({type:cc.Label,displayName:"\u690d\u7269\u7b49\u7ea7"})],t.prototype,"plantLv",void 0),__decorate([b({type:cc.Label,displayName:"\u690d\u7269\u4ea7\u80fd"})],t.prototype,"plantProduct",void 0),__decorate([b({type:cc.Label,displayName:"\u690d\u7269\u682a\u6570"})],t.prototype,"plantSeed",void 0),__decorate([b({type:cc.Sprite,displayName:"\u56fe\u6807"})],t.prototype,"icon",void 0),__decorate([b({type:cc.SpriteFrame,displayName:"\u79cd\u690d\u6309\u94ae"})],t.prototype,"PlantSpriteFrame",void 0),t=__decorate([D],t)}(cc.Component);n.default=B,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Common/ReportEventID":"ReportEventID","../../Core/GameHelper":"GameHelper","../../Core/ResourcesManager":"ResourcesManager","../../Core/RewardLogic":"RewardLogic","../../Core/Server":"Server","../../Core/ShareLogic":"ShareLogic","../../Data/GardenData":"GardenData","../../Data/PlantData":"PlantData","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../../Logic/PlantLogic":"PlantLogic","../../Logic/TeachLogic":"TeachLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../Garden/Garden":"Garden","../Reward/RewardView":"RewardView","../ToolBar/BottomToolBar":"BottomToolBar","../UIManager":"UIManager"}],PlantLogic:[function(e,t,n){"use strict";cc._RF.push(t,"37004gI54RKNofolglQBvou","PlantLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Data/PlantData"),o=e("../Common/DataManager"),i=e("../UI/Garden/ClickCircle"),r=e("../Core/ResourcesManager"),c=e("../Core/ResourcesPool"),s=e("../UI/Garden/Bubble"),l=e("../UI/Garden/PopupText"),d=e("../Common/PrefabID"),u=e("../UI/Garden/Garden"),p=e("../Core/GameHelper"),f=e("./GardenLogic"),h=e("../UI/UIManager"),g=e("../Data/GardenData"),m=e("./ShopLogic"),y=e("../UI/ToolBar/TopToolBar"),v=function(){function e(){this.IconRoot="plants/Icon/",this.PotRoot="plants/Pot/",this.FlowerRoot="plants/Flower/",this.ShareRoot="plants/Share/",this.curLocTier=-1}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.New=function(e){var t=new a.default,n=o.default.instance.GetPlantConfig(e.id);return t.id=e.id,t.pos=e.pos,e.seed&&(t.seed=e.seed),t.nextOxy=this.CalcCostOxy(n,(t.seed-1)*a.default.MaxLv+1),t.product=Math.round(n.pd),t},e.prototype.GetProductRatio=function(){return m.default.instance.addProductTimes>0?m.default.instance.addProductTimes*m.default.instance.addProductRatio:1},e.prototype.CalcProduct=function(e,t){var n=e.pd;return t>10?(n+=9*e.apd,t>30?(n+=20*e.apd*1.2,n+=(t-30)*e.apd*1.3):n+=(t-10)*e.apd*1.2):n+=(t-1)*e.apd,Math.round(n)},e.prototype.CalcCostOxy=function(e,t){return Math.round(e.coin*Math.pow(e.acoin,t))},e.prototype.MoveTo=function(e,t){e.node.stopAllActions(),e.node.runAction(cc.moveTo(.2,t.add(e.offsetVec)))},e.prototype.ShowPopupNum=function(e,t,n,a,o,i){void 0===n&&(n=32),void 0===a&&(a=cc.Color.YELLOW),void 0===i&&(i="");var s=c.default.instance.get(d.default.PopupNum),u=function(r){r.node.setParent(o),r.node.position=e,r.showText(t,n,a),""!=i&&r.getComponent(cc.Animation).play(i)};s?u(s):r.default.instance.load(d.default.PopupNum,function(e){var t=e.getComponent(l.default);u(t)})},e.prototype.Bubbling=function(e,t){var n=c.default.instance.get(d.default.Bubble);if(n)return n.node.setParent(t),n.node.position=e,void n.ani.play();r.default.instance.load(d.default.Bubble,function(a){(n=a.getComponent(s.default)).node.setParent(t),n.node.position=e,n.ani.play()})},e.prototype.PlayClickAni=function(e,t){var n=c.default.instance.get(d.default.ClickCircle);if(n)return n.node.setParent(t),n.node.position=e,void n.ani.play();r.default.instance.load(d.default.ClickCircle,function(a){(n=a.getComponent(i.default)).node.setParent(t),n.node.position=e,n.ani.play()})},e.prototype.LocatePlantItem=function(e){if(-1!=e){var t=Math.floor(e/4);this.curLocTier!=t&&(this.curLocTier=t,this.LocatePlant())}},e.prototype.LocatePlant=function(e){if(void 0===e&&(e=null),!(this.curLocTier<0)){p.default.Log("Targeting"+this.curLocTier);var t=u.default.instance.scrollView.getComponent(cc.Widget);t.bottom=h.default.bottomPageHeight+68,t.updateAlignment(),u.default.instance.ResetWidget(),u.default.instance.content.height=f.default.instance.CalcBottomWidget(this.curLocTier+1)+y.default.instance.node.height+80,u.default.instance.ScrollToTop()}},e.prototype.RecoverScroll=function(){if(-1!=this.curLocTier){var e=this.curLocTier;this.curLocTier=-1;var t=u.default.instance.scrollView.getComponent(cc.Widget);t.bottom=h.default.bannerHeight,t.updateAlignment(),u.default.instance.ResetWidget(),f.default.instance.ResetContentHeight(),g.default.data.unlockTier==g.default.MaxTier?u.default.instance.scrollView.scrollToOffset(cc.v2(0,(g.default.data.unlockTier-e-1)*f.default.instance.tierHeight)):u.default.instance.scrollView.scrollToOffset(cc.v2(0,(g.default.data.unlockTier-e)*f.default.instance.tierHeight)),u.default.instance.OnScrolling()}},e}();n.default=v,cc._RF.pop()},{"../Common/DataManager":"DataManager","../Common/PrefabID":"PrefabID","../Core/GameHelper":"GameHelper","../Core/ResourcesManager":"ResourcesManager","../Core/ResourcesPool":"ResourcesPool","../Data/GardenData":"GardenData","../Data/PlantData":"PlantData","../UI/Garden/Bubble":"Bubble","../UI/Garden/ClickCircle":"ClickCircle","../UI/Garden/Garden":"Garden","../UI/Garden/PopupText":"PopupText","../UI/ToolBar/TopToolBar":"TopToolBar","../UI/UIManager":"UIManager","./GardenLogic":"GardenLogic","./ShopLogic":"ShopLogic"}],PlantView:[function(e,t,n){"use strict";cc._RF.push(t,"66493T/sBpLxJvvH1FOnFDZ","PlantView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("../../Common/DataManager"),i=e("../../Core/ResourcesManager"),r=e("../../Common/PrefabID"),c=e("../../Common/EventID"),s=e("./PlantItem"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.content=null,t.tipBorder=null,t._isInit=!1,t.items=[],t.scrollCount=0,t.OnceFunc=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){this.AddEvents()},t.prototype.onEnable=function(){if(e.prototype.onEnable.call(this),this._isInit)for(var t=!0,n=0;n<this.items.length;++n)t&&!this.items[n].CheckLockState()&&(t=!1),this.items[n].node.active&&this.items[n].RefreshOxy();else this._isInit=!0,this.Init();this.OnceFunc&&this.OnceFunc()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this);for(var t=0;t<this.items.length;++t)this.items[t].HideDecUpgrade()},t.prototype.Init=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<o.default.instance.PlantCnf.length?[4,this.AddItem(e)]:[3,4];case 2:t.sent(),t.label=3;case 3:return++e,[3,1];case 4:return this.content.height=114*o.default.instance.PlantCnf.length+20,[2]}})})},t.prototype.AddEvents=function(){this.scrollView.node.on(c.default.scrolling,this.OnScrolling,this),this.schedule(this.Update,1)},t.prototype.Update=function(){for(var e=0;e<this.items.length;++e)this.items[e].RefreshOxy()},t.prototype.OnScrolling=function(e){for(var t=0;t<this.items.length;++t)this.HideOutsideItem(t)},t.prototype.HideOutsideItem=function(e){var t=this.items[e].node;this.content.y-.5*this.scrollView.node.height>80-t.y||this.content.y+.5*this.scrollView.node.height<-t.y-80?t.active&&(t.active=!1):t.active||(t.active=!0,t.getComponent(s.default).RefreshOxy())},t.prototype.AddItem=function(e){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){switch(n.label){case 0:return[4,i.default.instance.load(r.default.PlantItem,function(n){var a=n.getComponent(s.default);a.Init(e),n.y=114*-e-80,t.content.addChild(n),t.items.push(a),t.HideOutsideItem(e)})];case 1:return n.sent(),[2]}})})},t.prototype.DelayResetWidget=function(){this.scheduleOnce(this.ResetWidget,1)},t.prototype.ResetWidget=function(){this.node.getComponent(cc.Widget).updateAlignment();var e=this.node.getChildByName("Win");e.getComponent(cc.Widget).updateAlignment(),e.getChildByName("Title").getComponent(cc.Widget).updateAlignment(),e.getChildByName("View").getComponent(cc.Widget).updateAlignment(),this.scrollView.getComponent(cc.Widget).updateAlignment(),this.content.parent.getComponent(cc.Widget).updateAlignment(),this.content.getComponent(cc.Widget).updateAlignment()},__decorate([u({type:cc.ScrollView,displayName:"\u5212\u52a8\u5217\u8868"})],t.prototype,"scrollView",void 0),__decorate([u({type:cc.Node,displayName:"\u5217\u8868\u5185\u5bb9"})],t.prototype,"content",void 0),__decorate([u({type:cc.Sprite,displayName:"\u63d0\u793a\u8fb9\u6846"})],t.prototype,"tipBorder",void 0),t=__decorate([d],t)}(a.default);n.default=p,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Common/EventID":"EventID","../../Common/PrefabID":"PrefabID","../../Core/ResourcesManager":"ResourcesManager","../Base/View":"View","./PlantItem":"PlantItem"}],Plant:[function(e,t,n){"use strict";cc._RF.push(t,"412d0LL3vxNOLnGOuQR/zHv","Plant"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Logic/GardenLogic"),o=e("../../Common/DataManager"),i=e("../../Core/GameHelper"),r=e("../../Logic/EconomicLogic"),c=e("./Garden"),s=e("../../Logic/BuffLogic"),l=e("../../Data/BuffData"),d=e("../ToolBar/BottomToolBar"),u=e("../../Core/MathUtil"),p=e("../../Logic/PlantLogic"),f=e("../../Core/ResourcesManager"),h=e("../../Logic/TeachLogic"),g=cc._decorator,m=g.ccclass,y=g.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootNode=null,t.pot=null,t.flower=null,t.lastTapTime=0,t.row=0,t.column=0,t.pos=-2,t.offsetVec=cc.Vec2.ZERO,t.changePlantIndex=-1,t.delayPlay=0,t.isUp=!0,t.isClicking=!1,t}var n;return __extends(t,e),n=t,t.prototype.start=function(){this.AddEvents()},t.prototype.AddEvents=function(){this.rootNode.on(cc.Node.EventType.TOUCH_START,this.OnTapStart,this),this.rootNode.on(cc.Node.EventType.TOUCH_MOVE,this.OnTapMove,this),this.rootNode.on(cc.Node.EventType.TOUCH_END,this.OnTapEnd,this),this.rootNode.on(cc.Node.EventType.TOUCH_CANCEL,this.OnTapCancel,this)},t.prototype.Init=function(e,t,n,o){var i=this;this.data=e,this.row=t,this.column=n,this.pos=a.default.instance.RC2Pos(t,n),this.vec=o,this.node.position=o,this.tapOffsetVec=null,this.tempPos=-2,this.delayPlay=Math.random(),this.scheduleOnce(function(){i.rootNode.getComponent(cc.Animation).play()},this.delayPlay),this.Update(),this.RefreshRes()},t.prototype.OnTapStart=function(e){switch(a.default.instance.tapMode){case a.TapModeEnum.PRODUCT:this.SetClickState(!0);break;case a.TapModeEnum.PLACE:this.tapOffsetVec=cc.v2(e.getLocationX()-this.node.x,e.getLocationY()-this.node.y)}},t.prototype.OnTapMove=function(e){var t=this;if(a.default.instance.tapMode==a.TapModeEnum.PLACE){if(e.stopPropagation(),this.node.position=cc.v2(e.getLocationX()-this.tapOffsetVec.x,e.getLocationY()-this.tapOffsetVec.y),cc.Intersection.rectRect(this.rootNode.getBoundingBoxToWorld(),d.default.instance.storeBtn.getBoundingBoxToWorld()))d.default.instance.storeBtn.scale=1.2,this.tempPos=-1;else if(-1==this.tempPos)this.tempPos=-2,d.default.instance.storeBtn.scale=1;else if(this.isUp?this.tempPos=a.default.instance.Vec2Pos(cc.v2(this.node.position.x,this.node.position.y+.5*this.rootNode.height)):this.tempPos=a.default.instance.Vec2Pos(cc.v2(this.node.position.x,this.node.position.y-this.offsetVec.y+.5*this.rootNode.height)),this.tempPos==this.pos){if(this.changePlantIndex>-1){var n=c.default.instance.plants[this.changePlantIndex];p.default.instance.MoveTo(n,n.vec),this.changePlantIndex=-1}}else if(this.changePlantIndex<0||this.tempPos!=c.default.instance.plants[this.changePlantIndex].pos){if(this.changePlantIndex>-1){n=c.default.instance.plants[this.changePlantIndex];p.default.instance.MoveTo(n,n.vec),this.changePlantIndex=-1}var o=c.default.instance.plants.filter(function(e){return e.pos==t.tempPos})[0];o&&(p.default.instance.MoveTo(o,this.vec),this.changePlantIndex=c.default.instance.plants.indexOf(o))}if((this.tempPos<0||this.tempPos==this.pos)&&this.changePlantIndex>-1){n=c.default.instance.plants[this.changePlantIndex];p.default.instance.MoveTo(n,n.vec),this.changePlantIndex=-1}}else e.getDelta().mag()>10&&this.SetClickState(!1)},t.prototype.OnTapEnd=function(e){switch(console.log("Clicked the plant"),a.default.instance.tapMode){case a.TapModeEnum.PRODUCT:this.SetClickState(!1),this.OnProductModeEnd(e);break;case a.TapModeEnum.PLACE:this.OnPlaceModeEnd();break;case a.TapModeEnum.BUY:this.OnBuyModeEnd();break;case a.TapModeEnum.STORE:this.OnStoreModeEnd()}},t.prototype.OnTapCancel=function(e){this.SetClickState(!1)},t.prototype.SetClickState=function(e){},t.prototype.PlayCircleAni=function(){c.default.instance.circle.active=!0,c.default.instance.circle.position=cc.v2(this.vec.x,this.vec.y+50),c.default.instance.circle.getComponent(cc.Animation).play()},t.prototype.OnProductModeEnd=function(e){if(!s.default.instance.isUse[l.BuffTypeEnum.WATERING]){a.default.instance.PlayWaterSound();var t=this,d=o.default.instance.Now();if(d-this.lastTapTime<n.TapInterval)i.default.Log("Click interval is less than"+n.TapInterval);else{this.lastTapTime=d;var u=a.default.instance.plants.filter(function(e){return e.pos==t.pos})[0];if(u){var f;f=this.isUp?cc.v2(t.node.x,t.node.y+.3*t.rootNode.height):cc.v2(t.node.x,t.node.y-.3*t.rootNode.height);var g=u.product*p.default.instance.GetProductRatio();s.default.instance.isUse[l.BuffTypeEnum.PHOTOSYNTHESIS]&&(g*=2),p.default.instance.ShowPopupNum(f,"+"+g.toString(),40,cc.Color.WHITE,c.default.instance.popNumNode);var m=this.node.getBoundingBoxToWorld(),y="function"==typeof e.getLocationY?e.getLocationY():e.detail.getLocationY(),v=this.node.y+y-m.y;this.isUp||(v-=m.height);var _="function"==typeof e.getLocationX?e.getLocationX():e.detail.getLocationX();f=cc.v2(_-.5*this.node.parent.width,v),p.default.instance.PlayClickAni(f,c.default.instance.clickNode),a.default.instance.AddExp(g,d),r.default.instance.AddOxy(g),this.isUp?this.rootNode.getComponent(cc.Animation).playAdditive("FlowerJump"):this.rootNode.getComponent(cc.Animation).playAdditive("FlowerJumpDown"),h.default.instance.isTipFinger&&(h.default.instance.clickTimes++,h.default.instance.clickTimes>3&&h.default.instance.SetFingerState(!1)),i.default.IsWX&&wx.vibrateShort({})}}}},t.prototype.OnStoreModeEnd=function(){a.default.instance.StoreItem(this.pos)},t.prototype.OnBuyModeEnd=function(){},t.prototype.OnPlaceModeEnd=function(){var e=this;if(this.tapOffsetVec)if(this.tapOffsetVec=null,-1==this.tempPos)this.Remove();else if(this.tempPos>-1)if(this.changePlantIndex>-1){var t=a.default.instance.plants.filter(function(t){return t.pos==e.pos})[0];c.default.instance.plants[this.changePlantIndex].SetNewPos(this.pos,this.vec),t&&(t.pos=this.tempPos),this.pos=this.tempPos;var n=a.default.instance.Pos2Vec(this.tempPos);this.vec=n,p.default.instance.MoveTo(this,n);var o=a.default.instance.Pos2RC(this.tempPos);this.row=o[0],this.column=o[1],this.changePlantIndex=-1}else{n=a.default.instance.Pos2Vec(this.tempPos);p.default.instance.MoveTo(this,n),this.SetNewPos(this.tempPos,n)}else p.default.instance.MoveTo(this,this.vec)},t.prototype.SetNewPos=function(e,t){var n=this,o=a.default.instance.plants.filter(function(e){return e.pos==n.pos})[0];o&&(o.pos=e),console.log("Plant configuration:",o),this.pos=e,this.vec=t;var i=a.default.instance.Pos2RC(e);this.row=i[0],this.column=i[1]},t.prototype.Update=function(){var e=this;0==this.delayPlay?this.PlayAni():this.scheduleOnce(function(){e.PlayAni()},this.delayPlay)},t.prototype.PlayAni=function(){var e=this,t=a.default.instance.plants.filter(function(t){return t.pos==e.pos})[0];if(t){var n;if(n=this.isUp?cc.v2(this.node.x,this.node.y+.3*this.rootNode.height):cc.v2(this.node.x,this.node.y-.3*this.rootNode.height),s.default.instance.isUse[l.BuffTypeEnum.WATERING])for(var o=0;o<6;++o)setTimeout(function(){s.default.instance.isUse[l.BuffTypeEnum.PHOTOSYNTHESIS]?p.default.instance.ShowPopupNum(n,"+"+(t.product*p.default.instance.GetProductRatio()*2).toString(),40,cc.Color.WHITE,c.default.instance.popNumNode):p.default.instance.ShowPopupNum(n,"+"+(t.product*p.default.instance.GetProductRatio()).toString(),40,cc.Color.WHITE,c.default.instance.popNumNode),p.default.instance.PlayClickAni(cc.v2(u.default.Random(n.x-30,n.x+30),u.default.Random(n.y-30,n.y+30)),c.default.instance.clickNode)},167*o);else s.default.instance.isUse[l.BuffTypeEnum.PHOTOSYNTHESIS]?p.default.instance.ShowPopupNum(n,"+"+(t.product*p.default.instance.GetProductRatio()*2).toString(),40,cc.Color.WHITE,c.default.instance.popNumNode):p.default.instance.ShowPopupNum(n,"+"+(t.product*p.default.instance.GetProductRatio()).toString(),40,cc.Color.WHITE,c.default.instance.popNumNode);p.default.instance.Bubbling(n,c.default.instance.bubbleNode)}},t.prototype.Remove=function(){i.default.Log("Put in warehouse"),c.default.instance.RemovePlant(this.pos),d.default.instance.storeBtn.scale=1},t.prototype.StageUp=function(){this.RefreshRes()},t.prototype.RefreshRes=function(){var e=this,t=o.default.instance.GetPlantConfig(this.data.id);this.data.potColor||(this.data.potColor=u.default.RandomInt(1,5)),f.default.instance.load("pot_0"+this.data.potColor,function(t){e.pot.spriteFrame=t},cc.SpriteFrame,!1,!1,p.default.instance.PotRoot),f.default.instance.load(t.res+"_"+this.data.stage,function(n){e.flower.spriteFrame=n,e.flower.node.y=70-parseInt(t.ho.split(",")[e.data.stage-1])},cc.SpriteFrame,!1,!1,p.default.instance.FlowerRoot)},t.TapInterval=100,__decorate([y({type:cc.Node,displayName:"\u690d\u7269\u6839\u8282\u70b9"})],t.prototype,"rootNode",void 0),__decorate([y({type:cc.Sprite,displayName:"\u82b1\u76c6"})],t.prototype,"pot",void 0),__decorate([y({type:cc.Sprite,displayName:"\u82b1"})],t.prototype,"flower",void 0),t=n=__decorate([m],t)}(cc.Component);n.default=v,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Core/GameHelper":"GameHelper","../../Core/MathUtil":"MathUtil","../../Core/ResourcesManager":"ResourcesManager","../../Data/BuffData":"BuffData","../../Logic/BuffLogic":"BuffLogic","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../../Logic/PlantLogic":"PlantLogic","../../Logic/TeachLogic":"TeachLogic","../ToolBar/BottomToolBar":"BottomToolBar","./Garden":"Garden"}],PlatformMgr:[function(e,t,n){"use strict";cc._RF.push(t,"067ccKpfChJOLABkMI8bxYe","PlatformMgr"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Base64"),o=e("./MyToast"),i=function(){function e(){}return e.showLoading=function(e,t){if(void 0===t&&(t=!1),cc.sys.platform===cc.sys.WECHAT_GAME)return SDK.showLoading(e,t,null,null,null);cc.systemEvent.emit("showDataLoading",e)},e.hideLoading=function(){if(cc.sys.platform===cc.sys.WECHAT_GAME)return SDK.hideLoading();cc.systemEvent.emit("hideDataLoading")},e.hasVideo=function(){if(cc.sys.platform===cc.sys.WECHAT_GAME)return!0;if(cc.sys.platform===cc.sys.ANDROID){var e=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","hasVideo","()Z");return cc.log("android \u8fd4\u56de\u7684 hasVideo = "+e),e}if(cc.sys.platform===cc.sys.IPHONE||cc.sys.platform===cc.sys.IPAD){e=jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_hasRewardVideo_BBBB");return cc.log("iphone \u8fd4\u56de\u7684 hasVideo = "+e),e}return cc.sys.isBrowser},e.showVideo=function(e,t){console.log("js do showVideo"),cc.sys.platform===cc.sys.WECHAT_GAME?(cc.systemEvent.emit("updateBanner",{in:1,show:0,window:"video"}),SDK.showVideo(function(t){cc.systemEvent.emit("updateBanner",{}),e&&e(t)},function(){cc.systemEvent.emit("updateBanner",{}),t&&t()})):cc.sys.platform===cc.sys.ANDROID?(this._onVideoCloseCallback=e,this._onVideoFailCallback=t,jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","showVideo","()V")):cc.sys.platform===cc.sys.IPHONE||cc.sys.platform===cc.sys.IPAD?(this._onVideoCloseCallback=e,this._onVideoFailCallback=t,jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_showRewardVideo_BBBB")):cc.sys.isBrowser&&setTimeout(function(){e&&e(!0)},.1)},e._onVideoClose=function(e){cc.log(" \u5173\u95ed\u64ad\u653e\u89c6\u9891  isReward = "+e),this._onVideoCloseCallback&&this._onVideoCloseCallback(e),this._onVideoCloseCallback=null},e._onVideoFail=function(){this._onVideoFailCallback&&this._onVideoFailCallback(),this._onVideoFailCallback=null,cc.log(" \u64ad\u653e\u89c6\u9891\u5931\u8d25")},e.showBanner=function(){console.log("js do showBanner"),cc.sys.platform===cc.sys.WECHAT_GAME?SDK.showBanner():cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","showBanner","()V"):cc.sys.platform!==cc.sys.IPHONE&&cc.sys.platform!==cc.sys.IPAD||jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_showAdmobBanner_BBBB")},e.hideBanner=function(){console.log("js do hideBanner"),cc.sys.platform===cc.sys.WECHAT_GAME?SDK.hideBanner():cc.sys.platform===cc.sys.ANDROID||cc.sys.platform!==cc.sys.IPHONE&&cc.sys.platform!==cc.sys.IPAD||jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_hideAdmobBanner_BBBB")},e.isLoadingIntAdFinished=function(){return this._loadingAdFinished||cc.sys.isBrowser},e._onLoadingIntAdFinished=function(){this._loadingAdFinished=!0},e.showLoadingIntAd=function(){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?(jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","showLoadingIntAd","()V"),this._loadingAdFinished=!1):cc.sys.platform!==cc.sys.IPHONE&&cc.sys.platform!==cc.sys.IPAD||jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_showAdmobLoadingInterstitial_BBBB"))},e.showButtonIntAd=function(){console.log("js do showButtonIntAd"),cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","showButtonIntAd","()V"):cc.sys.platform!==cc.sys.IPHONE&&cc.sys.platform!==cc.sys.IPAD||jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_showAdmobNormalInterstitial_BBBB"))},e.showGameOverIntAd=function(){console.log("js do showGameOverIntAd"),cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","showGameOverIntAd","()V"):cc.sys.platform!==cc.sys.IPHONE&&cc.sys.platform!==cc.sys.IPAD||jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_showAdmobGameOverInterstitial_BBBB"))},e.showExitIntAd=function(){console.log("js do showExitIntAd"),cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?(cc.log("\u8c03\u7528 java showExitIntAd "),jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","showExitIntAd","()V")):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e._onExitIntAdClosed=function(){var e=this;cc.systemEvent.emit("_onExitIntAdClosed"),this.showLoading("Exiting"),cc.Canvas.instance.scheduleOnce(function(){e.hideLoading(),e.exitGame()},1)},e.createVideoGiftAd=function(e,t,n,a,o){void 0===o&&(o=150),cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?(cc.log("createVideoGiftAd"),jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","createVideoGiftAd","(IIIIII)V",0,Math.floor(e),Math.floor(t),Math.floor(n),Math.floor(a),Math.floor(o))):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e.showVideoGiftAd=function(){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?(cc.log("showVideoGiftAd"),jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","showVideoGiftAd","(I)V",0)):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e.hideVideoGiftAd=function(){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?(cc.log("hideVideoGiftAd"),jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","hideVideoGiftAd","(I)V",0)):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e.share=function(e,t,n){if(cc.sys.platform===cc.sys.WECHAT_GAME)SDK.share(e,t,n,null,null,null);else if(cc.sys.platform===cc.sys.ANDROID){var a={title:"Fruit King",content:"I have player a very funny game called Fruit King, you can get it from the url: https://play.google.com/store/apps/details?id=fruit.king.game.freegame",url:"https://play.google.com/store/apps/details?id=fruit.king.game.freegame"};jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","shareToFriends","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",a.title,a.content,a.url)}else cc.sys.platform!==cc.sys.IPHONE&&cc.sys.platform!==cc.sys.IPAD||jsb.reflection.callStaticMethod("JsCallOcCallC","popShare")},e.pressBackInHome=function(){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","pressBackInHome","()V"):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e.exitGame=function(){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","exitGame","()V"):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e._onPressBack=function(){},e.vibrate=function(e){void 0===e&&(e=!1),cc.sys.platform===cc.sys.WECHAT_GAME?e?window.wx.vibrateLong():window.wx.vibrateShort():cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","vibrate","(I)V",e?400:17):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD)},e.showToast=function(e,t,n,a,i,r){function c(e,t,n){var a=cc.instantiate(e);cc.director.getScene().addChild(a),a.getComponent(o.default).showToast(t,n)}null==PlatformMgr.toastPrefab?cc.loader.loadRes("myToast",function(n,a){n?cc.error(n.message||n):(PlatformMgr.toastPrefab=a,c(PlatformMgr.toastPrefab,e,t))}):c(PlatformMgr.toastPrefab,e,t)},e._onNetworkError=function(){cc.log("networkError")},e.updateCommonLeaderboard=function(e,t){void 0===t&&(t=100),cc.sys.platform===cc.sys.WECHAT_GAME||cc.sys.platform===cc.sys.ANDROID||cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD)},e.getUid=function(){if(cc.sys.platform===cc.sys.WECHAT_GAME);else{if(cc.sys.platform===cc.sys.ANDROID){var e=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","getUid","()Ljava/lang/String;");return cc.log("android \u83b7\u53d6\u7528\u6237 id = "+e),e}if(cc.sys.platform===cc.sys.IPHONE||cc.sys.platform===cc.sys.IPAD);else if(cc.sys.isBrowser)return"browser_test_id"}},e.startLevel=function(e){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","startLevel","(Ljava/lang/String;)V","level-"+e):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e.finishLevel=function(e){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","finishLevel","(Ljava/lang/String;)V","level-"+e):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e.failLevel=function(e){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","failLevel","(Ljava/lang/String;)V","level-"+e):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e.showComments=function(){if(cc.sys.platform===cc.sys.WECHAT_GAME)return{res:0};if(cc.sys.platform===cc.sys.ANDROID){var e=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","showComments","(I)Ljava/lang/String;",1);try{return JSON.parse(e)}catch(e){return{res:0}}}else if(cc.sys.platform===cc.sys.IPHONE||cc.sys.platform===cc.sys.IPAD){e=jsb.reflection.callStaticMethod("JsCallOcCallC","showComments");try{return JSON.parse(e)}catch(e){return{res:0}}}},e.userComments=function(e){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","userComments","(I)V",e):cc.sys.platform!==cc.sys.IPHONE&&cc.sys.platform!==cc.sys.IPAD||jsb.reflection.callStaticMethod("JsCallOcCallC","userComments:",e))},e.logEvent=function(e,t){cc.sys.platform===cc.sys.WECHAT_GAME||(cc.sys.platform===cc.sys.ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ApiForJs","logEvent","(Ljava/lang/String;Ljava/lang/String;)V",e,t):cc.sys.platform===cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD))},e.showRank=function(){cc.sys.platform===cc.sys.WECHAT_GAME||cc.sys.platform===cc.sys.ANDROID||cc.sys.platform!==cc.sys.IPHONE&&cc.sys.platform!==cc.sys.IPAD||jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_ShowRankList_BBBB")},e.upScoreToRank=function(e,t){cc.sys.platform===cc.sys.WECHAT_GAME||cc.sys.platform===cc.sys.ANDROID||cc.sys.platform!==cc.sys.IPHONE&&cc.sys.platform!==cc.sys.IPAD||jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_UPLoadScore_BBBB:leaboadrName:",e.toString(),t)},e.getVaildTime=function(){return cc.sys.platform===cc.sys.IPHONE||cc.sys.platform===cc.sys.IPAD?jsb.reflection.callStaticMethod("AAAA_JsCallOcCallC_BBBB","AAAA_getValidTime_BBBB"):a.encode("2990-10-10")},e.isVaildTime=function(){var e=this.getVaildTime(),t=new Date(a.decode(e)),n=new Date;return t.getTime()<n.getTime()},e._onVideoCloseCallback=null,e._onVideoFailCallback=null,e._loadingAdFinished=!1,e.toastPrefab=null,e}();n.default=i,window.PlatformMgr=i,cc._RF.pop()},{"./Base64":"Base64","./MyToast":"MyToast"}],PopupEcoTip:[function(e,t,n){"use strict";cc._RF.push(t,"dada4J1yMdOkJM7fPMk/JVh","PopupEcoTip"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../core/ResourcesPool"),o=e("../../Logic/EconomicLogic"),i=cc._decorator,r=i.ccclass,c=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.oxyIcon=null,t.diamondIcon=null,t}return __extends(t,e),t.prototype.start=function(){this.playAction()},t.prototype.playAction=function(){var e=this,t=cc.sequence(cc.spawn(cc.moveBy(1.5,0,150),cc.fadeTo(1.5,25)),cc.callFunc(function(){e.destroySelf()},this));this.node.runAction(t)},t.prototype.showEcoNum=function(e,t){e==o.EconomicTypeEnum.COIN?(this.oxyIcon.node.active=!0,this.diamondIcon.node.active=!1):e==o.EconomicTypeEnum.DIAMOND&&(this.oxyIcon.node.active=!1,this.diamondIcon.node.active=!0),this.label.string=t},t.prototype.getKey=function(){return this.node.name},t.prototype.awake=function(){this.node.active=!0,this.node.opacity=255,this.playAction()},t.prototype.sleep=function(){this.node.stopAllActions(),this.node.setParent(null),this.node.active=!1},t.prototype.destroySelf=function(){a.default.instance.put(this)},__decorate([c({type:cc.Label,displayName:"\u8d27\u5e01\u6570\u91cf"})],t.prototype,"label",void 0),__decorate([c({type:cc.Sprite,displayName:"\u6c27\u6c14\u56fe\u6807"})],t.prototype,"oxyIcon",void 0),__decorate([c({type:cc.Sprite,displayName:"\u5b9d\u77f3\u56fe\u6807"})],t.prototype,"diamondIcon",void 0),t=__decorate([r],t)}(cc.Component);n.default=s,cc._RF.pop()},{"../../Logic/EconomicLogic":"EconomicLogic","../../core/ResourcesPool":"ResourcesPool"}],PopupText:[function(e,t,n){"use strict";cc._RF.push(t,"2e6fcfe6F9CqaGVaos3yc6A","PopupText"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../core/ResourcesPool"),o=cc._decorator,i=o.ccclass,r=o.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t}return __extends(t,e),t.prototype.start=function(){this.playAction()},t.prototype.playAction=function(){var e=this;this.node.scale=.2;var t=cc.sequence(cc.scaleTo(.2,1.2),cc.spawn(cc.scaleTo(.3,1),cc.moveBy(.8,0,150),cc.fadeTo(.8,25)),cc.callFunc(function(){e.destroySelf()},this));this.node.runAction(t)},t.prototype.showText=function(e,t,n){this.label.string=e,this.label.fontSize=t,this.label.node.color=n},t.prototype.getKey=function(){return this.node.name},t.prototype.awake=function(){this.node.active=!0,this.node.opacity=255,this.playAction()},t.prototype.sleep=function(){this.node.stopAllActions(),this.node.setParent(null),this.node.active=!1},t.prototype.destroySelf=function(){a.default.instance.put(this)},__decorate([r(cc.Label)],t.prototype,"label",void 0),t=__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{"../../core/ResourcesPool":"ResourcesPool"}],PrefabID:[function(e,t,n){"use strict";cc._RF.push(t,"bdc9bXVr9hPGLs0qVrLEjwG","PrefabID"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(){}return e.Tier="Tier",e.Plant="Plant",e.PopupNum="PopupNum",e.PopupEcoTip="PopupEcoTip",e.Bubble="Bubble",e.ClickCircle="ClickCircle",e.PlantItem="item/PlantItemPrefab",e.StoreItem="item/StoreItemPrefab",e.RankItem="item/RankItemPrefab",e.AtlasItem="item/AtlasItemPrefab",e.TeachView="view/TeachView",e.Teach2View="view/Teach2View",e}();n.default=a,cc._RF.pop()},{}],PurchaseView:[function(e,t,n){"use strict";cc._RF.push(t,"b66b5OZB25PS4QiaevfkoWW","PurchaseView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("../../Logic/EconomicLogic"),i=e("../UIManager"),r=e("../../Core/RewardLogic"),c=e("../../Logic/BuffLogic"),s=e("../../Data/BuffData"),l=e("../../Core/GameHelper"),d=e("../../Core/Server"),u=e("../../Common/ReportEventID"),p=cc._decorator,f=p.ccclass,h=p.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t.purchaseBtn=null,t.diamond=null,t.desc=null,t.desc2=null,t.needDiamond=0,t}return __extends(t,e),t.prototype.start=function(){this.AddEvents()},t.prototype.Init=function(e,t,n,a){void 0===a&&(a=null),this.buffType=e,this.needDiamond=n,this.diamond.string=n.toString(),this.callBack=a,this.hasVideo=t,this.RefreshCD(),e==s.BuffTypeEnum.ALL?this.hasVideo?(this.title.string="Reset now\uff0cAll items cool down!",this.desc.active=!1):(this.title.string="The ad has been read!",this.desc.active=!0):(this.title.string="Reset now",this.desc.active=!0)},t.prototype.AddEvents=function(){this.purchaseBtn.node.on(cc.Node.EventType.TOUCH_END,this.OnPurchaseBtnTap,this),this.schedule(this.RefreshCD,1)},t.prototype.RefreshCD=function(){var e;this.hasVideo||(e=this.buffType==s.BuffTypeEnum.ALL?c.default.instance.CheckAllCD():c.default.instance.CheckBuffCD(this.buffType),this.desc2.string="time "+l.default.TransClockTime(e),e>0?this.needDiamond=c.default.instance.CalcCostDiamond(e/1e3):(this.needDiamond=0,i.default.instance.closeView(i.ViewName.PurchaseView)),this.diamond.string=this.needDiamond.toString())},t.prototype.OnPurchaseBtnTap=function(e){var t=this;if(this.hasVideo)r.default.instance.VideoReward(!0,function(){t.callBack&&t.callBack(),d.default.reportEvent(u.default.prop_reset_video,u.default.def_page),i.default.instance.closeView(t.node.name)});else{if(o.default.instance.diamond<this.needDiamond)return void PlatformMgr.showToast("Insufficient diamonds");switch(o.default.instance.diamond-=this.needDiamond,this.callBack&&this.callBack(),this.buffType){case s.BuffTypeEnum.ALL:d.default.reportEvent(u.default.prop_reset_diamond,u.default.def_page);break;case s.BuffTypeEnum.PHOTOSYNTHESIS:d.default.reportEvent(u.default.prop_sun_reset,u.default.def_page);break;case s.BuffTypeEnum.WATERING:d.default.reportEvent(u.default.prop_water_reset,u.default.def_page);break;case s.BuffTypeEnum.FERTILIZER:d.default.reportEvent(u.default.prop_fertilize_reset,u.default.def_page)}i.default.instance.closeView(this.node.name)}},__decorate([h({type:cc.Label,displayName:"\u6807\u9898"})],t.prototype,"title",void 0),__decorate([h({type:cc.Button,displayName:"\u786e\u5b9a\u652f\u4ed8"})],t.prototype,"purchaseBtn",void 0),__decorate([h({type:cc.Label,displayName:"\u94bb\u77f3\u6570"})],t.prototype,"diamond",void 0),__decorate([h({type:cc.Node,displayName:"\u8bf4\u660e\u7ed3\u70b9"})],t.prototype,"desc",void 0),__decorate([h({type:cc.Label,displayName:"\u51b7\u5374\u65f6\u95f4"})],t.prototype,"desc2",void 0),t=__decorate([f],t)}(a.default);n.default=g,cc._RF.pop()},{"../../Common/ReportEventID":"ReportEventID","../../Core/GameHelper":"GameHelper","../../Core/RewardLogic":"RewardLogic","../../Core/Server":"Server","../../Data/BuffData":"BuffData","../../Logic/BuffLogic":"BuffLogic","../../Logic/EconomicLogic":"EconomicLogic","../Base/View":"View","../UIManager":"UIManager"}],RankItem:[function(e,t,n){"use strict";cc._RF.push(t,"397deFq/zhDQJd+Ofc5ThF6","RankItem"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Core/ResourcesPool"),o=cc._decorator,i=o.ccclass,r=o.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rank=null,t.avatar=null,t.nickname=null,t.score=null,t.no1=null,t.no2=null,t.no3=null,t.isMe=!1,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.init=function(e,t,n,a){var o=this,i=parseInt(e);if(this.isMe)this.rank.string=i.toString();else switch(i){case 1:this.no1.active=!0,this.no2.active=!1,this.no3.active=!1,this.rank.node.active=!1;break;case 2:this.no1.active=!1,this.no2.active=!0,this.no3.active=!1,this.rank.node.active=!1;break;case 3:this.no1.active=!1,this.no2.active=!1,this.no3.active=!0,this.rank.node.active=!1;break;default:this.no1.active=!1,this.no2.active=!1,this.no3.active=!1,this.rank.node.active=!0,this.rank.string=i.toString()}this.avatar.node.active=!1,t&&cc.loader.load({url:t,type:"jpg"},function(e,t){o.avatar.spriteFrame=new cc.SpriteFrame(t),o.avatar.node.active=!0}),this.nickname.string=n,this.score.string=a+"level"},t.prototype.getKey=function(){return"RankItem"},t.prototype.awake=function(){this.node.active=!0},t.prototype.sleep=function(){this.node.active=!1},t.prototype.destroySelf=function(){a.default.instance.put(this,100)},__decorate([r({type:cc.Label,displayName:"\u6392\u540d"})],t.prototype,"rank",void 0),__decorate([r({type:cc.Sprite,displayName:"\u5934\u50cf"})],t.prototype,"avatar",void 0),__decorate([r({type:cc.Label,displayName:"\u6635\u79f0"})],t.prototype,"nickname",void 0),__decorate([r({type:cc.Label,displayName:"\u5206\u6570"})],t.prototype,"score",void 0),__decorate([r({type:cc.Node,displayName:"\u7b2c\u4e00\u540d"})],t.prototype,"no1",void 0),__decorate([r({type:cc.Node,displayName:"\u7b2c\u4e8c\u540d"})],t.prototype,"no2",void 0),__decorate([r({type:cc.Node,displayName:"\u7b2c\u4e09\u540d"})],t.prototype,"no3",void 0),__decorate([r()],t.prototype,"isMe",void 0),t=__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{"../../Core/ResourcesPool":"ResourcesPool"}],RankView:[function(e,t,n){"use strict";cc._RF.push(t,"e45a4yaPydKQ5xSzwSjaRgW","RankView"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../Base/View"),i=e("../../Libs/bignumber"),r=e("../../Core/OpenData"),c=e("../../Core/UserInfoBtn"),s=e("../../Core/Server"),l=e("../../Data/GardenData"),d=e("../../Core/GameHelper"),u=e("./RankItem"),p=e("../../Core/ResourcesManager"),f=e("../../Common/PrefabID"),h=e("../../Core/ShareLogic"),g=e("../../Common/EventID"),m=e("../../Core/ResourcesPool"),y=e("./SubDisplay");(function(e){e[e.FRIEND=0]="FRIEND",e[e.WORLD=1]="WORLD",e[e.GROUP=2]="GROUP",e[e.NONE=3]="NONE"})(a||(a={}));var v=cc._decorator,_=v.ccclass,S=v.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.content=null,t.btns=[],t.myItem=null,t.subRank=null,t.isSharing=!1,t.items={},t.curType=a.NONE,t._isInit=!1,t}var n;return __extends(t,e),n=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),n._instance=this},t.prototype.start=function(){this.AddEvents()},t.prototype.onEnable=function(){e.prototype.onEnable.call(this),this.worldWxBtn&&this.worldWxBtn.showWxBtn()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.worldWxBtn&&this.worldWxBtn.hideWxBtn(),this.unschedule(this.showWxBtn),this.subRank.hideSub(),SDK.offShow("Group")},t.prototype.OnOpen=function(){this.OnFrientBtnTap(null),this.showWxBtn()},t.prototype.showWxBtn=function(){var e=this;this.worldWxBtn?this.worldWxBtn.showWxBtn():(this.worldWxBtn=new c.default,this.worldWxBtn.createWxBtn(this.btns[a.WORLD].node,function(){e.worldWxBtn.setNormalMode(e.WorldRankBtnSuccess),e.WorldRankBtnSuccess()},this.WorldRankBtnFail))},t.prototype.hideWxBtn=function(){this.worldWxBtn&&this.worldWxBtn.hideWxBtn()},t.prototype.AddEvents=function(){this.scrollView.node.on(g.default.scrolling,this.OnScrolling,this),this.btns[a.FRIEND].node.on(cc.Node.EventType.TOUCH_END,this.OnFrientBtnTap,this),this.btns[a.WORLD].node.on(cc.Node.EventType.TOUCH_END,this.OnWorldBtnTap,this),this.btns[a.GROUP].node.on(cc.Node.EventType.TOUCH_END,this.OnGroupBtnTap,this)},t.prototype.OnScrolling=function(e){var t=this;if(this.curList)for(var n=function(e){a.content.y-.5*a.scrollView.node.height>114*e+150||a.content.y+.5*a.scrollView.node.height<114*e-10?a.items[e]&&(d.default.Log("Swipe to remove item"),a.items[e].destroySelf(),a.items[e]=null):a.items[e]||(d.default.Log("Swipe to add items"),a.GetRankItem().then(function(n){t.items[e]=n,t.items[e].init(t.curList[e].rank,t.curList[e].avatar,t.curList[e].name,t.curList[e].score),t.items[e].node.parent||t.content.addChild(t.items[e].node),t.items[e].node.y=114*-e-60}))},a=this,o=0;o<this.curList.length;++o)n(o)},t.prototype.GetRankItem=function(){return __awaiter(this,void 0,Promise,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return(e=m.default.instance.get("RankItem"))?[3,2]:[4,p.default.instance.load(f.default.RankItem,function(t){e=t.getComponent(u.default)})];case 1:return t.sent(),this.content.addChild(e.node),[3,3];case 2:d.default.Log("Use old items"),t.label=3;case 3:return[2,e]}})})},t.prototype.OnFrientBtnTap=function(e){this.curType!=a.FRIEND&&this.SelTab(a.FRIEND),this.myItem.active=!1,this.scrollView.node.active=!1,this.subRank.showFriendsRank()},t.prototype.ClearItems=function(){for(var e in this.items)this.items[e]&&(this.items[e].destroySelf(),this.items[e]=null)},t.prototype.InitItems=function(e){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(a){switch(a.label){case 0:this.ClearItems(),this.scrollView.node.active=!0,this.scrollView.scrollToTop(),this.curList=e.list,t=0,a.label=1;case 1:return t<e.list.length?this.content.y-.5*this.scrollView.node.height<=114*t+150&&this.content.y+.5*this.scrollView.node.height>=114*t-10?[4,this.GetRankItem().then(function(e){n.items[t]=e})]:[3,3]:[3,4];case 2:a.sent(),this.items[t].node.y=114*-t-70,this.items[t].init(e.list[t].rank,e.list[t].avatar,e.list[t].name,e.list[t].score),a.label=3;case 3:return++t,[3,1];case 4:return this.content.height=114*t+80,d.default.Log("List height:"+this.content.height),this.myItem.active=!0,this.myItem.getComponent(u.default).init(e.mine.rank,e.mine.avatar,e.mine.name,e.mine.score),[2]}})})},t.prototype.OnWorldBtnTap=function(e){this.curType!=a.WORLD&&(this.worldWxBtn.normalCallback?this.worldWxBtn.normalCallback():this.worldWxBtn._wxBtn&&this.worldWxBtn.onNormalTap(this.WorldRankBtnSuccess,this.WorldRankBtnFail))},t.prototype.OnGroupBtnTap=function(e){var t=this;SDK.showModal("","Click the group link\uff0cCan view ranking!",function(e){e.confirm&&(h.default.instance.Share(h.ShareTypeEnum.GROUP),t.isSharing=!0)},function(){})},t.prototype.ShowGroupRank=function(e){var t=this;SDK.showLoading("Loading",!0),this.GetGroupRank(e).then(function(e){t.InitItems(e),SDK.hideLoading(),t.SelTab(a.GROUP)},function(){SDK.hideLoading(),t.ClearItems(),PlatformMgr.showToast("Failed to load\uff0cPlease try again")})},t.prototype.SelTab=function(e){this.curType=e;for(var t=0;t<this.btns.length;++t)t==e?(this.btns[t].interactable=!1,this.btns[t].node.getChildByName("Label").y=4):(this.btns[t].interactable=!0,this.btns[t].node.getChildByName("Label").y=-4)},t.prototype.GetFriendsRank=function(){return __awaiter(this,void 0,Promise,function(){var e,t,n,a,o,i;return __generator(this,function(c){switch(c.label){case 0:return[4,r.OpenData.instance.getFriendCloudStorage(["score"])];case 1:return e=c.sent(),t=this.convertFriendsListToWorldList(e.data),[4,r.OpenData.instance.getUserInfo()];case 2:return n=c.sent(),a=n.data[0],o=t.findIndex(function(e){return e.avatar==a.avatarUrl}),i=o>-1?t[o]:null,[2,{list:t,mine:i}]}})})},t.prototype.GetGroupRank=function(e){return __awaiter(this,void 0,Promise,function(){var t,n,a,o,i,c;return __generator(this,function(s){switch(s.label){case 0:return[4,r.OpenData.instance.getGroupCloudStorage(e,["score"])];case 1:return t=s.sent(),n=this.convertFriendsListToWorldList(t.data),[4,r.OpenData.instance.getUserInfo()];case 2:return a=s.sent(),o=a.data[0],i=n.findIndex(function(e){return e.avatar==o.avatarUrl}),c=i>-1?n[i]:null,[2,{list:n,mine:c}]}})})},t.prototype.GetWorldRankList=function(e){void 0===e&&(e=null),this.curType=a.WORLD,s.default.getLeaderboard(function(t){if(!(t&&t.data&&t.data.data&&Array.isArray(t.data.data.list)))return d.default.Log("World ranking data is incorrect:",t),SDK.hideLoading(),void PlatformMgr.showToast("Failed to get the world list!");SDK.hideLoading(),e&&e(t.data.data)},function(e){d.default.Log("Leaderboard failed to load",e),SDK.hideLoading(),PlatformMgr.showToast("Failed to get the leaderboard")})},t.prototype.WorldRankBtnSuccess=function(){n._instance.SelTab(a.WORLD),n._instance.subRank.hideSub(),SDK.showLoading("Loading",!0),s.default.submitLeaderboard(l.default.data.level.toString(),function(){n._instance.GetWorldRankList(function(e){d.default.Log("Leaderboard data obtained:",e),n._instance.InitItems(e)})},function(){SDK.hideLoading(),PlatformMgr.showToast("Failed to submit score to the world list!")})},t.prototype.WorldRankBtnFail=function(e){PlatformMgr.showToast("User authorization is required to view the world list!")},t.prototype.convertFriendsListToWorldList=function(e){var t=e.map(function(e){return{rank:"0",name:e.nickname,avatar:e.avatarUrl,score:e.KVDataList[0].value,score_big:new i.default(e.KVDataList[0].value)}}).sort(function(e,t){return t.score_big.comparedTo(e.score_big)});return t.forEach(function(e,t){e.rank=t+1+""}),t},t.prototype.DelayResetWidget=function(){this.scheduleOnce(this.ResetWidget,1)},t.prototype.ResetWidget=function(){this.node.getComponent(cc.Widget).updateAlignment();var e=this.node.getChildByName("Win");e.getComponent(cc.Widget).updateAlignment(),e.getChildByName("Title").getComponent(cc.Widget).updateAlignment();var t=e.getChildByName("View");t.getComponent(cc.Widget).updateAlignment(),t.getChildByName("Tabs").getComponent(cc.Widget).updateAlignment(),this.scrollView.getComponent(cc.Widget).updateAlignment(),this.content.parent.getComponent(cc.Widget).updateAlignment(),this.content.getComponent(cc.Widget).updateAlignment()},__decorate([S({type:cc.ScrollView,displayName:"\u5212\u52a8\u5bb9\u5668"})],t.prototype,"scrollView",void 0),__decorate([S({type:cc.Node,displayName:"\u5212\u52a8\u5217\u8868"})],t.prototype,"content",void 0),__decorate([S({type:cc.Button,tooltip:"\u6392\u884c"})],t.prototype,"btns",void 0),__decorate([S({type:cc.Node,displayName:"\u6211\u7684\u6392\u884c"})],t.prototype,"myItem",void 0),__decorate([S({type:y.default})],t.prototype,"subRank",void 0),t=n=__decorate([_],t)}(o.default);n.default=w,cc._RF.pop()},{"../../Common/EventID":"EventID","../../Common/PrefabID":"PrefabID","../../Core/GameHelper":"GameHelper","../../Core/OpenData":"OpenData","../../Core/ResourcesManager":"ResourcesManager","../../Core/ResourcesPool":"ResourcesPool","../../Core/Server":"Server","../../Core/ShareLogic":"ShareLogic","../../Core/UserInfoBtn":"UserInfoBtn","../../Data/GardenData":"GardenData","../../Libs/bignumber":"bignumber","../Base/View":"View","./RankItem":"RankItem","./SubDisplay":"SubDisplay"}],ReportEventID:[function(e,t,n){"use strict";cc._RF.push(t,"11880Im0J1GhLN6ac7U/DJN","ReportEventID"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(){}return e.level_3="level_3",e.level_5="level_5",e.level_10="level_10",e.level_20="level_20",e.bs_click="bs_click",e.bs_plant_upgrade="bs_plant_upgrade",e.plant_buy_lv2="plant_buy_lv2",e.plant_buy_lv5="plant_buy_lv5",e.plant_buy_lv10="plant_buy_lv10",e.plant_buy_lv15="plant_buy_lv15",e.plant_buy_lv20="plant_buy_lv20",e.bs_prop="bs_prop",e.bs_prop_use="bs_prop_use",e.bs_prop_upgradeplant="bs_prop_upgradeplant",e.bs_prop_upgrade="bs_prop_upgrade",e.upgrade_manual="upgrade_manual",e.upgrade_prop="upgrade_prop",e.plant_rebuy_lv1="plant_rebuy_lv1",e.plant_rebuy_lv2="plant_rebuy_lv2",e.plant_rebuy_lv5="plant_rebuy_lv5",e.plant_rebuy_lv10="plant_rebuy_lv10",e.plant_rebuy_lv15="plant_rebuy_lv15",e.plant_rebuy_lv20="plant_rebuy_lv20",e.prop_sun_use="prop_sun_use",e.prop_water_use="prop_water_use",e.prop_fertilize_use="prop_fertilize_use",e.prop_reset_video="prop_reset_video",e.prop_reset_diamond="prop_reset_diamond",e.prop_sun_reset="prop_sun_reset",e.prop_water_reset="prop_water_reset",e.prop_fertilize_reset="prop_fertilize_reset",e.prop_fertilize_reward2="prop_fertilize_reward2",e.prop_fertilize_reward5="prop_fertilize_reward5",e.prop_fertilize_reward10="prop_fertilize_reward10",e.prop_fertilize_reward20="prop_fertilize_reward20",e.prop_fertilize_reward30="prop_fertilize_reward30",e.prop_fertilize_reward50="prop_fertilize_reward50",e.prop_fertilize_reward80="prop_fertilize_reward80",e.prop_fertilize_video="prop_fertilize_video",e.prop_fertilize_share="prop_fertilize_share",e.upgrade_pop_times="upgrade_pop_times",e.upgrade_motive="upgrade_motive",e.upgrade_motive_video="upgrade_motive_video",e.upgrade_motive_share="upgrade_motive_share",e.plant_maxlv_motive="plant_maxlv_motive",e.game_enter="game_enter",e.game_loaded="game_loaded",e.shop_buy_addproduct="shop_buy_addproduct",e.plant_maxlv_video="plant_maxlv_video",e.plant_maxlv_share="plant_maxlv_share",e.def_page="index",e}();n.default=a,cc._RF.pop()},{}],ReportLogic:[function(e,t,n){"use strict";cc._RF.push(t,"3f0b3Svs4pIFIZOxelD4weR","ReportLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("./GameHelper"),o=e("./Server"),i=function(){function e(){this.needAuth="undefined"==typeof wx?0:-1}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.reportAppid=function(e){"undefined"!=typeof wx&&o.default.reportAppid(e,null)},e.prototype.checkNeedAuthList=function(){this.needAuth=1==SDK.conf.authflag?1:0,a.default.Log("\u4e0b\u53d1needAuth:",SDK.conf.authflag)},e}();n.default=i,cc._RF.pop()},{"./GameHelper":"GameHelper","./Server":"Server"}],ResourcesManager:[function(e,t,n){"use strict";cc._RF.push(t,"2ee5189PwJOJI783s/mRdlg","ResourcesManager"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("./GameHelper"),o=cc._decorator,i=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.jsonRoot="config/",t.prefabDic={},t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new n,this._instance.init()),n._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.loadJson=function(e){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(n){return[2,new Promise(function(n,o){cc.loader.loadRes(t.jsonRoot+e,function(t,i){t?(a.default.Log("json"+e+"Failed to load ",t),o()):n(i.json)})})]})})},t.prototype.load=function(e,t,n,a,o,i){var r=this;return void 0===n&&(n=cc.Prefab),void 0===a&&(a=!0),void 0===o&&(o=!0),void 0===i&&(i="prefab/"),new Promise(function(c,s){if(r.prefabDic[e]){if(o){var l=cc.instantiate(r.prefabDic[e]);t&&t(l)}else t&&t(r.prefabDic[e]);c()}else{var d=i+e;cc.loader.loadRes(d,n,function(n,i){if(n)cc.log("Failed to load resource path",d,n.toString());else if(a&&(r.prefabDic[e]=i),o){var s=cc.instantiate(i);t&&t(s)}else t&&t(i);c()})}})},t=n=__decorate([i],t)}(cc.Component));n.default=r,cc._RF.pop()},{"./GameHelper":"GameHelper"}],ResourcesPool:[function(e,t,n){"use strict";cc._RF.push(t,"91bbdEQF+VFFaxnBCp51Gzy","ResourcesPool"),Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,o=a.ccclass,i=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.trash={},t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new n,this._instance.init()),n._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.put=function(e,t){void 0===t&&(t=100);var n=e.getKey();this.trash[n]||(this.trash[n]=[]),this.trash[n].length<t?(e.sleep(),this.trash[n].push(e)):e instanceof cc.Component?e.node.destroy():e instanceof cc.Object&&e.destroy()},t.prototype.get=function(e){var t;if(t="string"==typeof e?e:typeof e,!this.trash[t]||0==this.trash[t].length)return null;var n=this.trash[t].shift();return n.awake(),n},t.prototype.getLen=function(e){var t;return t="function"==typeof e?e.name:e,this.trash[t]?this.trash[t].length:0},t=n=__decorate([o],t)}(cc.Component));n.default=i,cc._RF.pop()},{}],RewardLogic:[function(e,t,n){"use strict";cc._RF.push(t,"0cacca5ae5DuYrbpVQML35r","RewardLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("./DataStorage"),i=e("./GameHelper"),r=e("./ShareLogic"),c=e("./MathUtil"),s=e("../Common/DataID"),l=e("../UI/UIManager");(function(e){e[e.NONE=0]="NONE",e[e.SHARE=1]="SHARE",e[e.VIDEO=2]="VIDEO"})(a=n.RewardMethodEnum||(n.RewardMethodEnum={}));var d=function(){function e(){this.shareRatio={},this.shareDate="",this.shareTimes=0,this.init()}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.InitGroupData(),this.getShareRatio()},e.prototype.InitGroupData=function(){this.shareDate!=(new Date).toLocaleDateString()&&(this.shareDate=(new Date).toLocaleDateString())},e.prototype.getShareRatio=function(){if(SDK.conf.share_chance.indexOf("_")>-1)for(var e=SDK.conf.share_chance.split(","),t=0;t<e.length;t++){var n=e[t].split("_");this.shareRatio[n[0]]=n[1]}i.default.Log("\u5206\u4eab\u6982\u7387:",this.shareRatio)},e.prototype.ShareOrVideo=function(e){var t=c.default.RandomInt(0,99);return this.shareRatio[e]&&t<this.shareRatio[e]?-1!=SDK.conf.share_flag&&this.shareTimes<SDK.conf.day_share_count?a.SHARE:PlatformMgr.hasVideo()?a.VIDEO:a.NONE:PlatformMgr.hasVideo()?a.VIDEO:this.shareRatio[e]&&-1!=SDK.conf.share_flag&&this.shareTimes<SDK.conf.day_share_count?a.SHARE:a.NONE},e.prototype.HasMotivate=function(){return PlatformMgr.hasVideo()||-1!=SDK.conf.share_flag&&this.shareTimes<SDK.conf.day_share_count},e.prototype.SaveShareTimes=function(){o.default.setItem(s.default.sts,this.shareTimes.toString())},e.prototype.SaveLastShareDate=function(){o.default.setItem(s.default.sdate,this.shareDate)},e.prototype.checkDate=function(){this.shareDate!=(new Date).toDateString()&&(this.shareDate=(new Date).toDateString(),this.shareGroupList=[],this.shareTimes=0,this.SaveShareTimes(),this.SaveLastShareDate())},e.prototype.CalcSuccShareTimes=function(){this.shareTimes++,this.SaveShareTimes()},e.prototype.ShareReward=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),r.default.instance.Share(e,null,t,n)},e.prototype.VideoReward=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),e=l.default.hasBanner,PlatformMgr.hasVideo()?e&&PlatformMgr.showVideo(function(a){e&&(a?t&&t():n&&n())},function(){e&&n&&n()}):(n&&n(),PlatformMgr.showToast("No video to watch",1500,null,null,null,null))},e}();n.default=d,cc._RF.pop()},{"../Common/DataID":"DataID","../UI/UIManager":"UIManager","./DataStorage":"DataStorage","./GameHelper":"GameHelper","./MathUtil":"MathUtil","./ShareLogic":"ShareLogic"}],RewardView:[function(e,t,n){"use strict";cc._RF.push(t,"b6520XdMINOx5S7K3OnqCM3","RewardView"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../Base/View"),i=e("../../Core/ShareLogic"),r=e("../../Core/RewardLogic"),c=e("../UIManager"),s=e("../../Logic/EconomicLogic"),l=e("../../Sound/SoundManager"),d=e("../../Sound/SoundClip"),u=e("../../Logic/GardenLogic"),p=e("../../Common/CommonUils"),f=e("../../Core/GameHelper");(function(e){e[e.OXY=0]="OXY",e[e.DIAMOND=1]="DIAMOND"})(a=n.RewardTypeEnum||(n.RewardTypeEnum={}));var h=function(){return function(){}}();n.RewardData=h;var g=cc._decorator,m=g.ccclass,y=g.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rewardBtn=null,t.videoBtn=null,t.coinItem=null,t.coinTxt=null,t.diamondItem=null,t.diamondTxt=null,t.otherItem=null,t.title=null,t.desc=null,t.desc2=null,t.desc3=null,t.view=null,t.typeIcons=[],t.rewardMethod=r.RewardMethodEnum.NONE,t.shareType=i.ShareTypeEnum.NONE,t.ratio=1,t.chineseRatio=["One","double","three","four"],t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.closeCallBack=function(){t.OnGetBtnTap()}},t.prototype.start=function(){this.AddEvents()},t.prototype.onEnable=function(){e.prototype.onEnable.call(this),c.default.instance.GetViewStatus(c.ViewName.RankView)==c.ViewStatusEnum.OPEN&&c.default.instance.GetView(c.ViewName.RankView,function(e){e.hideWxBtn()})},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),c.default.instance.GetViewStatus(c.ViewName.RankView)==c.ViewStatusEnum.OPEN&&c.default.instance.GetView(c.ViewName.RankView,function(e){e.showWxBtn()})},t.prototype.AddEvents=function(){this.rewardBtn.node.on(cc.Node.EventType.TOUCH_END,this.OnRewardBtnTap,this),this.videoBtn.node.on(cc.Node.EventType.TOUCH_END,this.OnRewardBtnTap,this)},t.prototype.init=function(e){var t=this;f.default.Log("\u5f53\u524d\u7684\u5206\u4eab\u7c7b\u578b:"+e.shareType),this.rewardMethod=e.rewardMethod,this.shareType=e.shareType,this.rewardTypes=e.rewardTypes,this.rewardVals=e.rewardVals,this.ratio=e.ratio,this.callback=e.callback,e.title?this.title.string=e.title:this.title.string="income",e.desc?(this.desc.node.active=!0,this.desc.string=e.desc):this.desc.node.active=!1,e.desc2?(this.desc2.node.active=!0,this.desc2.string=e.desc2):this.desc2.node.active=!1,e.desc3?(this.desc3.node.active=!0,this.desc3.string=e.desc3):this.desc3.node.active=!1,1!=e.ratio&&r.default.instance.HasMotivate()?(f.default.IsQQ&&(this.rewardBtn.node.parent.active=!1),this.rewardMethod==r.RewardMethodEnum.SHARE?(this.rewardBtn.node.parent.active=!0,f.default.Log("\u5f53\u524d\u6fc0\u52b1\u70b9\u662f\u5206\u4eab"),this.rewardBtn.node.active=!0,this.rewardBtn.node.getChildByName("Label").getComponent(cc.Label).string="Reward x "+this.ratio,this.videoBtn.node.active=!1):(this.rewardMethod==r.RewardMethodEnum.VIDEO&&(this.rewardBtn.node.parent.active=!0),f.default.Log("The current incentive is video"),this.rewardBtn.node.active=!1,this.videoBtn.node.active=!0,this.videoBtn.node.getChildByName("Label").getComponent(cc.Label).string="Reward x "+this.ratio,this.videoBtn.interactable=!0,this.videoBtn.node.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL))):(f.default.IsQQ&&(this.rewardBtn.node.parent.active=!1),1!=e.ratio?(f.default.IsQQ||(this.rewardBtn.node.parent.active=!0),this.rewardBtn.node.active=!1,this.videoBtn.node.active=!0,this.videoBtn.node.getChildByName("Label").getComponent(cc.Label).string="Reward x "+this.ratio,this.videoBtn.interactable=!1,this.videoBtn.node.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.GRAY),this.scheduleOnce(function(){r.default.instance.HasMotivate()&&(t.rewardMethod==r.RewardMethodEnum.SHARE?(t.rewardBtn.node.active=!0,t.rewardBtn.node.getChildByName("Label").getComponent(cc.Label).string="Reward x "+t.ratio,t.videoBtn.node.active=!1):(t.videoBtn.interactable=!0,t.videoBtn.node.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL)))},.5)):this.rewardBtn.node.parent.active=!1);var n=[],o=this.rewardTypes.indexOf(a.OXY);o>-1&&this.rewardVals[o]>0?(this.coinTxt.string="+"+s.default.instance.number2UnitFormat(this.rewardVals[o]),this.coinItem.active=!0,n.push(this.coinItem)):this.coinItem.active=!1,(o=this.rewardTypes.indexOf(a.DIAMOND))>-1&&this.rewardVals[o]>0?(this.diamondTxt.getComponent(cc.Label).string="+"+this.rewardVals[o].toString(),this.diamondItem.active=!0,n.push(this.diamondItem)):this.diamondItem.active=!1},t.prototype.OnGetBtnTap=function(){this.CollectReward()},t.prototype.OnRewardBtnTap=function(e){var t=this;l.default.instance.playAudioClip(d.SoundClipType.click),this.rewardMethod==r.RewardMethodEnum.NONE&&(this.rewardMethod=r.default.instance.ShareOrVideo(this.shareType),this.rewardMethod==r.RewardMethodEnum.NONE)||(this.rewardMethod==r.RewardMethodEnum.SHARE?r.default.instance.ShareReward(this.shareType,function(){t.CollectReward(!0)}):r.default.instance.VideoReward(!0,function(){t.CollectReward(!0)}))},t.prototype.CollectReward=function(e){void 0===e&&(e=!1);for(var t=e?this.ratio:1,n=0;n<this.rewardTypes.length;++n){if(!this.rewardVals[n]||0==this.rewardVals[n])return;this.GetReward(this.rewardTypes[n],this.rewardVals[n],t)}this.rewardMethod=r.RewardMethodEnum.NONE,this.callback&&this.callback(t),c.default.instance.closeView(this.node.name,!1)},t.prototype.GetReward=function(e,t,n){var o=t*n;switch(e){case a.OXY:var i=p.default.transRelativeFromPos(this.coinItem,this.coinItem.getChildByName("Icon").position);s.default.instance.effectEco(o,s.EconomicTypeEnum.COIN,10,i),u.default.instance.ShowPopupEcoNum(cc.Vec2.ZERO,s.EconomicTypeEnum.COIN,"+"+s.default.instance.number2UnitFormat(o));break;case a.DIAMOND:i=p.default.transRelativeFromPos(this.diamondItem,this.diamondItem.getChildByName("Icon").position);s.default.instance.effectEco(o,s.EconomicTypeEnum.DIAMOND,10,i),u.default.instance.ShowPopupEcoNum(cc.Vec2.ZERO,s.EconomicTypeEnum.DIAMOND,"+"+o)}},__decorate([y(cc.Button)],t.prototype,"rewardBtn",void 0),__decorate([y(cc.Button)],t.prototype,"videoBtn",void 0),__decorate([y(cc.Node)],t.prototype,"coinItem",void 0),__decorate([y(cc.Label)],t.prototype,"coinTxt",void 0),__decorate([y(cc.Node)],t.prototype,"diamondItem",void 0),__decorate([y(cc.Label)],t.prototype,"diamondTxt",void 0),__decorate([y(cc.Node)],t.prototype,"otherItem",void 0),__decorate([y({type:cc.Label,displayName:"\u6807\u9898\u6587\u5b57"})],t.prototype,"title",void 0),__decorate([y({type:cc.Label,displayName:"\u63cf\u8ff0\u6587\u5b571"})],t.prototype,"desc",void 0),__decorate([y({type:cc.Label,displayName:"\u63cf\u8ff0\u6587\u5b572"})],t.prototype,"desc2",void 0),__decorate([y({type:cc.Label,displayName:"\u63cf\u8ff0\u6587\u5b573"})],t.prototype,"desc3",void 0),__decorate([y({type:cc.Node,displayName:"\u9875\u9762"})],t.prototype,"view",void 0),__decorate([y({type:cc.SpriteFrame,tooltip:"\u5956\u52b1\u7c7b\u578b\u56fe\u6807"})],t.prototype,"typeIcons",void 0),t=__decorate([m],t)}(o.default);n.default=v,cc._RF.pop()},{"../../Common/CommonUils":"CommonUils","../../Core/GameHelper":"GameHelper","../../Core/RewardLogic":"RewardLogic","../../Core/ShareLogic":"ShareLogic","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../Base/View":"View","../UIManager":"UIManager"}],Server:[function(e,t,n){"use strict";cc._RF.push(t,"26080ZucM9NH6PS2jaeZDC9","Server"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("./GameHelper"),o=function(){function e(){}return e.GetData=function(e,t){var n=this;if(void 0===t&&(t=null),SDK._checkWx(t,null,"request")){this.getUserIdOrCode(this.data_user_id,function(o){o.game_id=SDK.game_id,o.type="get",void 0!==window.qq&&(o.login_type="qq"),a.default.Log("retrieve data",o),wx.request({url:"https://reada.xiaoyouxiqun.com/data.php",header:{},method:"GET",data:o,success:function(o){n.time=new Date(o.header.Date).getTime(),a.default.Log("\u670d\u52a1\u5668\u65f6\u95f4 == ",n.time),0==o.data.code?(o.data.user_id&&(n.data_user_id=o.data.user_id,a.default.Log("this.data_user_id == ",n.data_user_id)),a.default.Log("\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u6570\u636e\u6210\u529f",o),e&&e(o.data.info)):(a.default.Log("\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u6570\u636e\u5931\u8d25",o),t&&t(o))},fail:function(e){a.default.Log("Request to get data from the service failed",e),e&&e.header&&e.header.Date&&(n.time=new Date(e.header.Date).getTime(),a.default.Log("\u670d\u52a1\u5668\u65f6\u95f4 == ",n.time)),t&&t(e)},complete:null})},t)}},e.saveData=function(e,t,n){var o=this;if(void 0===n&&(n=null),SDK._checkWx(n,null,"request")){this.getUserIdOrCode(this.data_user_id,function(i){i.game_id=SDK.game_id,i.type="put",i.info=e,void 0!==window.qq&&(i.login_type="qq"),a.default.Log("save data"),a.default.Log(i),wx.request({url:"https://leviathan.xiaoyouxiqun.com/data.php",header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},method:"POST",data:i,success:function(e){o.time=new Date(e.header.Date).getTime(),0==e.data.code?(a.default.Log("\u4fdd\u5b58\u6570\u636e\u5230\u670d\u52a1\u5668\u6210\u529f",e),t&&t(e.data)):(a.default.Log("\u4fdd\u5b58\u6570\u636e\u5230\u670d\u52a1\u5668\u5931\u8d25",e),n&&n(e))},fail:function(e){a.default.Log("\u8bf7\u6c42\u4fdd\u5b58\u6570\u636e\u5230\u670d\u52a1\u5668\u5931\u8d25"),e&&e.header&&e.header.Date&&(o.time=new Date(e.header.Date).getTime(),a.default.Log("\u670d\u52a1\u5668\u65f6\u95f4 == ",o.time)),n&&n(e)},complete:null})},n)}},e.wxLoginAndGetInfo=function(e,t){void 0===t&&(t=null),wx.login({success:function(n){var a=n.code;cc.log("login code: "+n.code),SDK.getUserInfo(function(t){cc.log("\u83b7\u53d6\u5fae\u4fe1\u7528\u6237\u4fe1\u606f\u6210\u529f",JSON.stringify(t));var n={code:a,iv:t.iv,rawData:t.rawData,encryptedData:t.encryptedData,signature:t.signature};e(n)},function(e){cc.log("\u83b7\u53d6\u5fae\u4fe1\u7528\u6237\u4fe1\u606f\u5931\u8d25",JSON.stringify(e)),t&&t(e)},null)},fail:function(e){cc.log("\u8bf7\u6c42\u767b\u5f55\u5fae\u4fe1\u5931\u8d25",JSON.stringify(e)),t&&t(e)},complete:function(){}})},e.wxLogin=function(e,t){void 0===t&&(t=null),wx.login({success:function(t){var n=t.code;cc.log("login code: "+t.code),e&&e({code:n})},fail:function(e){cc.log("\u8bf7\u6c42\u767b\u5f55\u5fae\u4fe1\u5931\u8d25:",e),t&&t(e)},complete:null})},e.submitLeaderboard=function(e,t,n){void 0===n&&(n=null),a.default.Log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c:"+e),this.wxLoginAndGetInfo(function(o){o.game_id=SDK.game_id,o.score=e,void 0!==window.qq&&(o.login_type="qq"),a.default.Log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c:",o),wx.request({url:"https://leaderboard.xiaoyouxiqun.com/submit.php",header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},method:"POST",data:o,success:function(e){e&&e.data&&0==e.data.code?(a.default.Log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c\u6210\u529f:",e),t&&t(e)):(a.default.Log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c\u5931\u8d251:",e),n&&n(e))},fail:function(e){a.default.Log("\u4fdd\u5b58\u6210\u7ee9\u5230\u4e16\u754c\u6392\u884c\u699c\u5931\u8d252:",e),n&&n(e)}})},function(e){n&&n(e)})},e.getLeaderboard=function(e,t){void 0===t&&(t=null),cc.log("\u5f00\u59cb\u62c9\u53d6\u4e16\u754c\u6392\u884c\u699c");this.wxLogin(function(n){n.game_id=SDK.game_id,void 0!==window.qq&&(n.login_type="qq"),cc.log("\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c\uff08requestdata\uff09:"+n),wx.request({url:"https://leaderboard.xiaoyouxiqun.com/get.php",header:{},method:"GET",data:n,success:function(n){n&&n.data&&0==n.data.code?(cc.log("\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c\u6210\u529f:"+n),e&&e(n)):(cc.log("\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c\u5931\u8d25:"+n),t&&t(n))},fail:function(e){cc.log("\u8bf7\u6c42\u83b7\u53d6\u4e16\u754c\u6392\u884c\u699c\u5931\u8d25:"+e),t&&t(e)}})},t)},e.getUserIdOrCode=function(e,t,n){var a=this;void 0===n&&(n=null),e?wx.checkSession({success:function(n){cc.log("\u767b\u5f55\u672a\u8d85\u65f6\uff0c\u4f7f\u7528\u672c\u5730user_id"),t({user_id:e})},fail:function(e){cc.log("\u767b\u5f55\u8d85\u65f6\uff0c\u91cd\u65b0\u5fae\u4fe1\u767b\u5f55"),a.wxLogin(t,n)},complete:null}):(cc.log("\u672c\u5730\u65e0user_id\uff0c\u4f7f\u7528\u5fae\u4fe1\u767b\u5f55\u83b7\u53d6code"),this.wxLogin(t,n))},e.reportAppid=function(e,t,n){var o=this;if(void 0===n&&(n=null),SDK._checkWx(n,null,"request")){this.getUserIdOrCode(this.report_user_id,function(i){var r=wx.getLaunchOptionsSync(),c="",s="";r.referrerInfo&&r.referrerInfo.appId&&(c=r.referrerInfo.appId),r.query&&r.query.cid&&(s=r.query.cid),i.game_id=SDK.game_id,i.app_id=c,i.auth_flag=e,i.channel_id=s,i.version=SDK.game_version,void 0!==window.qq&&(i.login_type="qq"),a.default.Log("Report sourceappid:",i),wx.request({url:"https://statistics.xiaoyouxiqun.com/report.php",data:i,method:"GET",header:{},success:function(e){a.default.Log("Report sourceappidsuccess",e),e&&e.data&&e.data.user_id&&(o.report_user_id=e.data.user_id,a.default.Log("this.report_user_id == ",o.report_user_id)),t&&t()},fail:function(e){a.default.Log("Request report sourceappidfailure:",e),n&&n()}})},n)}},e.getServerDate=function(e){var t=this;if(SDK._checkWx(function(){e&&e(-1)},null,"request")){var n=function(n){n&&n.header&&n.header.Date?(t.time=new Date(n.header.Date).getTime(),cc.log("\u670d\u52a1\u5668\u65f6\u95f4 == ",t.time),e&&e(t.time)):(t.time=-1,e&&e(-1))};wx.request({url:"https://reada.xiaoyouxiqun.com/time.html?t="+(new Date).getTime(),header:{},method:"GET",success:function(e){n(e)},fail:function(e){n(e)}})}},e.saveServerTime=function(e){e&&e.header&&e.header.Date&&(this.time=new Date(e.header.Date).getTime(),a.default.Log("\u670d\u52a1\u5668\u65f6\u95f4 == ",this.time))},e.reportEvent=function(e,t,n){var o=this;if(void 0===n&&(n=null),SDK._checkWx(n,null,"request")){this.getUserIdOrCode(this.data_user_id,function(n){n.os=SDK.sys.platform,n.game_id=SDK.game_id,n.tag=e,n.page=t,void 0!==window.qq&&(n.login_type="qq"),a.default.Log("Submit parameters:",n);wx.request({url:"https://report.xiaoyouxiqun.com/report_click.php",header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},method:"POST",data:n,success:function(e){a.default.Log("Event reported successfully",e),e&&e.data&&e.data.user_id&&(o.data_user_id=e.data.user_id)},fail:function(e){a.default.Log("Incident reporting failed:",e)},complete:null})},n)}},e.time=-1,e.data_user_id=null,e}();n.default=o,cc._RF.pop()},{"./GameHelper":"GameHelper"}],ShareLogic:[function(e,t,n){"use strict";cc._RF.push(t,"79101N3ZIZBH5npyWvfaIZI","ShareLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("./RewardLogic"),o=e("./GameHelper"),i=e("./MathUtil");void 0!==window.qq?n.ShareTypeEnum={NONE:0,SYSTEM:508,SHARE:509,FLAUNT:510,GROUP:516,SPEEDUP:511,OFFLINE:512,SIGNIN:513,LEVELUP:514,PHOTOSYNTHESIS:515,PLANTMAXLV:517}:n.ShareTypeEnum={NONE:0,SYSTEM:294,SHARE:295,FLAUNT:296,GROUP:308,SPEEDUP:297,OFFLINE:298,SIGNIN:299,LEVELUP:300,PHOTOSYNTHESIS:301,PLANTMAXLV:309};var r=function(){function e(){this.shareCanceled=!1,this.localShare={System:{titleArr:[],picArr:[],query:{src:"system"}},Main:{titleArr:[],picArr:[],query:{src:"main"}},Flaunt:{titleArr:["I unlocked$n\uff0cLet's appreciate it together!!!!!"],picArr:[],query:{src:"flaunt"}},Speedup:{titleArr:[],picArr:[],query:{src:"speedup"}},Offline:{titleArr:[],picArr:[],query:{src:"offline"}},Signin:{titleArr:[],picArr:[],query:{src:"signin"}},Levelup:{titleArr:[],picArr:[],query:{src:"levelup"}},Plantmaxlv:{titleArr:[],picArr:[],query:{src:"plantmaxlv"}},Photosynthesis:{titleArr:[],picArr:[],query:{src:"photosynthesis"}},defaultTitle:"Shock!I actually planted\u2026\u2026",defaultPic:"res2/share.jpg",getRandTitle:function(e){if(!this[e]||!this[e].titleArr||0==this[e].titleArr.length)return this.defaultTitle;var t=this[e].titleArr;return t[i.default.RandomInt(0,t.length-1)]},getRandPic:function(e){if(!this[e]||!this[e].picArr||0==this[e].picArr.length)return this.defaultPic;var t=this[e].picArr;return t[i.default.RandomInt(0,t.length-1)]},getQuery:function(e){return this[e]&&this[e].query?this[e].query:{}}},this.fakeShareFailTimes=0}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.Share=function(e,t,i,r){var c=this;void 0===t&&(t=null),void 0===i&&(i=null),void 0===r&&(r=null);var s=null==t?this.GetShareConfig(e):t;o.default.Log("\u5206\u4eab\u914d\u7f6e:",s),e==n.ShareTypeEnum.SYSTEM?(SDK.onShare(s.title,s.pic,s.queryStr,null,null,null),o.default.IsQQ&&SDK.onShareWithCallback(function(){a.default.instance.CalcSuccShareTimes()})):(this.shareCanceled=!1,SDK.share(s.title,s.pic,s.queryStr,null,null,null,function(){o.default.Log("Cancelled callback"),SDK.conf.share_use_cancel>-1&&(c.shareCanceled=!0)}),o.default.IsQQ&&a.default.instance.CalcSuccShareTimes(),(i||r)&&this.fakeShareCallback(i,function(n){SDK.showModal("Failed!",n,function(n){n.confirm&&c.Share(e,t,i,r)},function(){}),r&&r()}))},e.prototype.GetShareConfig=function(e){var t,n,a,o=this.GetShareName(e),i=this.localShare.getQuery(o),r=SDK.getShareConfig(e);return r?(t=r.share_text,n=r.share_pic_local,a=r.share_id):(t=this.localShare.getRandTitle(o),n=this.localShare.getRandPic(o),a=-1),i.position_id=e,i.share_id=a,{title:t,pic:n,queryStr:this.GenerateQuery(i)}},e.prototype.GetShareName=function(e){switch(e){case n.ShareTypeEnum.SYSTEM:return"System";case n.ShareTypeEnum.SHARE:return"Main";case n.ShareTypeEnum.FLAUNT:return"Flaunt";case n.ShareTypeEnum.SPEEDUP:return"Speedup";case n.ShareTypeEnum.OFFLINE:return"Offline";case n.ShareTypeEnum.SIGNIN:return"Signin";case n.ShareTypeEnum.LEVELUP:return"Levelup";case n.ShareTypeEnum.PHOTOSYNTHESIS:return"Photosynthesis";case n.ShareTypeEnum.PLANTMAXLV:return"Plantmaxlv"}return""},e.prototype.GenerateQuery=function(e){var t="";for(var n in e)t+=n+"="+e[n]+"&";return t+="sid="+this.GenerateUUID()+"&t="+(new Date).getTime()},e.prototype.GenerateUUID=function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);var n=4294967295*Math.random()|0,a=4294967295*Math.random()|0,o=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(e[255&n]+e[n>>8&255]+e[n>>16&255]+e[n>>24&255]+"-"+e[255&a]+e[a>>8&255]+"-"+e[a>>16&15|64]+e[a>>24&255]+"-"+e[63&o|128]+e[o>>8&255]+"-"+e[o>>16&255]+e[o>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()},e.prototype.fakeShareCallback=function(e,t){var n=this,i=(new Date).getTime();o.default.Log("\u6267\u884c\u4f2a\u5206\u4eab\u56de\u8c03"),SDK.onShow("fakeshare",function(r){SDK.offShow("fakeshare");var c=((new Date).getTime()-i)/1e3,s=!1;c<SDK.conf.fake_share_gap&&(s=!0),setTimeout(function(){var i;o.default.Log("\u5206\u4eab\u56de\u8c03:Background return time:"+c+"\uff0cValue:"+SDK.conf.fake_share_gap),i=void 0===SDK.conf.fake_share_fail_ratio_list?["0"]:String(SDK.conf.fake_share_fail_ratio_list).split(",");var r=parseInt(i[Math.min(n.fakeShareFailTimes,i.length-1)]);if(n.shareCanceled||s)t&&t(SDK.conf.share_time_toast);else{var l=100*Math.random();o.default.Log("\u5206\u4eab\u56de\u8c03:Random repetition probability:"+l+"\uff0cFirst"+n.fakeShareFailTimes+"Failed\uff0cThe probability of failure is"+r),l<r?(t&&t(SDK.conf.share_group_toast),++n.fakeShareFailTimes):(e&&setTimeout(function(){e()},1e3),o.default.Log("\u5206\u4eab\u6210\u529f"),o.default.IsQQ||a.default.instance.CalcSuccShareTimes(),n.fakeShareFailTimes=0)}},50)},-1)},e}();n.default=r,cc._RF.pop()},{"./GameHelper":"GameHelper","./MathUtil":"MathUtil","./RewardLogic":"RewardLogic"}],ShopItem:[function(e,t,n){"use strict";cc._RF.push(t,"3107ftwgpBGj4yAknDz8BHK","ShopItem"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../../Logic/GardenLogic"),i=e("../../Core/GameHelper"),r=e("../../Logic/EconomicLogic"),c=e("../../Sound/SoundClip"),s=e("../../Sound/SoundManager"),l=e("../UIManager"),d=e("./ShopView"),u=e("../../Common/CommonUils"),p=e("../../Logic/ShopLogic"),f=e("../../Data/GardenData"),h=e("../../Core/Server"),g=e("../../Common/ReportEventID");(function(e){e[e.BUYOXY=0]="BUYOXY",e[e.ADDPRODUCT=1]="ADDPRODUCT"})(a||(a={}));var m=cc._decorator,y=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.oxyNum=0,t.oxyPrice=0,t.desc=null,t.desc2=null,t.price=null,t.icon=null,t.txt=null,t.purchaseBtn=null,t.curType=a.BUYOXY,t}return __extends(t,e),t.prototype.start=function(){this.Init(),this.AddEvents()},t.prototype.onEnable=function(){this.RefreshStr()},t.prototype.RefreshStr=function(){switch(this.curType){case a.ADDPRODUCT:f.default.data.level<p.default.instance.addProductTimes*p.default.instance.addProductPerLevel?(this.icon.node.active=!1,this.price.node.active=!1,this.txt&&(this.txt.node.active=!0,this.txt.string="Need lv "+p.default.instance.addProductTimes*p.default.instance.addProductPerLevel)):(this.icon.node.active=!0,this.price.node.active=!0,this.txt&&(this.txt.node.active=!1));break;case a.BUYOXY:this.desc2.string="\uff08Available"+r.default.instance.number2UnitFormat(o.default.instance.GainProduct(60*this.oxyNum*60))+"oxygen\uff09"}},t.prototype.Init=function(){switch(this.curType){case a.BUYOXY:if(this.oxyNum<24)this.desc.string="buy"+this.oxyNum+"Hourly earnings";else{var e=Math.floor(this.oxyNum/24);this.desc.string="buy"+e+"Day income"}break;case a.ADDPRODUCT:this.desc.string="Permanent production doubled",this.desc2.string=(0==p.default.instance.addProductTimes?1:p.default.instance.addProductTimes*this.oxyNum)+"Times->"+(p.default.instance.addProductTimes+1)*this.oxyNum+"Times"}this.price.string=this.oxyPrice.toString()},t.prototype.AddEvents=function(){this.purchaseBtn.node.on(cc.Node.EventType.TOUCH_END,this.OnPurchaseBtnTap,this)},t.prototype.OnPurchaseBtnTap=function(e){if(s.default.instance.playAudioClip(c.SoundClipType.click),!(r.default.instance.diamond<this.oxyPrice)){switch(this.curType){case a.BUYOXY:r.default.instance.diamond-=this.oxyPrice;var t=o.default.instance.GainProduct(60*this.oxyNum*60),n=u.default.transRelativeFromPos(this.node,this.icon.node.position);r.default.instance.effectEco(t,r.EconomicTypeEnum.COIN,10,n),i.default.Log("Purchased oxygen:"+t),o.default.instance.ShowPopupEcoNum(cc.Vec2.ZERO,r.EconomicTypeEnum.COIN,"+"+r.default.instance.number2UnitFormat(t));break;case a.ADDPRODUCT:if(f.default.data.level<p.default.instance.addProductTimes*p.default.instance.addProductPerLevel)return;r.default.instance.diamond-=this.oxyPrice,p.default.instance.addProductTimes++,p.default.instance.SaveAddProductTimes(),this.desc2.string=(0==p.default.instance.addProductTimes?1:p.default.instance.addProductTimes*this.oxyNum)+"Times->"+(p.default.instance.addProductTimes+1)*this.oxyNum+"Times",h.default.reportEvent(g.default.shop_buy_addproduct,g.default.def_page),d.default.instance.RefreshBtnDesc()}l.default.instance.GetView(l.ViewName.ShopView,function(e){e.RefreshBtns()})}},t.prototype.RefreshDiamond=function(){switch(this.curType){case a.BUYOXY:r.default.instance.diamond<this.oxyPrice?(this.purchaseBtn.interactable=!1,this.purchaseBtn.node.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.GRAY)):(this.purchaseBtn.interactable=!0,this.purchaseBtn.node.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL));break;case a.ADDPRODUCT:r.default.instance.diamond<this.oxyPrice||f.default.data.level<p.default.instance.addProductTimes*p.default.instance.addProductPerLevel?(this.purchaseBtn.interactable=!1,this.purchaseBtn.node.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.GRAY)):(this.purchaseBtn.interactable=!0,this.purchaseBtn.node.getChildByName("Icon").getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL))}},__decorate([v({type:cc.Integer,displayName:"\u8d2d\u4e70\u7684\u6570\u91cf"})],t.prototype,"oxyNum",void 0),__decorate([v({type:cc.Integer,displayName:"\u8d2d\u4e70\u8be5\u5546\u54c1\u7684\u4ef7\u683c"})],t.prototype,"oxyPrice",void 0),__decorate([v({type:cc.Label,displayName:"\u63cf\u8ff0"})],t.prototype,"desc",void 0),__decorate([v({type:cc.Label,displayName:"\u63cf\u8ff02"})],t.prototype,"desc2",void 0),__decorate([v({type:cc.Label,displayName:"\u4ef7\u683c"})],t.prototype,"price",void 0),__decorate([v({type:cc.Sprite,displayName:"\u56fe\u6807"})],t.prototype,"icon",void 0),__decorate([v({type:cc.Label,displayName:"\u6587\u672c"})],t.prototype,"txt",void 0),__decorate([v({type:cc.Button,displayName:"\u8d2d\u4e70\u6309\u94ae"})],t.prototype,"purchaseBtn",void 0),__decorate([v({type:cc.Enum(a),displayName:"\u5546\u54c1\u9879\u7c7b\u578b"})],t.prototype,"curType",void 0),t=__decorate([y],t)}(cc.Component);n.default=_,cc._RF.pop()},{"../../Common/CommonUils":"CommonUils","../../Common/ReportEventID":"ReportEventID","../../Core/GameHelper":"GameHelper","../../Core/Server":"Server","../../Data/GardenData":"GardenData","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../../Logic/ShopLogic":"ShopLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../UIManager":"UIManager","./ShopView":"ShopView"}],ShopLogic:[function(e,t,n){"use strict";cc._RF.push(t,"21323aVJmVBSbwhC3+uOZk+","ShopLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Core/DataStorage"),o=e("../Common/DataID"),i=function(){function e(){this.addProductTimes=0,this.addProductRatio=2,this.addProductPerLevel=30}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.SaveAddProductTimes=function(){a.default.setItem(o.default.addProductTimes,this.addProductTimes)},e.prototype.LoadAddProductTimes=function(){this.addProductTimes=a.default.getIntItem(o.default.addProductTimes,0),console.log("\u8bfb\u53d6\u4ea7\u80fd\u52a0\u6210\u6b21\u6570:"+this.addProductTimes)},e}();n.default=i,cc._RF.pop()},{"../Common/DataID":"DataID","../Core/DataStorage":"DataStorage"}],ShopView:[function(e,t,n){"use strict";cc._RF.push(t,"33ee1giGDFBZZN6emExvEOP","ShopView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("./ShopItem"),i=cc._decorator,r=i.ccclass,c=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shopItems=[],t.scrollView=null,t.content=null,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.prototype.start=function(){n.MinDiamond=this.shopItems[0].oxyPrice},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),n._instance=this},t.prototype.onEnable=function(){e.prototype.onEnable.call(this),this.RefreshBtns()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.RefreshBtns=function(){for(var e=0;e<this.shopItems.length;++e)this.shopItems[e].RefreshDiamond()},t.prototype.RefreshBtnDesc=function(){for(var e=0;e<this.shopItems.length;++e)this.shopItems[e].RefreshStr()},t.prototype.DelayResetWidget=function(){this.scheduleOnce(this.ResetWidget,1)},t.prototype.ResetWidget=function(){this.node.getComponent(cc.Widget).updateAlignment();var e=this.node.getChildByName("Win");e.getComponent(cc.Widget).updateAlignment(),e.getChildByName("Title").getComponent(cc.Widget).updateAlignment(),this.scrollView.parent.getComponent(cc.Widget).updateAlignment(),this.scrollView.getComponent(cc.Widget).updateAlignment(),this.content.parent.getComponent(cc.Widget).updateAlignment(),this.content.getComponent(cc.Widget).updateAlignment()},t.MinDiamond=20,__decorate([c({type:o.default,tooltip:"\u8d2d\u4e70\u9879"})],t.prototype,"shopItems",void 0),__decorate([c({type:cc.Node,displayName:"\u5212\u52a8\u5bb9\u5668"})],t.prototype,"scrollView",void 0),__decorate([c({type:cc.Node,displayName:"\u5185\u5bb9"})],t.prototype,"content",void 0),t=n=__decorate([r],t)}(a.default);n.default=s,cc._RF.pop()},{"../Base/View":"View","./ShopItem":"ShopItem"}],SignInData:[function(e,t,n){"use strict";cc._RF.push(t,"f5eb8Vemn5DlK6ynf61Zw/N","SignInData"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Core/DataStorage"),o=e("../Common/DataID"),i=cc._decorator,r=i.ccclass,c=(i.property,function(){function e(){this.loginTimes=0,this.signInDay=[0,0,0,0,0,0,0]}var t;return t=e,Object.defineProperty(e,"data",{get:function(){if(null==this._data){var e=a.default.getItem(o.default.signInData);e&&(this._data=JSON.parse(e)),this._data||(this._data=new t)}return this._data},enumerable:!0,configurable:!0}),e.SetData=function(e){this._data=e,this.SaveData()},e.SaveData=function(){this._data&&a.default.setItem(o.default.signInData,JSON.stringify(this._data))},e=t=__decorate([r],e)}());n.default=c,cc._RF.pop()},{"../Common/DataID":"DataID","../Core/DataStorage":"DataStorage"}],SignInItem:[function(e,t,n){"use strict";cc._RF.push(t,"8420fasELZO4Y5v0GL2OJPz","SignInItem"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=cc._decorator,i=o.ccclass,r=o.property;(function(e){e[e.NONE=0]="NONE",e[e.WAIT=1]="WAIT",e[e.GET=2]="GET"})(a=n.SignInItemStateEnum||(n.SignInItemStateEnum={}));var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stateArr=[],t.diamondValueTxt=null,t.goldValueTxt=null,t.diamondValue=0,t.goldValue=0,t.isEnd=!1,t.day=0,t}return __extends(t,e),t.prototype.start=function(){this.diamondValue>0&&(this.diamondValueTxt.string="+"+this.diamondValue)},t.prototype.refresh=function(e){for(var t=0;t<this.stateArr.length;t++)this.stateArr[t].active=t==e;e==a.NONE?this.node.getChildByName("Mask").active=!0:(a.WAIT,this.node.getChildByName("Mask").active=!1)},__decorate([r(cc.Node)],t.prototype,"stateArr",void 0),__decorate([r(cc.Label)],t.prototype,"diamondValueTxt",void 0),__decorate([r(cc.Label)],t.prototype,"goldValueTxt",void 0),__decorate([r(cc.Integer)],t.prototype,"diamondValue",void 0),__decorate([r(cc.Integer)],t.prototype,"goldValue",void 0),__decorate([r(cc.Boolean)],t.prototype,"isEnd",void 0),__decorate([r(cc.Integer)],t.prototype,"day",void 0),t=__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{}],SignInView:[function(e,t,n){"use strict";cc._RF.push(t,"134bdn50ORDx6MY2WzevGXP","SignInView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("./SignInItem"),i=e("../UIManager"),r=e("../../Data/SignInData"),c=e("../../Core/ShareLogic"),s=e("../../Sound/SoundManager"),l=e("../../Sound/SoundClip"),d=e("../Reward/RewardView"),u=e("../../Core/RewardLogic"),p=cc._decorator,f=p.ccclass,h=p.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemList=[],t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){for(var e=this,t=function(t){var a=n.itemList[t];a.stateArr[1].on(cc.Node.EventType.TOUCH_END,function(t){s.default.instance.playAudioClip(l.SoundClipType.click),1==r.default.data.signInDay[a.day-1]&&a.diamondValue>0&&e.GetSigninReward(d.RewardTypeEnum.DIAMOND,a.diamondValue,function(){r.default.data.signInDay[a.day-1]=2,r.default.SaveData(),e.refreshView()})},n)},n=this,a=0;a<this.itemList.length;a++)t(a)},t.prototype.GetSigninReward=function(e,t,n){var a=new d.RewardData;a.rewardMethod=u.default.instance.ShareOrVideo(c.ShareTypeEnum.SIGNIN),a.shareType=c.ShareTypeEnum.SIGNIN,a.rewardTypes=[e],a.rewardVals=[t],a.ratio=2,a.title="Sign-in reward",a.callback=n,i.default.instance.OpenView(i.ViewName.RewardView,function(e){e.init(a)})},t.prototype.open=function(){e.prototype.open.call(this),this.refreshView()},t.prototype.refreshView=function(){for(var e=r.default.data,t=0;t<this.itemList.length;t++){this.itemList[t].refresh(e.signInDay[t])}},__decorate([h(o.default)],t.prototype,"itemList",void 0),t=__decorate([f],t)}(a.default);n.default=g,cc._RF.pop()},{"../../Core/RewardLogic":"RewardLogic","../../Core/ShareLogic":"ShareLogic","../../Data/SignInData":"SignInData","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../Base/View":"View","../Reward/RewardView":"RewardView","../UIManager":"UIManager","./SignInItem":"SignInItem"}],SoundClip:[function(e,t,n){"use strict";cc._RF.push(t,"fe7b4FtJWRPL4N7yBtkCip/","SoundClip"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=cc._decorator,i=o.ccclass,r=o.property;(function(e){e[e.none=0]="none",e[e.click=1]="click",e[e.close=2]="close",e[e.pick=3]="pick",e[e.autopick=4]="autopick",e[e.water1=5]="water1",e[e.water2=6]="water2",e[e.water3=7]="water3",e[e.water4=8]="water4",e[e.water5=9]="water5",e[e.water6=10]="water6",e[e.water7=11]="water7",e[e.water8=12]="water8",e[e.water9=13]="water9",e[e.diamond=14]="diamond"})(a=n.SoundClipType||(n.SoundClipType={}));var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clipName="",t.type=a.none,t.clip=null,t}return __extends(t,e),__decorate([r(cc.String)],t.prototype,"clipName",void 0),__decorate([r({type:cc.Enum(a)})],t.prototype,"type",void 0),__decorate([r({type:cc.AudioClip})],t.prototype,"clip",void 0),t=__decorate([i],t)}(cc.Component);n.default=c,cc._RF.pop()},{}],SoundManager:[function(e,t,n){"use strict";cc._RF.push(t,"61ea7gw6m5BUoE3mKLIxlki","SoundManager"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("./BgSoundClip"),o=e("../Core/GameHelper"),i=e("./SoundClip"),r=e("../Data/GameData"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgAS=null,t.audios=[],t.sounds={},t.bgSoundSrc=null,t.bgSoundDic={},t.lastBgSound=a.BgSoundClipType.none,t.mute=!1,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance,n._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n._instance?this.node.destroy():(n._instance=this,cc.game.addPersistRootNode(this.node),this.init())},t.prototype.init=function(){for(var e=this.bgSoundSrc.children,t=0;t<e.length;t++){var n=e[t].getComponent(a.default);this.bgSoundDic[n.type]=n}this.InitWxAllSound()},t.prototype.pause=function(){this.mute=!0,r.default.data.mute=1,cc.audioEngine.pauseAll(),this.bgAS.stop()},t.prototype.resume=function(){this.mute=!1,r.default.data.mute=0,cc.audioEngine.resumeAll(),this.bgAS.play()},t.prototype.PlayBGSound=function(e,t){void 0===t&&(t=!0),this.lastBgSound==a.BgSoundClipType.none&&(this.lastBgSound=e),this.bgAS.stop(),this.bgAS.loop=t,this.bgAS.clip=this.getBGSoundClip(e),this.mute||this.bgAS.play()},t.prototype.getBGSoundClip=function(e){return this.bgSoundDic[e]?this.bgSoundDic[e].clip:(o.default.Log("No background sound source ",a.BgSoundClipType[e]),null)},t.prototype.InitWxAllSound=function(){"undefined"!=typeof wx&&(this.InitWxAudio(i.SoundClipType.click,5),this.InitWxAudio(i.SoundClipType.close,3),this.InitWxAudio(i.SoundClipType.autopick))},t.prototype.InitWxAudio=function(e,t){if(void 0===t&&(t=1),!this.sounds[e]){this.sounds[e]={cur:0,num:t};var n="";n=cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(this.audios[e-1].nativeUrl):this.audios[e-1].toString(),wx.env&&(n=wx.env.USER_DATA_PATH+"/"+n);for(var a=0;a<t;++a)this.sounds[e][a]=wx.createInnerAudioContext(),this.sounds[e][a].src=n,this.sounds[e][a].obeyMuteSwitch=!0}},t.prototype.playWxAudio=function(e,t,n){if(void 0===t&&(t=1),void 0===n&&(n=0),!this.mute&&this.sounds[e]){var a=(this.sounds[e].cur+1)%this.sounds[e].num;this.sounds[e].cur=a,this.sounds[e][a].play()}},t.prototype.playAudioClip=function(e){this.mute||this.playWxAudio(e)},t.prototype.playAudioClip2=function(e,t){if(void 0===t&&(t=!1),!this.mute){var n=this.audios[e-1];return null!=n?cc.audioEngine.play(n,t,1):(cc.log("Resource not foundidfor ",e," PlayOtherSoundSound configuration"),0)}},t.prototype.stopAudioClip=function(e){cc.audioEngine.stop(e)},__decorate([l(cc.AudioSource)],t.prototype,"bgAS",void 0),__decorate([l({type:[cc.Asset]})],t.prototype,"audios",void 0),__decorate([l(cc.Node)],t.prototype,"bgSoundSrc",void 0),t=n=__decorate([s],t)}(cc.Component);n.default=d,cc._RF.pop()},{"../Core/GameHelper":"GameHelper","../Data/GameData":"GameData","./BgSoundClip":"BgSoundClip","./SoundClip":"SoundClip"}],StoreItem:[function(e,t,n){"use strict";cc._RF.push(t,"f9fc0bzZfBFz5e0mAOCXqCg","StoreItem"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Core/ResourcesManager"),o=e("../../Common/DataManager"),i=e("../../Logic/PlantLogic"),r=e("../UIManager"),c=e("../../Sound/SoundManager"),s=e("../../Sound/SoundClip"),l=e("../../Logic/GardenLogic"),d=e("../Garden/Garden"),u=cc._decorator,p=u.ccclass,f=u.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.index=-1,t.icon=null,t.nameTxt=null,t.levelTxt=null,t.productTxt=null,t.placeBtn=null,t}return __extends(t,e),t.prototype.start=function(){this.AddEvents()},t.prototype.AddEvents=function(){this.placeBtn.on(cc.Node.EventType.TOUCH_END,this.OnPlaceBtnTap,this)},t.prototype.OnPlaceBtnTap=function(e){c.default.instance.playAudioClip(s.SoundClipType.click),d.default.instance.CheckShelfFull()?r.default.instance.OpenView(r.ViewName.ConfirmView,function(e){e.Init({desc:"Shelf is full\uff0cNeed to be sorted immediately",confirmStr:"sort out",callback:function(){r.default.instance.closeView(r.ViewName.StoreView)}})}):(r.default.instance.closeView(r.ViewName.StoreView),l.default.instance.ToStoreMode(this.index))},t.prototype.Init=function(e,t){var n=this;this.index=e;var r=o.default.instance.GetPlantConfig(t.id);this.nameTxt.string=r.name,this.levelTxt.string="lv:"+t.level,this.productTxt.string="Yield:"+t.product*i.default.instance.GetProductRatio(),a.default.instance.load(r.res,function(e){n.icon.spriteFrame=e},cc.SpriteFrame,!1,!1,i.default.instance.IconRoot)},__decorate([f({type:cc.Sprite,displayName:"\u690d\u7269\u56fe\u6807"})],t.prototype,"icon",void 0),__decorate([f({type:cc.Label,displayName:"\u540d\u5b57\u6587\u672c"})],t.prototype,"nameTxt",void 0),__decorate([f({type:cc.Label,displayName:"\u7b49\u7ea7\u6587\u672c"})],t.prototype,"levelTxt",void 0),__decorate([f({type:cc.Label,displayName:"\u4ea7\u91cf\u6587\u672c"})],t.prototype,"productTxt",void 0),__decorate([f({type:cc.Node,displayName:"\u653e\u7f6e\u6309\u94ae"})],t.prototype,"placeBtn",void 0),t=__decorate([p],t)}(cc.Component);n.default=h,cc._RF.pop()},{"../../Common/DataManager":"DataManager","../../Core/ResourcesManager":"ResourcesManager","../../Logic/GardenLogic":"GardenLogic","../../Logic/PlantLogic":"PlantLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../Garden/Garden":"Garden","../UIManager":"UIManager"}],StoreView:[function(e,t,n){"use strict";cc._RF.push(t,"a6227ZCGoJFjK9ce+aw5neO","StoreView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("./StoreItem"),i=e("../../Data/GardenData"),r=e("../../Core/ResourcesManager"),c=e("../../Common/PrefabID"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.content=null,t._isInit=!1,t.items=[],t.scrollCount=0,t}return __extends(t,e),t.prototype.onEnable=function(){e.prototype.onEnable.call(this),this.RefreshItems(),this.scrollView.scrollToTop()},t.prototype.RefreshItems=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,a,s,l=this;return __generator(this,function(d){switch(d.label){case 0:t=-1,n=function(n){return __generator(this,function(s){switch(s.label){case 0:return-1!=(e=i.default.data.plants[n]).pos?[3,3]:++t<a.items.length?(a.items[t].node.active=!0,a.items[t].Init(n,e),[3,3]):[3,1];case 1:return[4,r.default.instance.load(c.default.StoreItem,function(a){var i=a.getComponent(o.default);a.y=114*-t-70,console.log("current position:"+a.y),l.content.addChild(a),l.items.push(i),i.Init(n,e)})];case 2:s.sent(),s.label=3;case 3:return[2]}})},a=this,s=0,d.label=1;case 1:return s<i.default.data.plants.length?[5,n(s)]:[3,4];case 2:d.sent(),d.label=3;case 3:return++s,[3,1];case 4:for(this.content.height=114*(t+1)+20,s=t+1;s<this.items.length;++s)this.items[s].node.active=!1,console.log("Hidden plants"+s);return[2]}})})},__decorate([d({type:cc.ScrollView,displayName:"\u5212\u52a8\u5217\u8868"})],t.prototype,"scrollView",void 0),__decorate([d({type:cc.Node,displayName:"\u5217\u8868\u5185\u5bb9"})],t.prototype,"content",void 0),t=__decorate([l],t)}(a.default);n.default=u,cc._RF.pop()},{"../../Common/PrefabID":"PrefabID","../../Core/ResourcesManager":"ResourcesManager","../../Data/GardenData":"GardenData","../Base/View":"View","./StoreItem":"StoreItem"}],SubDisplay:[function(e,t,n){"use strict";cc._RF.push(t,"40c1dKOq1lDk6Aoi7S7jCsb","SubDisplay"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../core/GameHelper"),o=cc._decorator,i=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.updateCnt=0,t}return __extends(t,e),t.prototype.onLoad=function(){this.sprite=this.node.getComponent(cc.Sprite),window.wx?(this.tex=new cc.Texture2D,this.updateCnt=Number.MAX_VALUE,this.tex.initWithElement(wx.getOpenDataContext().canvas),this.tex.handleLoadedTexture(),this.sprite.spriteFrame=new cc.SpriteFrame(this.tex)):this.updateCnt=0},t.prototype.update=function(){this.updateCnt>0&&(this.updateCnt--,this.tex.initWithElement(wx.getOpenDataContext().canvas),this.tex.handleLoadedTexture(),this.sprite.spriteFrame=new cc.SpriteFrame(this.tex))},t.prototype.updateSize=function(){window.wx&&(wx.getOpenDataContext().canvas.width=this.node.width,wx.getOpenDataContext().canvas.height=this.node.height,console.log("sharedCanvas.width == ",wx.getOpenDataContext().canvas.width),console.log("sharedCanvas.height == ",wx.getOpenDataContext().canvas.height))},t.prototype.showFriendsRank=function(e,t){var n=this;if(void 0===e&&(e="show"),void 0===t&&(t=!1),window.wx){this.updateSize();var o=cc.view.getVisibleSize(),i=this.node.getPosition();i.x-=this.node.width*this.node.anchorX,i.y+=this.node.height*(1-this.node.anchorY),i=this.node.parent.convertToWorldSpaceAR(i),a.default.Log("\u5b50\u57df\u7cbe\u7075\u5de6\u4e0a\u5750\u6807: ",i),this.updateCnt=Number.MAX_VALUE;var r={msg:"rank",action:e,resolution:[i.x,o.height-i.y,o.width,o.height],startUpdate:!0,pageMode:t,key:"score"};a.default.Log(r),SDK.subMsg(r,null),this.scheduleOnce(function(){n.node.active=!0},.1)}},t.prototype.showGroupRank=function(e){var t=this;if(window.wx){this.updateSize();var n=cc.view.getVisibleSize(),a=this.node.getPosition();a.x-=this.node.width*this.node.anchorX,a.y+=this.node.height*(1-this.node.anchorY),a=this.node.parent.convertToWorldSpaceAR(a),console.log("\u5b50\u57df\u7cbe\u7075\u5de6\u4e0a\u5750\u6807: ",a),this.updateCnt=Number.MAX_VALUE;var o={msg:"group",action:"show",resolution:[a.x,n.height-a.y,n.width,n.height],startUpdate:!0,pageMode:!1,key:"score",shareTicket:e};console.log(o),SDK.subMsg(o,null),this.scheduleOnce(function(){t.node.active=!0},.1)}},t.prototype.showResult=function(){var e=this;if(window.wx){this.updateSize(),this.updateCnt=360;var t={msg:"result",action:"show",key:"score",startUpdate:!1};console.log(t),SDK.subMsg(t,null),this.scheduleOnce(function(){e.node.active=!0},.1)}},t.prototype.showSurpass=function(e){var t=this;if(window.wx){this.updateSize(),this.updateCnt=360;var n={msg:"beyond",action:"show",format:"\u5373\u5c06\u8d85\u8d8a",score:e,order:-1,key:"score",startUpdate:!1,style:0};console.log(n),SDK.subMsg(n,null),this.scheduleOnce(function(){t.node.active=!0},.1)}},t.prototype.showSurpassList=function(e){var t=this;if(window.wx){this.updateSize(),this.updateCnt=360;var n={msg:"surpassList",action:"show",score:e,order:-1,key:"score",startUpdate:!1};console.log(n),SDK.subMsg(n,null),this.scheduleOnce(function(){t.node.active=!0},.1)}},t.prototype.hideSub=function(){var e=this;window.wx&&(console.log("\u9690\u85cf\u5b50\u57df"),this.updateCnt=1,SDK.subMsg({msg:"hideAll",pauseUpdate:!0},null),this.scheduleOnce(function(){e.node.active=!1},.1))},t.prototype.closeSub=function(){var e=this;window.wx&&(this.updateCnt=1,SDK.subMsg({msg:"closeAll",pauseUpdate:!0},null),this.scheduleOnce(function(){e.node.active=!1},.1))},t=__decorate([i],t)}(cc.Component));n.default=r,cc._RF.pop()},{"../../core/GameHelper":"GameHelper"}],TeachConfig:[function(e,t,n){"use strict";cc._RF.push(t,"67a7c0P3whNurCo9a8ZLpgU","TeachConfig"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){return function(){this.id=0,this.desc=""}}();n.default=a,cc._RF.pop()},{}],TeachLogic:[function(e,t,n){"use strict";cc._RF.push(t,"b4539qnB1NIerUSeNXnyfr9","TeachLogic"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../Common/DataManager"),i=e("../UI/Garden/Garden"),r=e("../Data/GardenData"),c=e("./BuffLogic"),s=e("../Data/BuffData"),l=e("./GardenLogic"),d=e("../UI/Teach/TeachView");(function(e){e[e.OVER=-1]="OVER",e[e.NONE=0]="NONE",e[e.GETPLANT=1]="GETPLANT",e[e.CLICK=2]="CLICK",e[e.PLANTUP=3]="PLANTUP",e[e.UNLOCKPLANT=4]="UNLOCKPLANT",e[e.PLANT=5]="PLANT",e[e.UNLOCKBUFF=6]="UNLOCKBUFF",e[e.FERTILIZER=7]="FERTILIZER",e[e.UNLOCKSHOP=8]="UNLOCKSHOP",e[e.UNLOCKRANK=9]="UNLOCKRANK"})(a=n.TeachStageEnum||(n.TeachStageEnum={}));var u=cc._decorator,p=u.ccclass,f=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buffUnlockLv=3,t.shopUnlockLv=8,t.rankUnlockLv=10,t.waitStage=a.OVER,t.subStage=a.NONE,t.isTeach=!1,t.clickTimes=0,t.isPropComp=!1,t.isTipFinger=!1,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),t.prototype.CheckFinger=function(e,t){if(void 0===t&&(t=0),o.default.instance.beginerStage==e)switch(e){case a.PLANT:case a.FERTILIZER:d.default.instance&&d.default.instance.ShowTeach()}},t.prototype.SetFingerState=function(e){if(e){if(!this.isTipFinger&&r.default.data.level>n.stage3Lv&&r.default.data.level<20&&!this.isTeach&&!c.default.instance.isUse[s.BuffTypeEnum.PHOTOSYNTHESIS]&&!c.default.instance.isUse[s.BuffTypeEnum.WATERING]&&o.default.instance.Now()-Math.max(l.default.instance.lastTapTime,l.default.instance.lastUsePropTime)>3e4){for(var t=0,a=-1,d=0;d<i.default.instance.plants.length;++d)i.default.instance.plants[d].data.product>t&&(t=i.default.instance.plants[d].data.product,a=d);a>-1&&(i.default.instance.finger.active=!0,i.default.instance.finger.angle=30,i.default.instance.finger.setParent(i.default.instance.plants[a].node),i.default.instance.finger.position=cc.v2(40,20),this.isTipFinger=!0,this.clickTimes=0)}}else this.isTipFinger&&(this.clickTimes=0,this.isTipFinger=!1,i.default.instance.finger.active&&(i.default.instance.finger.active=!1))},t.stage1Lv=1,t.stage3Lv=2,t=n=__decorate([p],t)}(cc.Component));n.default=f,cc._RF.pop()},{"../Common/DataManager":"DataManager","../Data/BuffData":"BuffData","../Data/GardenData":"GardenData","../UI/Garden/Garden":"Garden","../UI/Teach/TeachView":"TeachView","./BuffLogic":"BuffLogic","./GardenLogic":"GardenLogic"}],TeachView:[function(e,t,n){"use strict";cc._RF.push(t,"416bf7+snFDJJPsXKkj7RNW","TeachView"),Object.defineProperty(n,"__esModule",{value:!0});var a,o=e("../../Common/DataManager"),i=e("../ToolBar/BottomToolBar"),r=e("../../Core/ResourcesManager"),c=e("../../Common/PrefabID"),s=e("../UIManager"),l=e("../../Logic/TeachLogic"),d=e("../Garden/Garden"),u=e("../../Common/CommonUils"),p=e("../../Core/GameHelper"),f=e("../../Data/BuffData"),h=e("../Reward/RewardView"),g=e("../../Core/RewardLogic"),m=e("../../Core/ShareLogic"),y=e("../Garden/Tier"),v=e("../ToolBar/MiddleToolBar");(function(e){e[e.SUB1=0]="SUB1"})(a||(a={}));var _=cc._decorator,S=_.ccclass,w=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.finger=null,t.circle=null,t.teachTxt=null,t.circlePos=new cc.Vec2,t.fingerPos=new cc.Vec2,t.bgPos=new cc.Vec2,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.getInstance=function(){return __awaiter(this,void 0,Promise,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return this._instance?[3,2]:[4,r.default.instance.load(c.default.TeachView,function(t){e._instance=t.getComponent(n),s.default.instance.viewLayers[s.LayerType.POPUP].addChild(t),e._instance.curStage=l.TeachStageEnum.CLICK,e._instance.curSubStage=a.SUB1})];case 1:t.sent(),t.label=2;case 2:return[2,this._instance]}})})},t.prototype.ShowTeach=function(e){void 0===e&&(e=a.SUB1),l.default.instance.isTeach=!0,this.node.active=!0,this.node.zIndex=999,this.curStage=o.default.instance.beginerStage,this.curSubStage=e,d.default.instance.scrollView.enabled=!1,this.curStage==l.TeachStageEnum.OVER||(this.curStage<l.TeachStageEnum.UNLOCKSHOP?(i.default.instance.btns[i.BottomBtnEnum.SHOP].node.active=!1,this.curStage<l.TeachStageEnum.UNLOCKBUFF&&(i.default.instance.btns[i.BottomBtnEnum.BUFF].node.active=!1),this.node.on(cc.Node.EventType.TOUCH_END,this.OnTeachTouch,this)):this.node.on(cc.Node.EventType.TOUCH_END,this.OnTeachTouch,this)),s.default.instance.GetViewStatus(s.ViewName.AtlasView)==s.ViewStatusEnum.OPEN?s.default.instance.closeView(s.ViewName.AtlasView):s.default.instance.GetViewStatus(s.ViewName.AtlasCardView)==s.ViewStatusEnum.OPEN&&s.default.instance.closeView(s.ViewName.AtlasCardView),this.NextTeachStage()},t.prototype.CalcNextStage=function(){this.curSubStage+1<o.default.instance.GetTeachConfig(this.curStage).length?this.curSubStage++:(this.curStage++,this.curSubStage=a.SUB1),this.NextTeachStage()},t.prototype.NextTeachStage=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,a,r,c,p=this;return __generator(this,function(h){switch(e=o.default.instance.GetTeachConfig(this.curStage),this.curStage!=l.TeachStageEnum.OVER&&(this.teachTxt.string=e[this.curSubStage].desc),console.log("Current stage:"+this.curStage),this.curStage){case l.TeachStageEnum.GETPLANT:this.HideHand(),this.HideCircle();break;case l.TeachStageEnum.CLICK:l.default.instance.clickTimes=0,t=d.default.instance.tiers[0].getComponent(y.default).addArea[0],this.circlePos=u.default.transRelativeFromPos(t.parent,t.position),this.circlePos=cc.v2(this.circlePos.x,this.circlePos.y-60),this.circlePos.y+=50,this.SetCircleSize(200),this.SetFingerPos(this.circlePos.x+10,this.circlePos.y-60);break;case l.TeachStageEnum.PLANTUP:console.log("Current sub-phase:"+this.curSubStage),this.curSubStage==e.length-2?(n=i.default.instance.btns[i.BottomBtnEnum.PLANT].node,this.circlePos=u.default.transRelativeFromPos(n.parent,n.position),this.SetCircleSize(n.width+50,n.height+50),this.SetFingerPos(this.circlePos.x+20,this.circlePos.y-50)):this.curSubStage==e.length-1?s.default.instance.GetView(s.ViewName.PlantView,function(e){var t=function(){if(e.items[0]){p.unschedule(t);var n=e.items[0].upgradeBtn;p.circlePos=u.default.transRelativeFromPos(n.parent,n.position),p.SetCircleSize(n.width+30,n.height+30),p.SetFingerPos(p.circlePos.x+20,p.circlePos.y-50)}};p.schedule(t,.5)}):(this.HideHand(),this.HideCircle());break;case l.TeachStageEnum.UNLOCKPLANT:0==this.curSubStage?(n=i.default.instance.btns[i.BottomBtnEnum.PLANT].node,this.circlePos=u.default.transRelativeFromPos(n.parent,n.position),this.SetCircleSize(n.width+50,n.height+50),this.SetFingerPos(this.circlePos.x+20,this.circlePos.y-50)):1==this.curSubStage?(this.HideHand(),this.HideCircle(),s.default.instance.GetView(s.ViewName.PlantView,function(e){var t=function(){if(e.items[1]){p.unschedule(t);var n=e.items[1].purchaseBtn;p.circlePos=u.default.transRelativeFromPos(n.parent,n.position),p.SetCircleSize(n.width+30,n.height+30),p.SetFingerPos(p.circlePos.x+20,p.circlePos.y-50)}};p.schedule(t,.5)})):(this.HideHand(),this.HideCircle());break;case l.TeachStageEnum.UNLOCKBUFF:0==this.curSubStage?((a=i.default.instance.btns[i.BottomBtnEnum.BUFF].node).active=!0,this.circlePos=u.default.transRelativeFromPos(a.parent,a.position),this.SetCircleSize(a.width+50,a.height+50),this.SetFingerPos(this.circlePos.x+20,this.circlePos.y-50)):this.curSubStage==e.length-1?s.default.instance.GetView(s.ViewName.BuffView,function(e){var t=e.buffBtns[f.BuffTypeEnum.FERTILIZER-1].node;p.circlePos=u.default.transRelativeFromPos(t.parent,t.position),p.SetCircleSize(t.width-20,t.height-20),p.SetFingerPos(p.circlePos.x+20,p.circlePos.y-50)}):(this.HideHand(),this.HideCircle());break;case l.TeachStageEnum.FERTILIZER:this.curSubStage==e.length-3?s.default.instance.GetView(s.ViewName.BuffView,function(e){var t=e.buffBtns[f.BuffTypeEnum.PHOTOSYNTHESIS-1].node;p.circlePos=u.default.transRelativeFromPos(t.parent,t.position),p.SetCircleSize(t.width-20,t.height-20),p.HideHand()}):this.curSubStage==e.length-2?s.default.instance.GetView(s.ViewName.BuffView,function(e){var t=e.buffBtns[f.BuffTypeEnum.WATERING-1].node;p.circlePos=u.default.transRelativeFromPos(t.parent,t.position),p.SetCircleSize(t.width-20,t.height-20),p.HideHand()}):this.curSubStage==e.length-1?s.default.instance.GetView(s.ViewName.BuffView,function(e){var t=e.clearBtn.node;p.circlePos=u.default.transRelativeFromPos(t.parent,t.position),p.SetCircleSize(t.width-20,t.height-20),p.HideHand()}):(this.HideHand(),this.HideCircle());break;case l.TeachStageEnum.UNLOCKSHOP:0==this.curSubStage?((r=i.default.instance.btns[i.BottomBtnEnum.SHOP].node).active=!0,this.circlePos=u.default.transRelativeFromPos(r.parent,r.position),this.SetCircleSize(r.width+50,r.height+50),this.SetFingerPos(this.circlePos.x+20,this.circlePos.y-50)):(this.HideHand(),this.HideCircle());break;case l.TeachStageEnum.UNLOCKRANK:0==this.curSubStage?((c=i.default.instance.btns[i.BottomBtnEnum.RANK].node).active=!0,this.circlePos=u.default.transRelativeFromPos(c.parent,c.position),this.SetCircleSize(c.width+50,c.height+50),this.SetFingerPos(this.circlePos.x+20,this.circlePos.y-50)):(this.HideHand(),this.HideCircle());break;case l.TeachStageEnum.OVER:this.HideTeach(),this.SaveStage(),v.default.instance.CheckCollectBtn();break;default:this.HideHand(),this.HideCircle()}return[2]})})},t.prototype.OnTeachTouch=function(e){var t=this,n=e.getLocation(),a=o.default.instance.GetTeachConfig(this.curStage);switch(this.curStage){case l.TeachStageEnum.GETPLANT:d.default.instance.InitPlant(),this.CalcNextStage(),this.SaveStage();break;case l.TeachStageEnum.CLICK:this.curSubStage==a.length-1?d.default.instance.plants[0].rootNode.getBoundingBoxToWorld().contains(n)?(l.default.instance.clickTimes++,p.default.DispatchEvent(d.default.instance.plants[0].rootNode,cc.Node.EventType.TOUCH_END,e),l.default.instance.clickTimes>3&&(this.CalcNextStage(),this.SaveStage())):p.default.Log("Point outside the area"):this.CalcNextStage();break;case l.TeachStageEnum.PLANTUP:if(this.curSubStage==a.length-2)(r=i.default.instance.btns[i.BottomBtnEnum.PLANT].node).getBoundingBoxToWorld().contains(n)?(p.default.DispatchEvent(r,cc.Node.EventType.TOUCH_END),this.HideHand(),this.HideCircle(),this.scheduleOnce(function(){t.CalcNextStage()},1)):p.default.Log("Point outside the area");else this.curSubStage==a.length-1?s.default.instance.GetView(s.ViewName.PlantView,function(e){e.items[0]&&(e.items[0].upgradeBtn.getBoundingBoxToWorld().contains(n)?(e.scrollView.enabled=!1,p.default.DispatchEvent(e.items[0].upgradeBtn,cc.Node.EventType.TOUCH_END),e.scrollView.enabled=!0,t.HideTeach(),t.SaveStage(!0)):p.default.Log("Point outside the area"))}):this.CalcNextStage();break;case l.TeachStageEnum.UNLOCKPLANT:var r;if(0==this.curSubStage)(r=i.default.instance.btns[i.BottomBtnEnum.PLANT].node).getBoundingBoxToWorld().contains(n)?(p.default.DispatchEvent(r,cc.Node.EventType.TOUCH_END),this.CalcNextStage()):p.default.Log("Point outside the area");else 1==this.curSubStage?s.default.instance.GetView(s.ViewName.PlantView,function(e){e.items[1]&&(e.items[1].purchaseBtn.getBoundingBoxToWorld().contains(n)?(e.scrollView.enabled=!1,p.default.DispatchEvent(e.items[1].purchaseBtn,cc.Node.EventType.TOUCH_END),e.scrollView.enabled=!0,t.HideTeach(),t.SaveStage(!0)):p.default.Log("Point outside the area"))}):this.curSubStage==a.length-1?(this.HideTeach(),this.SaveStage(!0)):this.CalcNextStage();break;case l.TeachStageEnum.UNLOCKBUFF:if(0==this.curSubStage){var c=i.default.instance.btns[i.BottomBtnEnum.BUFF].node;c.getBoundingBoxToWorld().contains(n)?(p.default.DispatchEvent(c,cc.Node.EventType.TOUCH_END),this.HideHand(),this.HideCircle(),this.scheduleOnce(function(){t.CalcNextStage()},1)):p.default.Log("Point outside the area")}else this.curSubStage==a.length-1?s.default.instance.GetView(s.ViewName.BuffView,function(e){var a=e.buffBtns[f.BuffTypeEnum.FERTILIZER-1].node;a.getBoundingBoxToWorld().contains(n)?(e.scrollView.enabled=!1,p.default.DispatchEvent(a,cc.Node.EventType.TOUCH_END),e.scrollView.enabled=!0,t.HideTeach(),t.SaveStage(!0)):p.default.Log("Point outside the area")}):this.CalcNextStage();break;case l.TeachStageEnum.UNLOCKSHOP:if(0==this.curSubStage){var u=i.default.instance.btns[i.BottomBtnEnum.SHOP].node;u.getBoundingBoxToWorld().contains(n)?(p.default.DispatchEvent(u,cc.Node.EventType.TOUCH_END),this.CalcNextStage()):p.default.Log("Point outside the area")}else if(this.curSubStage==a.length-1){this.HideTeach(),this.SaveStage(!0);var y=new h.RewardData;y.rewardMethod=g.RewardMethodEnum.NONE,y.shareType=m.ShareTypeEnum.NONE,y.rewardTypes=[h.RewardTypeEnum.DIAMOND],y.rewardVals=[50],y.title="Successfully unlocked the mall",y.desc3="Give away:",y.ratio=1,s.default.instance.rewardDatas.push(y)}else this.CalcNextStage();break;case l.TeachStageEnum.UNLOCKRANK:if(0==this.curSubStage){var v=i.default.instance.btns[i.BottomBtnEnum.RANK].node;v.getBoundingBoxToWorld().contains(n)?(p.default.DispatchEvent(v,cc.Node.EventType.TOUCH_END),this.curStage=l.TeachStageEnum.OVER,this.NextTeachStage()):p.default.Log("Point outside the area")}else this.curSubStage==a.length-1?(this.HideTeach(),this.curStage=l.TeachStageEnum.OVER,this.SaveStage()):this.CalcNextStage();break;default:this.curSubStage==a.length-1?(this.HideTeach(),this.SaveStage(!0)):this.CalcNextStage()}},t.prototype.HideHand=function(){this.finger.active&&(this.finger.active=!1)},t.prototype.HideCircle=function(){0!=this.circle.width&&(this.circle.width=this.circle.height=0)},t.prototype.SaveStage=function(e){void 0===e&&(e=!1),e&&this.curStage++,p.default.Log("Currently savedstage:"+this.curStage),o.default.instance.SetBeginerStage(this.curStage)},t.prototype.SetFingerPos=function(e,t){this.fingerPos.x=e,this.fingerPos.y=t,this.finger.position=this.fingerPos,this.finger.active=!0},t.prototype.SetCircleSize=function(e,t){void 0===t&&(t=0),0==t&&(t=e),this.circle.position=this.circlePos,this.circle.getChildByName("BgMask").getComponent(cc.Widget).updateAlignment(),this.circle.width=e,this.circle.height=t},t.prototype.HideTeach=function(){this.node.active=!1,l.default.instance.isTeach=!1,d.default.instance.scrollView.enabled=!0},__decorate([w({type:cc.Node,displayName:"\u624b\u6307"})],t.prototype,"finger",void 0),__decorate([w({type:cc.Node,displayName:"\u906e\u7f69"})],t.prototype,"circle",void 0),__decorate([w({type:cc.Label,displayName:"\u5f15\u5bfc\u6587\u5b57"})],t.prototype,"teachTxt",void 0),t=n=__decorate([S],t)}(cc.Component);n.default=C,cc._RF.pop()},{"../../Common/CommonUils":"CommonUils","../../Common/DataManager":"DataManager","../../Common/PrefabID":"PrefabID","../../Core/GameHelper":"GameHelper","../../Core/ResourcesManager":"ResourcesManager","../../Core/RewardLogic":"RewardLogic","../../Core/ShareLogic":"ShareLogic","../../Data/BuffData":"BuffData","../../Logic/TeachLogic":"TeachLogic","../Garden/Garden":"Garden","../Garden/Tier":"Tier","../Reward/RewardView":"RewardView","../ToolBar/BottomToolBar":"BottomToolBar","../ToolBar/MiddleToolBar":"MiddleToolBar","../UIManager":"UIManager"}],TestView:[function(e,t,n){"use strict";cc._RF.push(t,"b7b00z08ClKZqKjaIu7g8gp","TestView"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../Base/View"),o=e("../../Logic/EconomicLogic"),i=e("../../Logic/GardenLogic"),r=e("../../Core/Server"),c=e("../../Data/GardenData"),s=cc._decorator,l=s.ccclass,d=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.OnAddOxyTap=function(){o.default.instance.AddOxy(Math.pow(10,24))},t.prototype.OnClearOxyTap=function(){o.default.instance.SubOxy(o.default.instance.oxy.toString())},t.prototype.OnAddDiamondTap=function(){o.default.instance.diamond+=1e4},t.prototype.OnClearDiamondTap=function(){o.default.instance.diamond=0},t.prototype.OnAddLevel=function(){c.default.data.exp=i.default.instance.curLvCnf.exp,i.default.instance.PopUpgradeReward()},t.prototype.OnClearDataTap=function(){var e=this;wx.offHide(null),r.default.saveData("null",function(){cc.sys.localStorage.clear(),e.exiteGame()},function(e){console.log("\u6e05\u7a7a\u670d\u52a1\u7aef\u6570\u636e\u5931\u8d25",e)})},t.prototype.exiteGame=function(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),wx.exitMiniProgram({success:e,fail:t,complete:n})},t=__decorate([l],t)}(a.default));n.default=d,cc._RF.pop()},{"../../Core/Server":"Server","../../Data/GardenData":"GardenData","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../Base/View":"View"}],Tier:[function(e,t,n){"use strict";cc._RF.push(t,"eb794fouZtGwqNY3SDFFsYg","Tier"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Logic/GardenLogic"),o=e("../../Core/GameHelper"),i=e("../../Sound/SoundClip"),r=e("../../Sound/SoundManager"),c=e("../../Logic/TeachLogic"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.addArea=[],t.index=0,t}return __extends(t,e),t.prototype.start=function(){this.AddEvents()},t.prototype.AddEvents=function(){for(var e=0;e<this.addArea.length;++e)this.addArea[e].on(cc.Node.EventType.TOUCH_END,this.OnAreaTap,{that:this,i:e})},t.prototype.OnAreaTap=function(){r.default.instance.playAudioClip(i.SoundClipType.click);var e=this.that,t=this.i,n=a.default.instance.RC2Pos(e.index,t);switch(a.default.instance.tapMode){case a.TapModeEnum.BUY:a.default.instance.PlantItem(n),o.default.Log("Planting location"+n),c.default.instance.CheckFinger(c.TeachStageEnum.PLANT);break;case a.TapModeEnum.STORE:a.default.instance.StoreItem(n)}},t.prototype.ShowArea=function(){for(var e=this,t=function(t){if(a.default.instance.plants.filter(function(n){return n.pos==4*e.index+t}).length>0)return"continue";n.addArea[t].active=!0},n=this,o=0;o<this.addArea.length;++o)t(o)},t.prototype.HideArea=function(){for(var e=0;e<this.addArea.length;++e)this.addArea[e].active=!1},__decorate([d({type:cc.Node,tooltip:"\u53ef\u64cd\u4f5c\u533a\u57df"})],t.prototype,"addArea",void 0),t=__decorate([l],t)}(cc.Component);n.default=u,cc._RF.pop()},{"../../Core/GameHelper":"GameHelper","../../Logic/GardenLogic":"GardenLogic","../../Logic/TeachLogic":"TeachLogic","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager"}],TopToolBar:[function(e,t,n){"use strict";cc._RF.push(t,"70138XqOTBPC6U6SVfE/zTm","TopToolBar"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../Data/GameData"),o=e("../../Sound/SoundManager"),i=e("../../Sound/BgSoundClip"),r=e("../../Logic/GardenLogic"),c=e("../../Core/ShareLogic"),s=e("../../Logic/EconomicLogic"),l=e("../../Common/EventID"),d=e("../../Data/GardenData"),u=e("../UIManager"),p=e("../../Sound/SoundClip"),f=cc._decorator,h=f.ccclass,g=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.productNode=null,t.placeNode=null,t.upgradeBtn=null,t.placeModeBtn=null,t.muteBtn=null,t.shareBtn=null,t.atlasBtn=null,t.testBtn=null,t.coinTxt=null,t.coinIco=null,t.diamondTxt=null,t.diamondIco=null,t.LvTxt=null,t.LvExpProgress=null,t.soundOnIco=null,t.soundOffIco=null,t.sunBuff=null,t.waterBuff=null,t.isCanUpgrade=!1,t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n._instance=this},t.prototype.start=function(){1==a.default.data.mute?(this.muteBtn.getComponent(cc.Sprite).spriteFrame=this.soundOffIco,o.default.instance.pause()):(this.muteBtn.getComponent(cc.Sprite).spriteFrame=this.soundOnIco,o.default.instance.resume()),o.default.instance.PlayBGSound(i.BgSoundClipType.main),this.RefreshCoinTxt(),this.RefreshDiamondTxt(),this.RefreshLvTxt(),this.RefreshExp(),this.AddEvents(),this.ResetToolBarHeight()},t.prototype.AddEvents=function(){this.placeModeBtn.on(cc.Node.EventType.TOUCH_END,this.OnMoveModeBtnTap,this),this.muteBtn.on(cc.Node.EventType.TOUCH_END,this.OnMuteBtnTap,this),this.shareBtn.on(cc.Node.EventType.TOUCH_END,this.OnShareBtnTap,this),this.atlasBtn.on(cc.Node.EventType.TOUCH_END,this.OnAtlasBtnTap,this),this.testBtn.on(cc.Node.EventType.TOUCH_END,this.OnTestBtnTap,this),cc.systemEvent.on(l.default.oxy_changed,this.RefreshCoinTxt,this),cc.systemEvent.on(l.default.diamond_changed,this.RefreshDiamondTxt,this),cc.systemEvent.on(l.default.level_changed,this.RefreshLvTxt,this),cc.systemEvent.on(l.default.levelexp_changed,this.RefreshExp,this)},t.prototype.OnUpgradeBtnTap=function(e){o.default.instance.playAudioClip(p.SoundClipType.click),r.default.instance.PopUpgradeReward()},t.prototype.OnMoveModeBtnTap=function(e){o.default.instance.playAudioClip(p.SoundClipType.click),r.default.instance.ToPlaceMode()},t.prototype.OnMuteBtnTap=function(e){1==a.default.data.mute?(this.muteBtn.getComponent(cc.Sprite).spriteFrame=this.soundOnIco,o.default.instance.resume()):(this.muteBtn.getComponent(cc.Sprite).spriteFrame=this.soundOffIco,o.default.instance.pause())},t.prototype.OnShareBtnTap=function(e){o.default.instance.playAudioClip(p.SoundClipType.click),c.default.instance.Share(c.ShareTypeEnum.SHARE)},t.prototype.OnAtlasBtnTap=function(e){o.default.instance.playAudioClip(p.SoundClipType.click),u.default.instance.OpenView(u.ViewName.AtlasView)},t.prototype.OnTestBtnTap=function(e){o.default.instance.playAudioClip(p.SoundClipType.click),u.default.instance.OpenView(u.ViewName.TestView)},t.prototype.RefreshCoinTxt=function(){this.coinTxt.string=s.default.instance.getOxyUnitFormat()},t.prototype.RefreshDiamondTxt=function(){this.diamondTxt.string=s.default.instance.diamond.toString()},t.prototype.RefreshLvTxt=function(){this.LvTxt.string="Lv "+d.default.data.level.toString()},t.prototype.RefreshExp=function(){r.default.instance.CheckUpgrade()?r.default.instance.canPopUpgrade&&(r.default.instance.PopUpgradeReward(),this.LvExpProgress.progress=1):this.LvExpProgress.progress=d.default.data.exp/r.default.instance.curLvCnf.exp},t.prototype.ResetToolBarHeight=function(){var e=cc.view.getVisibleSize();e.height/e.width>=2&&this.ResetHeight(120)},t.prototype.ResetHeight=function(e){this.node.height=e;var t=this.productNode.getComponent(cc.Widget);t.updateAlignment(),(t=this.placeNode.getComponent(cc.Widget)).updateAlignment()},__decorate([g({type:cc.Node,displayName:"\u751f\u4ea7\u6a21\u5f0f\u7684\u5bb9\u5668"})],t.prototype,"productNode",void 0),__decorate([g({type:cc.Node,displayName:"\u5e03\u7f6e\u6a21\u5f0f\u7684\u5bb9\u5668"})],t.prototype,"placeNode",void 0),__decorate([g({type:cc.Node,displayName:"\u5347\u7ea7\u6309\u94ae"})],t.prototype,"upgradeBtn",void 0),__decorate([g({type:cc.Node,displayName:"\u5e03\u7f6e\u6a21\u5f0f\u6309\u94ae"})],t.prototype,"placeModeBtn",void 0),__decorate([g({type:cc.Node,displayName:"\u9759\u97f3\u6309\u94ae"})],t.prototype,"muteBtn",void 0),__decorate([g({type:cc.Node,displayName:"\u5206\u4eab\u6309\u94ae"})],t.prototype,"shareBtn",void 0),__decorate([g({type:cc.Node,displayName:"\u56fe\u9274\u6309\u94ae"})],t.prototype,"atlasBtn",void 0),__decorate([g({type:cc.Node,displayName:"\u6d4b\u8bd5\u6309\u94ae"})],t.prototype,"testBtn",void 0),__decorate([g({type:cc.Label,displayName:"\u91d1\u5e01\u6570\u91cf\u6587\u672c"})],t.prototype,"coinTxt",void 0),__decorate([g({type:cc.Node,displayName:"\u91d1\u5e01\u56fe\u6807"})],t.prototype,"coinIco",void 0),__decorate([g({type:cc.Label,displayName:"\u94bb\u77f3\u6570\u91cf\u6587\u672c"})],t.prototype,"diamondTxt",void 0),__decorate([g({type:cc.Node,displayName:"\u94bb\u77f3\u56fe\u6807"})],t.prototype,"diamondIco",void 0),__decorate([g({type:cc.Label,displayName:"\u7b49\u7ea7\u6587\u672c"})],t.prototype,"LvTxt",void 0),__decorate([g({type:cc.ProgressBar,displayName:"\u7ecf\u9a8c\u8fdb\u5ea6\u6761"})],t.prototype,"LvExpProgress",void 0),__decorate([g({type:cc.SpriteFrame,displayName:"\u58f0\u97f3\u5f00\u56fe\u6807"})],t.prototype,"soundOnIco",void 0),__decorate([g({type:cc.SpriteFrame,displayName:"\u58f0\u97f3\u5173\u56fe\u6807"})],t.prototype,"soundOffIco",void 0),__decorate([g({type:cc.Sprite,displayName:"\u5149\u7167\u56fe\u6807"})],t.prototype,"sunBuff",void 0),__decorate([g({type:cc.Sprite,displayName:"\u6d47\u6c34\u56fe\u6807"})],t.prototype,"waterBuff",void 0),t=n=__decorate([h],t)}(cc.Component);n.default=m,cc._RF.pop()},{"../../Common/EventID":"EventID","../../Core/ShareLogic":"ShareLogic","../../Data/GameData":"GameData","../../Data/GardenData":"GardenData","../../Logic/EconomicLogic":"EconomicLogic","../../Logic/GardenLogic":"GardenLogic","../../Sound/BgSoundClip":"BgSoundClip","../../Sound/SoundClip":"SoundClip","../../Sound/SoundManager":"SoundManager","../UIManager":"UIManager"}],UIManager:[function(e,t,n){"use strict";cc._RF.push(t,"ca3e11H0QRCIYwl4xs+pMuA","UIManager"),Object.defineProperty(n,"__esModule",{value:!0});var a,o,i=e("./Base/View"),r=e("../Logic/GardenLogic"),c=e("../Sound/SoundManager"),s=e("../Sound/SoundClip"),l=e("../Core/GameHelper"),d=e("./Garden/Garden"),u=cc._decorator,p=u.ccclass,f=u.property,h=function(){function e(){}return e.SignInView="SignInView",e.OfflineView="OfflineView",e.RewardView="RewardView",e.PlantView="PlantView",e.BuffView="BuffView",e.PurchaseView="PurchaseView",e.AtlasView="AtlasView",e.AtlasCardView="AtlasCardView",e.ShopView="ShopView",e.RankView="RankView",e.StoreView="StoreView",e.TestView="TestView",e.BuffMotiveView="BuffMotiveView",e.ConfirmView="ConfirmView",e.CollectView="CollectView",e}();n.ViewName=h,function(e){e[e.LOADING=0]="LOADING",e[e.OPEN=1]="OPEN",e[e.CLOSE=2]="CLOSE",e[e.NOTEXIST=3]="NOTEXIST"}(a=n.ViewStatusEnum||(n.ViewStatusEnum={})),function(e){e[e.BACK=0]="BACK",e[e.POPUP=1]="POPUP",e[e.FRONT=2]="FRONT",e[e.PAGE=3]="PAGE"}(o=n.LayerType||(n.LayerType={}));var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewLayers=[],t.viewDic={},t.viewStatusDic={},t.openViewNum=0,t.openPageNum=0,t.loadingViewNum=0,t.rewardDatas=[],t}var n;return __extends(t,e),n=t,Object.defineProperty(t,"instance",{get:function(){return n._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){n._instance=this,n._instance.init()},t.prototype.init=function(){n.loadedCallBack&&(n.loadedCallBack(),n.loadedCallBack=null),this.schedule(this.CheckReward,1)},t.prototype.start=function(){this.ResetPageHeight()},t.prototype.ResetPageHeight=function(){var e=cc.view.getVisibleSize(),t=this.viewLayers[o.PAGE].getComponent(cc.Widget);e.height/e.width>=2?(n.bottomPageHeight=e.height-587,this.viewLayers[o.PAGE].parent.height=n.bottomPageHeight+100,t.bottom=SDK.isIos()?65:0):(n.bottomPageHeight=e.height-522,this.viewLayers[o.PAGE].parent.height=n.bottomPageHeight+100,t.bottom=0),this.viewLayers[o.PAGE].getComponent(cc.Widget).updateAlignment()},t.prototype.CheckReward=function(){var e=this;0==this.openViewNum&&this.rewardDatas.length>0&&this.OpenView(h.RewardView,function(t){t.init(e.rewardDatas.shift())})},t.prototype.HasOpened=function(e){return void 0!==this.viewDic[e]},t.prototype.GetView=function(e,t,n){var o=this;if(void 0===t&&(t=null),void 0===n&&(n="prefab/view/"),this.HasOpened(e))t&&t.apply(this,[this.viewDic[e]]);else{var r=n+e;if(this.viewStatusDic[e]==a.LOADING)return void l.default.Log("The page is still loading");this.loadingViewNum++,this.viewStatusDic[e]=a.LOADING,cc.loader.loadRes(r,cc.Prefab,function(n,c){if(n)l.default.Log("path"+r+"Resource not found"),o.viewStatusDic[e]=a.NOTEXIST;else{var s=cc.instantiate(c).getComponent(i.default);cc.log("\u52a0\u8f7d\u5230\u7684\u8d44\u6e90"+s.name,c),o.viewDic[e]=s,o.viewStatusDic[e]=a.CLOSE,null!=t&&t.apply(o,[s])}o.loadingViewNum--})}},t.prototype.OpenView=function(e,t,n,c){var s=this;if(void 0===t&&(t=null),void 0===n&&(n=o.POPUP),void 0===c&&(c="prefab/view/"),this.viewStatusDic[e]!=a.LOADING&&this.viewStatusDic[e]!=a.OPEN){r.default.instance.tapMode==r.TapModeEnum.BUY&&r.default.instance.ToProductMode(),n!=o.PAGE&&(r.default.instance.canPopUpgrade=!1);var l=c+e;if(this.viewDic[e]){var u=this.viewDic[e];return u.node.setParent(null),this.viewLayers[n].addChild(u.node),u.open(),n==o.PAGE?this.openPageNum++:(this.openViewNum++,d.default.instance.btnFeedback&&d.default.instance.btnFeedback.hide()),this.viewStatusDic[e]=a.OPEN,void(t&&t.apply(this,[this.viewDic[e]]))}SDK.showLoading("Loading",!0),this.viewStatusDic[e]=a.LOADING,this.loadingViewNum++,cc.loader.loadRes(l,cc.Prefab,function(r,c){if(r)s.viewStatusDic[e]=a.NOTEXIST,console.log("path"+l+"Resource not found");else{var u=cc.instantiate(c).getComponent(i.default);u.node.setParent(null),s.viewLayers[n].addChild(u.node),u.node.position=cc.Vec2.ZERO,u.open(),n==o.PAGE?s.openPageNum++:(s.openViewNum++,d.default.instance.btnFeedback&&d.default.instance.btnFeedback.hide()),s.viewStatusDic[e]=a.OPEN,s.viewDic[e]=u,null!=t&&t.apply(s,[u])}s.loadingViewNum--,SDK.hideLoading()})}},t.prototype.closeView=function(e,t){void 0===t&&(t=!1),this.viewDic[e]&&this.viewStatusDic[e]!=a.CLOSE&&(c.default.instance.playAudioClip(s.SoundClipType.close),this.viewDic[e].close(),this.viewStatusDic[e]=a.CLOSE,t&&(this.viewDic[e].node.setParent(null),this.viewDic[e].destroySelf(),this.viewDic[e]=null,delete this.viewDic[e]),e==h.PlantView||e==h.BuffView||e==h.ShopView||e==h.RankView?this.openPageNum--:this.openViewNum--,n.isPopSignIn?(n.isPopSignIn=!1,this.OpenView(h.SignInView)):0==this.openViewNum&&(r.default.instance.canPopUpgrade=!0,d.default.instance.btnFeedback&&d.default.instance.btnFeedback.show(),n.hasBanner&&this.openPageNum>0?(SDK.hideBanner(),n.hasBanner=!1):n.hasBanner||0!=this.openPageNum||(SDK.showBanner(),n.hasBanner=!0)))},t.prototype.GetViewStatus=function(e){return this.viewStatusDic[e]},t.bottomPageHeight=0,t.bottomPageY=0,t.bannerHeight=0,t.hasBanner=!1,t.isPopSignIn=!1,t.loadedCallBack=null,__decorate([f(cc.Node)],t.prototype,"viewLayers",void 0),t=n=__decorate([p],t)}(cc.Component);n.default=g,cc._RF.pop()},{"../Core/GameHelper":"GameHelper","../Logic/GardenLogic":"GardenLogic","../Sound/SoundClip":"SoundClip","../Sound/SoundManager":"SoundManager","./Base/View":"View","./Garden/Garden":"Garden"}],UserInfoBtn:[function(e,t,n){"use strict";cc._RF.push(t,"bf6c9DWlT5BOLuQv57cRcYy","UserInfoBtn"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("./GameHelper"),o=function(){function e(){}return e.prototype.createWxBtn=function(e,t,n){if("undefined"!=typeof wx&&"function"==typeof wx.createUserInfoButton){var o=e.convertToWorldSpaceAR(cc.v2(0,0)),i=cc.view.getVisibleSize(),r=o.x-e.width/2,c=i.height-o.y-e.height/2,s=wx.getSystemInfoSync(),l=s.screenWidth,d=s.screenHeight,u=r/i.width*l,p=c/i.height*d,f=e.width/i.width*l,h=e.height/i.height*d;this._wxBtn=wx.createUserInfoButton({type:"text",text:" ",style:{left:u,top:p,width:f,height:h,backgroundColor:"#00000001",color:"#00000001",fontSize:1},withCredentials:!0,lang:"zh_CN"}),this._wxBtn.onTap(function(e){a.default.Log("useUserInfoButtonGet user information:",e),e.errMsg.indexOf("auth deny")>-1||e.errMsg.indexOf("auth denied")>-1||e.errMsg.indexOf("fail")>-1?(a.default.Log("useUserInfoButtonGet user information\uff0cAuthorization failed!",e),n&&n(e)):(a.default.Log("useUserInfoButtonGet user information\uff0cAuthorization succeeded!",e),t&&t(e))})}this.normalCallback&&this._wxBtn&&this._wxBtn.hide()},e.prototype.setNormalMode=function(e){this.normalCallback=e,e?this._wxBtn&&this._wxBtn.hide():this._wxBtn&&this._wxBtn.show()},e.prototype.showWxBtn=function(){this.normalCallback||this._wxBtn.show()},e.prototype.hideWxBtn=function(){this._wxBtn.hide()},e.prototype.onNormalTap=function(e,t){this.normalCallback?this.normalCallback():this._wxBtn||this._getUserInfo(function(t){e&&e(t)},function(e){t&&t(e)})},e.prototype._getUserInfo=function(e,t){a.default.Log("usegetUserInfoGet user information"),SDK.getUserInfo(function(t){a.default.Log("getUserInfoGet user information successfully\uff0cres:"+t),e&&e(t)},function(e){a.default.Log("getUserInfoFailed to obtain user information,res:"+e),t&&t(e)},null)},e}();n.default=o,cc._RF.pop()},{"./GameHelper":"GameHelper"}],View:[function(e,t,n){"use strict";cc._RF.push(t,"be1f6UJeX5H2rFJ6Tpwunrl","View"),Object.defineProperty(n,"__esModule",{value:!0});var a=e("../UIManager"),o=e("../../core/GameHelper"),i=e("../../Data/GardenData"),r=cc._decorator,c=r.ccclass,s=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.autoClosePlace=!1,t.isDelayShowClose=!1,t.isPlayPopAni=!1,t.placeDelay=.6,t.closeCallBack=null,t.isDele=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.closeBtn=this.node.getChildByName("Win").getChildByName("CloseBtn"),this.closeBtn&&this.closeBtn.on(cc.Node.EventType.TOUCH_START,this.OnCloseBtnTap,this)},t.prototype.onEnable=function(){var e=this;this.isPlayPopAni&&(this.node.getChildByName("Win").getComponent(cc.Animation).play(),this.placeDelay=.8),this.isDelayShowClose&&SDK.conf.closebtn_delaytime.indexOf("_")?(this.closeBtn.opacity=0,this.closeBtn.active=!1,i.default.data.level<=5?this.scheduleOnce(function(){e.closeBtn.active=!0,e.closeBtn.getComponent(cc.Animation).play()},parseFloat(SDK.conf.closebtn_delaytime.split("_")[1])):this.scheduleOnce(function(){e.closeBtn.active=!0,e.closeBtn.getComponent(cc.Animation).play()},parseFloat(SDK.conf.closebtn_delaytime.split("_")[0]))):this.autoClosePlace&&(SDK.hideBanner(),a.default.hasBanner=!1,this.closeBtn.pauseSystemEvents(!1),this.closeBtn.y=100-.5*cc.view.getVisibleSize().height,cc.systemEvent.on("banner_changed",this.placeBtn,this),this.scheduleOnce(function(){PlatformMgr.showBanner(),e.closeBtn.active&&e.closeBtn.resumeSystemEvents(!1)},this.placeDelay)),o.default.Log("Display window")},t.prototype.onDisable=function(){cc.systemEvent.hasEventListener("banner_changed")&&cc.systemEvent.off("banner_changed",this.placeBtn,this),o.default.Log("Hide window")},t.prototype.placeBtn=function(){var e=cc.view.getVisibleSize();if(void 0!==window.qq)SDK._banner&&SDK._banner.style&&SDK._banner.style.realHeight?(t=SDK._banner.style.realHeight/SDK.sys.screenHeight*e.height+30-.5*e.height+50)&&(this.closeBtn.y=t):this.closeBtn.y=o.default.bannerHeight-.5*e.height+50;else if(SDK._bannerResetPosition&&SDK._banner&&SDK._banner.style&&SDK._banner.style.realHeight){var t=(SDK.sys.screenHeight-SDK._banner.style.top)/SDK.sys.screenHeight*e.height-.5*e.height+50;SDK.isIos()&&e.height/e.width>=2&&(t+=65),t&&(this.closeBtn.y=t,o.default.Log("Button original position:"+(100-.5*cc.view.getVisibleSize().height)+"\uff0cre-locate"+this.closeBtn.y))}},t.prototype.OnCloseBtnTap=function(e){this.closeCallBack&&this.closeCallBack(),o.default.Log("Delete this interface:",this.isDele),a.default.instance.closeView(this.node.name,this.isDele)},t.prototype.open=function(){this.node.active=!0},t.prototype.close=function(){this.node.active=!1},t.prototype.destroySelf=function(){this.node.destroy()},__decorate([s({displayName:"\u81ea\u52a8\u8c03\u6574\u5173\u95ed\u4f4d\u7f6e"})],t.prototype,"autoClosePlace",void 0),__decorate([s({displayName:"\u662f\u5426\u5ef6\u8fdf\u663e\u793a\u5173\u95ed\u6309\u94ae"})],t.prototype,"isDelayShowClose",void 0),__decorate([s({displayName:"\u9875\u9762\u5f39\u51fa\u52a8\u753b"})],t.prototype,"isPlayPopAni",void 0),t=__decorate([c],t)}(cc.Component);n.default=l,cc._RF.pop()},{"../../Data/GardenData":"GardenData","../../core/GameHelper":"GameHelper","../UIManager":"UIManager"}],bignumber:[function(e,t,n){"use strict";cc._RF.push(t,"81012xaIDJNLYANZ91mmjoG","bignumber");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(e){var n,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,r=Math.floor,c="[BigNumber Error] ",s=c+"Number primitive has more than 15 significant digits: ",l=1e14,d=14,u=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,h=1e9;function g(e){var t=0|e;return e>0||e===t?t:t-1}function m(e){for(var t,n,a=1,o=e.length,i=e[0]+"";a<o;){for(t=e[a++]+"",n=d-t.length;n--;t="0"+t);i+=t}for(o=i.length;48===i.charCodeAt(--o););return i.slice(0,o+1||1)}function y(e,t){var n,a,o=e.c,i=t.c,r=e.s,c=t.s,s=e.e,l=t.e;if(!r||!c)return null;if(n=o&&!o[0],a=i&&!i[0],n||a)return n?a?0:-c:r;if(r!=c)return r;if(n=r<0,a=s==l,!o||!i)return a?0:!o^n?1:-1;if(!a)return s>l^n?1:-1;for(c=(s=o.length)<(l=i.length)?s:l,r=0;r<c;r++)if(o[r]!=i[r])return o[r]>i[r]^n?1:-1;return s==l?0:s>l^n?1:-1}function v(e,t,n,a){if(e<t||e>n||e!==(e<0?i(e):r(e)))throw Error(c+(a||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function _(e){var t=e.c.length-1;return g(e.e/d)==t&&e.c[t]%2!=0}function S(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function w(e,t,n){var a,o;if(t<0){for(o=n+".";++t;o+=n);e=o+e}else if(++t>(a=e.length)){for(o=n,t-=a;--t;o+=n);e+=o}else t<a&&(e=e.slice(0,t)+"."+e.slice(t));return e}(n=function e(t){var n,C,T,D=V.prototype={constructor:V,toString:null,valueOf:null},b=new V(1),B=20,L=4,P=-7,N=21,E=-1e7,I=1e7,A=!1,R=1,O=0,x={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},M="0123456789abcdefghijklmnopqrstuvwxyz";function V(e,t){var n,a,i,c,l,p,f,h,g=this;if(!(g instanceof V))return new V(e,t);if(null==t){if(e instanceof V)return g.s=e.s,g.e=e.e,void(g.c=(e=e.c)?e.slice():e);if((p="number"==typeof e)&&0*e==0){if(g.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,l=e;l>=10;l/=10,c++);return g.e=c,void(g.c=[e])}h=String(e)}else{if(h=String(e),!o.test(h))return T(g,h,p);g.s=45==h.charCodeAt(0)?(h=h.slice(1),-1):1}(c=h.indexOf("."))>-1&&(h=h.replace(".","")),(l=h.search(/e/i))>0?(c<0&&(c=l),c+=+h.slice(l+1),h=h.substring(0,l)):c<0&&(c=h.length)}else{if(v(t,2,M.length,"Base"),h=String(e),10==t)return F(g=new V(e instanceof V?e:h),B+g.e+1,L);if(p="number"==typeof e){if(0*e!=0)return T(g,h,p,t);if(g.s=1/e<0?(h=h.slice(1),-1):1,V.DEBUG&&h.replace(/^0\.0*|\./,"").length>15)throw Error(s+e);p=!1}else g.s=45===h.charCodeAt(0)?(h=h.slice(1),-1):1;for(n=M.slice(0,t),c=l=0,f=h.length;l<f;l++)if(n.indexOf(a=h.charAt(l))<0){if("."==a){if(l>c){c=f;continue}}else if(!i&&(h==h.toUpperCase()&&(h=h.toLowerCase())||h==h.toLowerCase()&&(h=h.toUpperCase()))){i=!0,l=-1,c=0;continue}return T(g,String(e),p,t)}(c=(h=C(h,t,10,g.s)).indexOf("."))>-1?h=h.replace(".",""):c=h.length}for(l=0;48===h.charCodeAt(l);l++);for(f=h.length;48===h.charCodeAt(--f););if(h=h.slice(l,++f)){if(f-=l,p&&V.DEBUG&&f>15&&(e>u||e!==r(e)))throw Error(s+g.s*e);if((c=c-l-1)>I)g.c=g.e=null;else if(c<E)g.c=[g.e=0];else{if(g.e=c,g.c=[],l=(c+1)%d,c<0&&(l+=d),l<f){for(l&&g.c.push(+h.slice(0,l)),f-=d;l<f;)g.c.push(+h.slice(l,l+=d));h=h.slice(l),l=d-h.length}else l-=f;for(;l--;h+="0");g.c.push(+h)}}else g.c=[g.e=0]}function U(e,t,n,a){var o,i,r,c,s;if(null==n?n=L:v(n,0,8),!e.c)return e.toString();if(o=e.c[0],r=e.e,null==t)s=m(e.c),s=1==a||2==a&&r<=P?S(s,r):w(s,r,"0");else if(i=(e=F(new V(e),t,n)).e,c=(s=m(e.c)).length,1==a||2==a&&(t<=i||i<=P)){for(;c<t;s+="0",c++);s=S(s,i)}else if(t-=r,s=w(s,i,"0"),i+1>c){if(--t>0)for(s+=".";t--;s+="0");}else if((t+=i-c)>0)for(i+1==c&&(s+=".");t--;s+="0");return e.s<0&&o?"-"+s:s}function G(e,t){for(var n,a=1,o=new V(e[0]);a<e.length;a++){if(!(n=new V(e[a])).s){o=n;break}t.call(o,n)&&(o=n)}return o}function k(e,t,n){for(var a=1,o=t.length;!t[--o];t.pop());for(o=t[0];o>=10;o/=10,a++);return(n=a+n*d-1)>I?e.c=e.e=null:n<E?e.c=[e.e=0]:(e.e=n,e.c=t),e}function F(e,t,n,a){var o,c,s,u,f,h,g,m=e.c,y=p;if(m){e:{for(o=1,u=m[0];u>=10;u/=10,o++);if((c=t-o)<0)c+=d,s=t,g=(f=m[h=0])/y[o-s-1]%10|0;else if((h=i((c+1)/d))>=m.length){if(!a)break e;for(;m.length<=h;m.push(0));f=g=0,o=1,s=(c%=d)-d+1}else{for(f=u=m[h],o=1;u>=10;u/=10,o++);g=(s=(c%=d)-d+o)<0?0:f/y[o-s-1]%10|0}if(a=a||t<0||null!=m[h+1]||(s<0?f:f%y[o-s-1]),a=n<4?(g||a)&&(0==n||n==(e.s<0?3:2)):g>5||5==g&&(4==n||a||6==n&&(c>0?s>0?f/y[o-s]:0:m[h-1])%10&1||n==(e.s<0?8:7)),t<1||!m[0])return m.length=0,a?(t-=e.e+1,m[0]=y[(d-t%d)%d],e.e=-t||0):m[0]=e.e=0,e;if(0==c?(m.length=h,u=1,h--):(m.length=h+1,u=y[d-c],m[h]=s>0?r(f/y[o-s]%y[s])*u:0),a)for(;;){if(0==h){for(c=1,s=m[0];s>=10;s/=10,c++);for(s=m[0]+=u,u=1;s>=10;s/=10,u++);c!=u&&(e.e++,m[0]==l&&(m[0]=1));break}if(m[h]+=u,m[h]!=l)break;m[h--]=0,u=1}for(c=m.length;0===m[--c];m.pop());}e.e>I?e.c=e.e=null:e.e<E&&(e.c=[e.e=0])}return e}function H(e){var t,n=e.e;return null===n?e.toString():(t=m(e.c),t=n<=P||n>=N?S(t,n):w(t,n,"0"),e.s<0?"-"+t:t)}return V.clone=e,V.ROUND_UP=0,V.ROUND_DOWN=1,V.ROUND_CEIL=2,V.ROUND_FLOOR=3,V.ROUND_HALF_UP=4,V.ROUND_HALF_DOWN=5,V.ROUND_HALF_EVEN=6,V.ROUND_HALF_CEIL=7,V.ROUND_HALF_FLOOR=8,V.EUCLID=9,V.config=V.set=function(e){var t,n;if(null!=e){if("object"!=(void 0===e?"undefined":a(e)))throw Error(c+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(v(n=e[t],0,h,t),B=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(v(n=e[t],0,8,t),L=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(v(n[0],-h,0,t),v(n[1],0,h,t),P=n[0],N=n[1]):(v(n,-h,h,t),P=-(N=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)v(n[0],-h,-1,t),v(n[1],1,h,t),E=n[0],I=n[1];else{if(v(n,-h,h,t),!n)throw Error(c+t+" cannot be zero: "+n);E=-(I=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(c+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw A=!n,Error(c+"crypto unavailable");A=n}else A=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(v(n=e[t],0,9,t),R=n),e.hasOwnProperty(t="POW_PRECISION")&&(v(n=e[t],0,h,t),O=n),e.hasOwnProperty(t="FORMAT")){if("object"!=(void 0===(n=e[t])?"undefined":a(n)))throw Error(c+t+" not an object: "+n);x=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(c+t+" invalid: "+n);M=n}}return{DECIMAL_PLACES:B,ROUNDING_MODE:L,EXPONENTIAL_AT:[P,N],RANGE:[E,I],CRYPTO:A,MODULO_MODE:R,POW_PRECISION:O,FORMAT:x,ALPHABET:M}},V.isBigNumber=function(e){return e instanceof V||e&&!0===e._isBigNumber||!1},V.maximum=V.max=function(){return G(arguments,D.lt)},V.minimum=V.min=function(){return G(arguments,D.gt)},V.random=function(){var e=9007199254740992*Math.random()&2097151?function(){return r(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(t){var n,a,o,s,l,u=0,f=[],g=new V(b);if(null==t?t=B:v(t,0,h),s=i(t/d),A)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(s*=2));u<s;)(l=131072*n[u]+(n[u+1]>>>11))>=9e15?(a=crypto.getRandomValues(new Uint32Array(2)),n[u]=a[0],n[u+1]=a[1]):(f.push(l%1e14),u+=2);u=s/2}else{if(!crypto.randomBytes)throw A=!1,Error(c+"crypto unavailable");for(n=crypto.randomBytes(s*=7);u<s;)(l=281474976710656*(31&n[u])+1099511627776*n[u+1]+4294967296*n[u+2]+16777216*n[u+3]+(n[u+4]<<16)+(n[u+5]<<8)+n[u+6])>=9e15?crypto.randomBytes(7).copy(n,u):(f.push(l%1e14),u+=7);u=s/7}if(!A)for(;u<s;)(l=e())<9e15&&(f[u++]=l%1e14);for(s=f[--u],t%=d,s&&t&&(l=p[d-t],f[u]=r(s/l)*l);0===f[u];f.pop(),u--);if(u<0)f=[o=0];else{for(o=-1;0===f[0];f.splice(0,1),o-=d);for(u=1,l=f[0];l>=10;l/=10,u++);u<d&&(o-=d-u)}return g.e=o,g.c=f,g}}(),V.sum=function(){for(var e=1,t=arguments,n=new V(t[0]);e<t.length;)n=n.plus(t[e++]);return n},C=function(){function e(e,t,n,a){for(var o,i,r=[0],c=0,s=e.length;c<s;){for(i=r.length;i--;r[i]*=t);for(r[0]+=a.indexOf(e.charAt(c++)),o=0;o<r.length;o++)r[o]>n-1&&(null==r[o+1]&&(r[o+1]=0),r[o+1]+=r[o]/n|0,r[o]%=n)}return r.reverse()}return function(t,a,o,i,r){var c,s,l,d,u,p,f,h,g=t.indexOf("."),y=B,v=L;for(g>=0&&(d=O,O=0,t=t.replace(".",""),p=(h=new V(a)).pow(t.length-g),O=d,h.c=e(w(m(p.c),p.e,"0"),10,o,"0123456789"),h.e=h.c.length),l=d=(f=e(t,a,o,r?(c=M,"0123456789"):(c="0123456789",M))).length;0==f[--d];f.pop());if(!f[0])return c.charAt(0);if(g<0?--l:(p.c=f,p.e=l,p.s=i,f=(p=n(p,h,y,v,o)).c,u=p.r,l=p.e),g=f[s=l+y+1],d=o/2,u=u||s<0||null!=f[s+1],u=v<4?(null!=g||u)&&(0==v||v==(p.s<0?3:2)):g>d||g==d&&(4==v||u||6==v&&1&f[s-1]||v==(p.s<0?8:7)),s<1||!f[0])t=u?w(c.charAt(1),-y,c.charAt(0)):c.charAt(0);else{if(f.length=s,u)for(--o;++f[--s]>o;)f[s]=0,s||(++l,f=[1].concat(f));for(d=f.length;!f[--d];);for(g=0,t="";g<=d;t+=c.charAt(f[g++]));t=w(t,l,c.charAt(0))}return t}}(),n=function(){function e(e,t,n){var a,o,i,r,c=0,s=e.length,l=t%f,d=t/f|0;for(e=e.slice();s--;)c=((o=l*(i=e[s]%f)+(a=d*i+(r=e[s]/f|0)*l)%f*f+c)/n|0)+(a/f|0)+d*r,e[s]=o%n;return c&&(e=[c].concat(e)),e}function t(e,t,n,a){var o,i;if(n!=a)i=n>a?1:-1;else for(o=i=0;o<n;o++)if(e[o]!=t[o]){i=e[o]>t[o]?1:-1;break}return i}function n(e,t,n,a){for(var o=0;n--;)e[n]-=o,o=e[n]<t[n]?1:0,e[n]=o*a+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(a,o,i,c,s){var u,p,f,h,m,y,v,_,S,w,C,T,D,b,B,L,P,N=a.s==o.s?1:-1,E=a.c,I=o.c;if(!(E&&E[0]&&I&&I[0]))return new V(a.s&&o.s&&(E?!I||E[0]!=I[0]:I)?E&&0==E[0]||!I?0*N:N/0:NaN);for(S=(_=new V(N)).c=[],N=i+(p=a.e-o.e)+1,s||(s=l,p=g(a.e/d)-g(o.e/d),N=N/d|0),f=0;I[f]==(E[f]||0);f++);if(I[f]>(E[f]||0)&&p--,N<0)S.push(1),h=!0;else{for(b=E.length,L=I.length,f=0,N+=2,(m=r(s/(I[0]+1)))>1&&(I=e(I,m,s),E=e(E,m,s),L=I.length,b=E.length),D=L,C=(w=E.slice(0,L)).length;C<L;w[C++]=0);P=I.slice(),P=[0].concat(P),B=I[0],I[1]>=s/2&&B++;do{if(m=0,(u=t(I,w,L,C))<0){if(T=w[0],L!=C&&(T=T*s+(w[1]||0)),(m=r(T/B))>1)for(m>=s&&(m=s-1),v=(y=e(I,m,s)).length,C=w.length;1==t(y,w,v,C);)m--,n(y,L<v?P:I,v,s),v=y.length,u=1;else 0==m&&(u=m=1),v=(y=I.slice()).length;if(v<C&&(y=[0].concat(y)),n(w,y,C,s),C=w.length,-1==u)for(;t(I,w,L,C)<1;)m++,n(w,L<C?P:I,C,s),C=w.length}else 0===u&&(m++,w=[0]);S[f++]=m,w[0]?w[C++]=E[D]||0:(w=[E[D]],C=1)}while((D++<b||null!=w[0])&&N--);h=null!=w[0],S[0]||S.splice(0,1)}if(s==l){for(f=1,N=S[0];N>=10;N/=10,f++);F(_,i+(_.e=f+p*d-1)+1,c,h)}else _.e=p,_.r=+h;return _}}(),T=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,t=/^([^.]+)\.$/,n=/^\.([^.]+)$/,a=/^-?(Infinity|NaN)$/,o=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(i,r,s,l){var d,u=s?r:r.replace(o,"");if(a.test(u))i.s=isNaN(u)?null:u<0?-1:1,i.c=i.e=null;else{if(!s&&(u=u.replace(e,function(e,t,n){return d="x"==(n=n.toLowerCase())?16:"b"==n?2:8,l&&l!=d?e:t}),l&&(d=l,u=u.replace(t,"$1").replace(n,"0.$1")),r!=u))return new V(u,d);if(V.DEBUG)throw Error(c+"Not a"+(l?" base "+l:"")+" number: "+r);i.c=i.e=i.s=null}}}(),D.absoluteValue=D.abs=function(){var e=new V(this);return e.s<0&&(e.s=1),e},D.comparedTo=function(e,t){return y(this,new V(e,t))},D.decimalPlaces=D.dp=function(e,t){var n,a,o,i=this;if(null!=e)return v(e,0,h),null==t?t=L:v(t,0,8),F(new V(i),e+i.e+1,t);if(!(n=i.c))return null;if(a=((o=n.length-1)-g(this.e/d))*d,o=n[o])for(;o%10==0;o/=10,a--);return a<0&&(a=0),a},D.dividedBy=D.div=function(e,t){return n(this,new V(e,t),B,L)},D.dividedToIntegerBy=D.idiv=function(e,t){return n(this,new V(e,t),0,1)},D.exponentiatedBy=D.pow=function(e,t){var n,a,o,s,l,u,p,f,h=this;if((e=new V(e)).c&&!e.isInteger())throw Error(c+"Exponent not an integer: "+H(e));if(null!=t&&(t=new V(t)),l=e.e>14,!h.c||!h.c[0]||1==h.c[0]&&!h.e&&1==h.c.length||!e.c||!e.c[0])return f=new V(Math.pow(+H(h),l?2-_(e):+H(e))),t?f.mod(t):f;if(u=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new V(NaN);(a=!u&&h.isInteger()&&t.isInteger())&&(h=h.mod(t))}else{if(e.e>9&&(h.e>0||h.e<-1||(0==h.e?h.c[0]>1||l&&h.c[1]>=24e7:h.c[0]<8e13||l&&h.c[0]<=9999975e7)))return s=h.s<0&&_(e)?-0:0,h.e>-1&&(s=1/s),new V(u?1/s:s);O&&(s=i(O/d+2))}for(l?(n=new V(.5),u&&(e.s=1),p=_(e)):p=(o=Math.abs(+H(e)))%2,f=new V(b);;){if(p){if(!(f=f.times(h)).c)break;s?f.c.length>s&&(f.c.length=s):a&&(f=f.mod(t))}if(o){if(0===(o=r(o/2)))break;p=o%2}else if(F(e=e.times(n),e.e+1,1),e.e>14)p=_(e);else{if(0==(o=+H(e)))break;p=o%2}h=h.times(h),s?h.c&&h.c.length>s&&(h.c.length=s):a&&(h=h.mod(t))}return a?f:(u&&(f=b.div(f)),t?f.mod(t):s?F(f,O,L,void 0):f)},D.integerValue=function(e){var t=new V(this);return null==e?e=L:v(e,0,8),F(t,t.e+1,e)},D.isEqualTo=D.eq=function(e,t){return 0===y(this,new V(e,t))},D.isFinite=function(){return!!this.c},D.isGreaterThan=D.gt=function(e,t){return y(this,new V(e,t))>0},D.isGreaterThanOrEqualTo=D.gte=function(e,t){return 1===(t=y(this,new V(e,t)))||0===t},D.isInteger=function(){return!!this.c&&g(this.e/d)>this.c.length-2},D.isLessThan=D.lt=function(e,t){return y(this,new V(e,t))<0},D.isLessThanOrEqualTo=D.lte=function(e,t){return-1===(t=y(this,new V(e,t)))||0===t},D.isNaN=function(){return!this.s},D.isNegative=function(){return this.s<0},D.isPositive=function(){return this.s>0},D.isZero=function(){return!!this.c&&0==this.c[0]},D.minus=function(e,t){var n,a,o,i,r=this,c=r.s;if(t=(e=new V(e,t)).s,!c||!t)return new V(NaN);if(c!=t)return e.s=-t,r.plus(e);var s=r.e/d,u=e.e/d,p=r.c,f=e.c;if(!s||!u){if(!p||!f)return p?(e.s=-t,e):new V(f?r:NaN);if(!p[0]||!f[0])return f[0]?(e.s=-t,e):new V(p[0]?r:3==L?-0:0)}if(s=g(s),u=g(u),p=p.slice(),c=s-u){for((i=c<0)?(c=-c,o=p):(u=s,o=f),o.reverse(),t=c;t--;o.push(0));o.reverse()}else for(a=(i=(c=p.length)<(t=f.length))?c:t,c=t=0;t<a;t++)if(p[t]!=f[t]){i=p[t]<f[t];break}if(i&&(o=p,p=f,f=o,e.s=-e.s),(t=(a=f.length)-(n=p.length))>0)for(;t--;p[n++]=0);for(t=l-1;a>c;){if(p[--a]<f[a]){for(n=a;n&&!p[--n];p[n]=t);--p[n],p[a]+=l}p[a]-=f[a]}for(;0==p[0];p.splice(0,1),--u);return p[0]?k(e,p,u):(e.s=3==L?-1:1,e.c=[e.e=0],e)},D.modulo=D.mod=function(e,t){var a,o,i=this;return e=new V(e,t),!i.c||!e.s||e.c&&!e.c[0]?new V(NaN):!e.c||i.c&&!i.c[0]?new V(i):(9==R?(o=e.s,e.s=1,a=n(i,e,0,3),e.s=o,a.s*=o):a=n(i,e,0,R),(e=i.minus(a.times(e))).c[0]||1!=R||(e.s=i.s),e)},D.multipliedBy=D.times=function(e,t){var n,a,o,i,r,c,s,u,p,h,m,y,v,_,S,w=this,C=w.c,T=(e=new V(e,t)).c;if(!(C&&T&&C[0]&&T[0]))return!w.s||!e.s||C&&!C[0]&&!T||T&&!T[0]&&!C?e.c=e.e=e.s=null:(e.s*=w.s,C&&T?(e.c=[0],e.e=0):e.c=e.e=null),e;for(a=g(w.e/d)+g(e.e/d),e.s*=w.s,(s=C.length)<(h=T.length)&&(v=C,C=T,T=v,o=s,s=h,h=o),o=s+h,v=[];o--;v.push(0));for(_=l,S=f,o=h;--o>=0;){for(n=0,m=T[o]%S,y=T[o]/S|0,i=o+(r=s);i>o;)n=((u=m*(u=C[--r]%S)+(c=y*u+(p=C[r]/S|0)*m)%S*S+v[i]+n)/_|0)+(c/S|0)+y*p,v[i--]=u%_;v[i]=n}return n?++a:v.splice(0,1),k(e,v,a)},D.negated=function(){var e=new V(this);return e.s=-e.s||null,e},D.plus=function(e,t){var n,a=this,o=a.s;if(t=(e=new V(e,t)).s,!o||!t)return new V(NaN);if(o!=t)return e.s=-t,a.minus(e);var i=a.e/d,r=e.e/d,c=a.c,s=e.c;if(!i||!r){if(!c||!s)return new V(o/0);if(!c[0]||!s[0])return s[0]?e:new V(c[0]?a:0*o)}if(i=g(i),r=g(r),c=c.slice(),o=i-r){for(o>0?(r=i,n=s):(o=-o,n=c),n.reverse();o--;n.push(0));n.reverse()}for((o=c.length)-(t=s.length)<0&&(n=s,s=c,c=n,t=o),o=0;t;)o=(c[--t]=c[t]+s[t]+o)/l|0,c[t]=l===c[t]?0:c[t]%l;return o&&(c=[o].concat(c),++r),k(e,c,r)},D.precision=D.sd=function(e,t){var n,a,o,i=this;if(null!=e&&e!==!!e)return v(e,1,h),null==t?t=L:v(t,0,8),F(new V(i),e,t);if(!(n=i.c))return null;if(a=(o=n.length-1)*d+1,o=n[o]){for(;o%10==0;o/=10,a--);for(o=n[0];o>=10;o/=10,a++);}return e&&i.e+1>a&&(a=i.e+1),a},D.shiftedBy=function(e){return v(e,-u,u),this.times("1e"+e)},D.squareRoot=D.sqrt=function(){var e,t,a,o,i,r=this,c=r.c,s=r.s,l=r.e,d=B+4,u=new V("0.5");if(1!==s||!c||!c[0])return new V(!s||s<0&&(!c||c[0])?NaN:c?r:1/0);if(0==(s=Math.sqrt(+H(r)))||s==1/0?(((t=m(c)).length+l)%2==0&&(t+="0"),s=Math.sqrt(+t),l=g((l+1)/2)-(l<0||l%2),a=new V(t=s==1/0?"1e"+l:(t=s.toExponential()).slice(0,t.indexOf("e")+1)+l)):a=new V(s+""),a.c[0])for((s=(l=a.e)+d)<3&&(s=0);;)if(i=a,a=u.times(i.plus(n(r,i,d,1))),m(i.c).slice(0,s)===(t=m(a.c)).slice(0,s)){if(a.e<l&&--s,"9999"!=(t=t.slice(s-3,s+1))&&(o||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(F(a,a.e+B+2,1),e=!a.times(a).eq(r));break}if(!o&&(F(i,i.e+B+2,0),i.times(i).eq(r))){a=i;break}d+=4,s+=4,o=1}return F(a,a.e+B+1,L,e)},D.toExponential=function(e,t){return null!=e&&(v(e,0,h),e++),U(this,e,t,1)},D.toFixed=function(e,t){return null!=e&&(v(e,0,h),e=e+this.e+1),U(this,e,t)},D.toFormat=function(e,t,n){var o,i=this;if(null==n)null!=e&&t&&"object"==(void 0===t?"undefined":a(t))?(n=t,t=null):e&&"object"==(void 0===e?"undefined":a(e))?(n=e,e=t=null):n=x;else if("object"!=(void 0===n?"undefined":a(n)))throw Error(c+"Argument not an object: "+n);if(o=i.toFixed(e,t),i.c){var r,s=o.split("."),l=+n.groupSize,d=+n.secondaryGroupSize,u=n.groupSeparator||"",p=s[0],f=s[1],h=i.s<0,g=h?p.slice(1):p,m=g.length;if(d&&(r=l,l=d,d=r,m-=r),l>0&&m>0){for(r=m%l||l,p=g.substr(0,r);r<m;r+=l)p+=u+g.substr(r,l);d>0&&(p+=u+g.slice(r)),h&&(p="-"+p)}o=f?p+(n.decimalSeparator||"")+((d=+n.fractionGroupSize)?f.replace(new RegExp("\\d{"+d+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):f):p}return(n.prefix||"")+o+(n.suffix||"")},D.toFraction=function(e){var t,a,o,i,r,s,l,u,f,h,g,y,v=this,_=v.c;if(null!=e&&(!(l=new V(e)).isInteger()&&(l.c||1!==l.s)||l.lt(b)))throw Error(c+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+H(l));if(!_)return new V(v);for(t=new V(b),f=a=new V(b),o=u=new V(b),y=m(_),r=t.e=y.length-v.e-1,t.c[0]=p[(s=r%d)<0?d+s:s],e=!e||l.comparedTo(t)>0?r>0?t:f:l,s=I,I=1/0,l=new V(y),u.c[0]=0;h=n(l,t,0,1),1!=(i=a.plus(h.times(o))).comparedTo(e);)a=o,o=i,f=u.plus(h.times(i=f)),u=i,t=l.minus(h.times(i=t)),l=i;return i=n(e.minus(a),o,0,1),u=u.plus(i.times(f)),a=a.plus(i.times(o)),u.s=f.s=v.s,g=n(f,o,r*=2,L).minus(v).abs().comparedTo(n(u,a,r,L).minus(v).abs())<1?[f,o]:[u,a],I=s,g},D.toNumber=function(){return+H(this)},D.toPrecision=function(e,t){return null!=e&&v(e,1,h),U(this,e,t,2)},D.toString=function(e){var t,n=this,a=n.s,o=n.e;return null===o?a?(t="Infinity",a<0&&(t="-"+t)):t="NaN":(t=m(n.c),null==e?t=o<=P||o>=N?S(t,o):w(t,o,"0"):(v(e,2,M.length,"Base"),t=C(w(t,o,"0"),10,e,a,!0)),a<0&&n.c[0]&&(t="-"+t)),t},D.valueOf=D.toJSON=function(){return H(this)},D._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==a(Symbol.iterator)&&(D[Symbol.toStringTag]="BigNumber",D[Symbol.for("nodejs.util.inspect.custom")]=D.valueOf),null!=t&&V.set(t),V}()).default=n.BigNumber=n,"function"==typeof define&&define.amd?define(function(){return n}):void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)})(void 0),cc._RF.pop()},{}],sdk:[function(e,t,n){"use strict";cc._RF.push(t,"39edaGlwhJIfYodzcoW73If","sdk");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){var e;return(e=console).info.apply(e,arguments)},i={init:function(e){var t=e.game_id,n=e.game_version,a=e.videoId,i=e.bannerId,r=e.onBannerPlaced,u=void 0===r?l:r,p=e.onBannerResize,f=void 0===p?d:p,h=e.configUseCdn,g=void 0!==h&&h,m=e.autoPullInterval,y=void 0===m?3:m,v=e.autoPullAllConfig,_=void 0===v||v,S=e.autoPullMainConfig,w=void 0===S||S,C=e.autoPullShare,T=void 0===C||C,D=e.autoPullInsideAds,b=void 0===D||D,B=e.autoPullWallAds,L=void 0!==B&&B,P=e.needReportTime,N=void 0!==P&&P,E=e.printLog,I=void 0===E||E,A=e.saveLog,R=void 0===A||A;this.game_id=t,this.game_version=n,this.video_ids=Array.isArray(a)?a:a?[a]:[],this.banner_ids=Array.isArray(i)?i:i?[i]:[],this.onBannerPlaced=u,this.onBannerResize=f,this.configUseCdn=g,this.autoPullInterval=y,this.autoPullMainConfig=w,this.autoPullShare=T,this.autoPullInsideAds=b,this.autoPullWallAds=L,this.needReportTime=N,o=I?function(){var e;return(e=console).info.apply(e,arguments)}:function(){},function(e){e&&s?(console.log=function(){c.log.apply(console,arguments),s.log.apply(s,arguments)},console.info=function(){c.info.apply(console,arguments),s.info.apply(s,arguments)},console.warn=function(){c.warn.apply(console,arguments),s.warn.apply(s,arguments)},console.debug=function(){c.debug.apply(console,arguments),s.debug.apply(s,arguments)}):(console.log=c.log,console.info=c.info,console.warn=c.warn,console.debug=c.debug)}(R),this.sys=window.wx&&wx.getSystemInfoSync?wx.getSystemInfoSync():{},o("\u6e38\u620f\u7248\u672c: ",this.game_version),o("SDK\u7248\u672c: ",this.version),this.banner_ids=this._shuffle(this.banner_ids),this.video_ids=this._shuffle(this.video_ids),this.video_ids.length>0&&this._loadRewardedVideoAd(),window.wx&&wx.offShow(this._runOnShowCallback),window.wx&&wx.onShow(this._runOnShowCallback),this.autoPullAllConfig=_},version:"0.1.15",game_id:"",game_version:1,pullCfg:!0,lastPullTime:0,_firstPull:!1,get autoPullAllConfig(){return this._autoPullAllConfig},set autoPullAllConfig(e){this.enablePullConfigOnShow(e)},configUseCdn:!1,banner_ids:[],banner_index:0,bannerMethod:{placedTop:function(e,t,n){return{width:n,top:0,left:.5*(e-n)}},placedBottom:l,resizeTop:function(e,t,n,a,o,i){return{top:0,left:i}},resizeBottom:d},onBannerPlaced:l,onBannerResize:d,video_ids:[],video_index:0,conf:{share_flag:-1,invite_flag:-1,prize_flag:-1,log_flag:-1,banner_refresh_interval:-1,authflag:-1,test_version:"",share_time_toast:"",share_group_toast:"",fake_share_gap:2,fake_share_fail_ratio:50,fake_share_fail_ratio_list:"0",day_share_count:100,share_chance:"",banner_height:"20",beginner_upgrade_finger:0,closebtn_delaytime:"0.5_1"},insideAds:{desc:"\u5185\u63a8\u5e7f\u544a",name:"get_list",url:"https://list.xiaoyouxiqun.com/get_list.php",url_cdn:"https://datacache.xiaoyouxiqun.com/promotion/list/",list:[],conf:{},onChanged:null,hasAds:function(){return(!window.wx||"function"==typeof wx.navigateToMiniProgram)&&Array.isArray(this.list)&&this.list.length>0},user_id:""},wallAds:{desc:"\u8bd5\u73a9\u5899",name:"get_wall",url:"https://list.xiaoyouxiqun.com/get_wall.php",url_cdn:"https://datacache.xiaoyouxiqun.com/promotion/wall/",list:[],conf:{},onChanged:null,hasAds:function(){return(!window.wx||"function"==typeof wx.navigateToMiniProgram)&&Array.isArray(this.list)&&this.list.length>0},user_id:""},onRewardsADClosed:null,onRewardsADLoaded:null,onRemoteLoaded:null,sys:{},pullMainConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;i.configUseCdn?i._getRemoteConfigByCdn(e,t):i._getRemoteConfig(e,t),i._firstPull=!0},pullOtherConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{inside:!0,wall:!0,share:!0},t={inside:!0,wall:!0,share:!0};i.extend(t,e),(e=t).inside&&i._getAds(i.insideAds),e.wall&&i._getAds(i.wallAds),e.share&&i._getRemoteShareConfig()},enablePullConfigOnShow:function(e){this._autoPullAllConfig=e,i.offShow("sdk"),e&&i.onShow("sdk",function(e){var t=(new Date).getTime()/1e3-i.lastPullTime;i.pullCfg&&t>i.autoPullInterval?(i.lastPullTime=(new Date).getTime()/1e3,i.autoPullMainConfig&&i.pullMainConfig(),i.pullOtherConfig({inside:i.autoPullInsideAds,wall:i.autoPullWallAds,share:i.autoPullShare})):i.pullCfg=!0},0,!i._firstPull)},onShow:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this._onShowList.findIndex(function(t){return t.name==e});if(-1!==o){var i=this._onShowList[o];i.callback=t,i.order=n}else this._onShowList.push({name:e,callback:t,order:n});a&&window.wx&&t&&t(wx.getLaunchOptionsSync())},offShow:function(e){var t=this._onShowList.findIndex(function(t){return t.name==e});return t>=0&&this._onShowList.splice(t,1),t>=0},getUserInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o("SDK.getUserInfo"),this._checkWx(t,n)&&wx.getUserInfo({withCredentials:!0,lang:"zh_CN",success:e,fail:t,complete:n})},updateScore:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(o("SDK.updateScore "+JSON.stringify(e)),this._checkWx(n,a,"setUserCloudStorage")){var i=this._objectToKVArray(e);o("kv array "+JSON.stringify(i)),wx.setUserCloudStorage({KVDataList:i,success:t,fail:n,complete:a})}},enableShare:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o("SDK.enableShare"),this._checkWx(n,a,"showShareMenu")&&(this._shareEnabled||wx.showShareMenu({withShareTicket:!0,success:function(n){t._shareEnabled=!0,e&&e(n)},fail:function(e){n&&n(e),a&&a(e)}}))},onShare:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(o("SDK.onShare"),this._checkWx(r,c)){var s=[],l=[];Array.isArray(e)?e.forEach(function(e){return s.push(e)}):s.push(e),Array.isArray(t)?t.forEach(function(e){return l.push(e)}):l.push(t);var d=function(e){i.pullCfg=!1;var t="",o="";if(0!=s.length){var d=Math.round(1e11*Math.random())%s.length;t=s[d]}if(0!=l.length){var u=Math.round(1e11*Math.random())%l.length;o=l[u]}return{title:t,imageUrl:o,query:n||"",success:a,fail:r,complete:c}};this._shareEnabled?wx.onShareAppMessage(d):this.enableShare(function(){wx.onShareAppMessage(d)},r,c)}},offShare:function(){o("SDK.offShare"),this._checkWx()&&wx.offShareAppMessage()},onShareWithCallback:function(e){o("SDK.onShareWithCallback"),this._checkWx()&&(this._shareEnabled?wx.onShareAppMessage(e):this.enableShare(function(){wx.onShareAppMessage(e)}))},offShareWithCallback:function(e){o("SDK.offShareWithCallback"),this._checkWx()&&wx.offShareAppMessage(e)},share:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(o("SDK.share"),this._checkWx(r,c)){i.pullCfg=!1;var l={title:e,imageUrl:t,query:n||"",success:a,fail:r,complete:c,cancel:s};this._shareEnabled?wx.shareAppMessage(l):this.enableShare(function(){wx.shareAppMessage(l)},r,c)}},subMsg:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o("SDK.subMsg"),this._checkWx(t,null,"getOpenDataContext")&&wx.getOpenDataContext().postMessage(e)},showToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;o("SDK.showToast"),this._checkWx(a,i)&&wx.showToast({title:e,icon:"none",image:r||void 0,duration:t||1500,success:n,fail:a,complete:i})},showModal:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(o("SDK.showModal"),this._checkWx(a,i)){var r=!1;a&&(r=!0),wx.showModal({title:e,content:t,showCancel:r,cancelText:"\u53d6\u6d88",confirmText:"\u786e\u5b9a",success:n,fail:a,complete:i})}},openSetting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o("SDK.openSetting"),this._checkWx(t,n)&&wx.openSetting({success:e,fail:t,complete:n})},showLoading:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;o("SDK.showLoading"),this._checkWx(a,i,"showLoading")&&wx.showLoading({title:e,mask:t,onSuccess:n,onFail:a,onComplete:i})},hideLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o("SDK.hideLoading"),this._checkWx(t,n,"hideLoading")&&wx.hideLoading({onSuccess:e,onFail:t,onComplete:n})},_rewardsAdLoaded:!1,hasVideo:function(){return o("SDK.hasVideo"),this._videoAd&&this._videoAd.isReady?this._videoAd.isReady():this.video_ids.length>0&&this._videoAd&&this._rewardsAdLoaded},showVideo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o("SDK.showVideo"),this.video_ids.length>0?this._videoAd?(this.onRewardsADClosed=t,this._videoAd.load().then(function(){o("\u5e7f\u544a\u5bf9\u8c61: ",e._videoAd),e._videoAd.show().then(function(){e._rewardsAdLoaded=!1,o("\u89c6\u9891\u5e7f\u544a\u64ad\u653e\u6210\u529f!")}).catch(function(e){o("\u89c6\u9891\u5e7f\u544a\u64ad\u653e\u5931\u8d25: ",e),n&&n(e)})}).catch(function(e){o("\u89c6\u9891\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25: ",e),n&&n(e)})):(o("\u89c6\u9891\u5e7f\u544a\u7ec4\u4ef6\u672a\u521b\u5efa!"),n&&n({errMsg:"\u89c6\u9891\u5e7f\u544a\u7ec4\u4ef6\u672a\u521b\u5efa!"})):(o("\u672a\u542f\u7528\u89c6\u9891\u5e7f\u544a!"),n&&n({errMsg:"\u672a\u542f\u7528\u89c6\u9891\u5e7f\u544a!"}))},_bannerTimer:0,_bannerVisible:!1,_bannerHasShow:!1,showBanner:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(o("SDK.showBanner"),this._bannerVisible=!1,this._bannerHasShow=!0,this.banner_ids.length>0){var n=function(t){t>0&&(clearTimeout(e._bannerTimer),e._bannerTimer=setTimeout(function(){e._banner&&(o("\u5b9a\u65f6\u79fb\u9664\u6a2a\u5e45\u5e7f\u544a"),e._banner.destroy(),e._banner=null,e._bannerVisible=!1),o("\u5b9a\u65f6\u91cd\u65b0\u663e\u793a\u6a2a\u5e45\u5e7f\u544a"),e._bannerTimer=setTimeout(function(){e.showBanner()},60)},1e3*t))},a=function(){o("\u6a2a\u5e45\u5e7f\u544a\u663e\u793a\u6210\u529f!"),e._bannerVisible=!0,n(e.conf.banner_refresh_interval),t&&t()},i=function(t){o("\u6a2a\u5e45\u5e7f\u544a\u663e\u793a\u5931\u8d25! ",t),o("\u5c06\u5728"+e.conf.banner_refresh_interval+"\u79d2\u540e\u91cd\u8bd5(hideBanner\u4f1a\u53d6\u6d88\u91cd\u8bd5)"),n(e.conf.banner_refresh_interval)},r=function(){e._createBannerAd(function(){var t=e._banner.show();t?t.then(function(){a()}).catch(function(e){i(e)}):i()},function(e){i(e)})};if(clearTimeout(this._bannerTimer),this._banner){var c=this._banner.show();c?c.then(function(){a()}).catch(function(e){r()}):r()}else r()}else o("SDK.showBanner: \u65e0\u6a2a\u5e45\u5e7f\u544aID!")},hideBanner:function(){o("SDK.hideBanner"),this._bannerVisible=!1,this._bannerHasShow=!1,this._banner&&this._banner.hide(),clearTimeout(this._bannerTimer),this._bannerTimer=0},removeBanner:function(){o("SDK.removeBanner"),this._bannerVisible=!1,this._banner&&(this._banner.destroy(),this._banner=null),this._bannerTimer&&(clearTimeout(this._bannerTimer),this._bannerTimer=0)},showImage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;o("SDK.showImage"),this._checkWx(n,a)&&wx.previewImage({current:e,urls:[e],success:function(e){i.pullCfg=!1,t&&t(e)},fail:n,complete:a})},showInsideAds:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;o("SDK.showInsideAds, id:",e.app_id," path:",e.app_path);e.app_id,e.app_path;window.wx&&"function"==typeof wx.navigateToMiniProgram&&e.app_id?wx.navigateToMiniProgram({appId:e.app_id,path:e.app_path,extraData:"",success:function(e){o("\u8df3\u8f6c\u81f3\u5c0f\u7a0b\u5e8f\u6210\u529f: ",e),t&&t(e)},fail:function(e){o("\u8df3\u8f6c\u81f3\u5c0f\u7a0b\u5e8f\u5931\u8d25: ",e),n&&n()},complete:a}):(o("\u4e0d\u652f\u6301\u8df3\u8f6c\u81f3\u5c0f\u7a0b\u5e8f"),n&&n(),a&&a())},getShareConfig:function(e){if(!this._shareConfig)return null;var t=this._shareConfig.findIndex(function(t){return t.position_id==e});if(-1==t)return null;var n=this._shareConfig[t];return n.share_pic_local?(o("\u4f7f\u7528\u8fdc\u7a0b\u5206\u4eab\u914d\u7f6e: ",e,"  config: ",n),n):null},shareStat:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.request({url:"https://share.xiaoyouxiqun.com/report.php",data:{position_id:e,share_id:t,self:n},success:function(e){o("\u5206\u4eab\u7edf\u8ba1\u63d0\u4ea4\u6210\u529f: ",e)},fail:function(e){o("\u5206\u4eab\u7edf\u8ba1\u63d0\u4ea4\u5931\u8d25: ",e)}})},compareVersion:function(e,t){"string"!=typeof e&&(e=e.toString?e.toString():"0"),"string"!=typeof t&&(t=t.toString?t.toString():"0");for(var n=e.split("."),a=t.split("."),o=Math.max(n.length,a.length),i=0,r=0;r<o&&0==(i=(parseInt(n[r])||0)-(parseInt(a[r])||0));++r);return i},checkWxVersion:function(e){return this._checkWx()?this.compareVersion(this.sys.version,e):-1},checkWxSdkVersion:function(e){return this._checkWx()?this.compareVersion(this.sys.SDKVersion||"1.0.1",e):-1},isIos:function(){return!!this._checkWx()&&("ios"==this.sys.platform||this.sys.system.indexOf("iOS")>=0)},isAndroid:function(){return!!this._checkWx()&&("android"==this.sys.platform||this.sys.system.indexOf("Android")>=0)},isIphoneX:function(){return!!this._checkWx()&&!!this.sys.model.match("iPhone X")},reportTime:function(e,t,n){var a=this;window.wx&&Promise.all([this.promisify(wx.getBatteryInfo),this.promisify(wx.getNetworkType)]).then(function(i){var r=a.sys||{},c={sdk_version:r.SDKVersion,version:r.version,model:r.model,system:r.system,battery_level:i[0].level,network_type:i[1].networkType,game_id:a.game_id,tag:e,code:t,time_used:n};o("\u51c6\u5907\u4e0a\u62a5\u8bf7\u6c42\u65f6\u95f4: ",c),a.request({url:"https://report.xiaoyouxiqun.com/report_time.php",data:{data:JSON.stringify(c)},success:function(e){o("\u4e0a\u62a5\u8bf7\u6c42\u65f6\u95f4\u6210\u529f: ",e)},fail:function(e){o("\u4e0a\u62a5\u8bf7\u6c42\u65f6\u95f4\u5931\u8d25: ",e)}})})},reportAdsClick:function(e,t){var n=this;if(window.wx){this.getUserIdOrCode("report_click",function(a){a.page=e,a.tag=t;var i=wx.getLaunchOptionsSync();a.reserve=i.query&&i.query.agent||"official",n.request({url:"https://report.xiaoyouxiqun.com/report_click.php",data:a,success:function(a){n.saveUserId("report_click",a),o("\u4e0a\u62a5\u70b9\u51fb["+e+", "+t+"]\u6210\u529f: ",a)},fail:function(n){o("\u4e0a\u62a5\u70b9\u51fb["+e+", "+t+"]\u5931\u8d25: ",n)}})})}},promisify:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("string"==typeof e){if(!window.wx||!window.wx[e])return Promise.reject({errMsg:"[SDK.promisify]\u5931\u8d25: \u65b9\u6cd5"+e+"\u5728\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u4e0d\u5b58\u5728!"});n=window.wx[e]}return n?new Promise(function(e,a){t.success=function(t){return e(t)},t.fail=function(e){return a(e)},n(t)}):Promise.reject({errMsg:"[SDK.promisify]\u5931\u8d25: \u65b9\u6cd5\u5728\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u4e0d\u5b58\u5728!"})},setStorage:function(e,t){var n=JSON.stringify({v:t});window.wx?wx.setStorage({key:e,data:n}):window.localStorage&&window.localStorage.setItem(e,n)},getStorageSync:function(e){var t="",n=null;window.wx?t=wx.getStorageSync(e):window.localStorage&&(t=window.localStorage.getItem(e));try{n=JSON.parse(t).v}catch(e){n=null}return n},getStorage:function(e,t){window.wx?t&&wx.getStorage({key:e,success:function(e){var n=null;try{n=JSON.parse(e.data).v}catch(e){n=null}t(n)},fail:function(e){t(null)}}):window.localStorage?t&&t(this.getStorageSync(e)):t&&t(null)},_getUserIdKey:function(e){return"wx_uid_"+e},getSavedUserId:function(e){return this.getStorageSync(this._getUserIdKey(e))||""},getUserCode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._checkWx(t,null,"login")&&wx.login({success:function(t){o("\u8bf7\u6c42\u767b\u5f55\u5fae\u4fe1\u6210\u529f: ",t);var n=t.code;e&&e({code:n})},fail:function(e){o("\u8bf7\u6c42\u767b\u5f55\u5fae\u4fe1\u5931\u8d25: ",e),t&&t(e)}})},getUserIdOrCode:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._checkWx(a,null,"checkSession")&&this.getStorage(this._getUserIdKey(e),function(e){e?wx.checkSession({success:function(t){o("\u767b\u5f55\u672a\u8d85\u65f6, \u4f7f\u7528\u672c\u5730user_id"),n&&n({user_id:e})},fail:function(e){o("\u767b\u5f55\u8d85\u65f6, \u91cd\u65b0\u5fae\u4fe1\u767b\u5f55: ",e),t.getUserCode(n,a)}}):(o("\u672c\u5730\u65e0user_id, \u4f7f\u7528\u5fae\u4fe1\u767b\u5f55\u83b7\u53d6code"),t.getUserCode(n,a))})},saveUserId:function(e,t){t&&t.data&&t.data.user_id&&this.setStorage(this._getUserIdKey(e),t.data.user_id)},request:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{url:url,data:data,success:success,fail:fail,complete:complete};this._checkWx(e.fail,e.complete,"request")&&(!e.data&&(e.data={}),!e.data.game_id&&(e.data.game_id=this.game_id),!e.data.version&&(e.data.version=this.game_version),!e.method&&(e.method="POST"),!e.header&&(e.header={"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}),"undefined"!=typeof qq&&!e.login_type&&(e.login_type="qq"),o("\u53d1\u9001\u7f51\u7edc\u8bf7\u6c42: ",e),wx.request(e))},getAddons:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{})||{};if(!this._checkWx(null,null,"getLaunchOptionsSync"))return a;var o=wx.getLaunchOptionsSync();return e&&(a.cid=o.query&&o.query.cid?o.query.cid:"self"),t&&(a.agent=o.query&&o.query.agent?o.query.agent:"official"),n&&i.sys&&i.sys.platform&&"string"==typeof i.sys.platform&&(a.os=i.sys.platform.toLowerCase(),"android"!=a.os&&"ios"!=a.os&&(a.os="android")),a},getDataFromRes:function(e){if(e&&200==e.statusCode&&e.data){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(n){t=e.data}return t}return null},isPlainObject:function(e){return"object"===(void 0===e?"undefined":a(e))&&(!e.constructor||e.constructor.prototype===Object.prototype)},extend:function(){var e,t,n,o,r,c,s=arguments[0]||{},l=1,d=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},l=2),"object"!==(void 0===s?"undefined":a(s))&&"function"!=typeof s&&(s={}),d===l&&(s=this,--l);l<d;l++)if(null!=(e=arguments[l]))for(t in e)n=s[t],s!==(o=e[t])&&(u&&o&&(i.isPlainObject(o)||(r=Array.isArray(o)))?(r?(r=!1,c=n&&Array.isArray(n)?n:[]):c=n&&i.isPlainObject(n)?n:{},s[t]=i.extend(u,c,o)):void 0!==o&&(s[t]=o));return s},_shareEnabled:!1,_checkWx:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"undefined"==typeof wx?(e&&e(),t&&t(),!1):!n||void 0!=wx[n]||(e&&e({code:999,errMsg:"\u8bf7\u5347\u7ea7\u4f60\u7684\u5fae\u4fe1\u7248\u672c!"}),t&&t(),!1)},_objectToKVArray:function(e){if(Array.isArray(e))return e;var t=[];if(e instanceof Object)for(var n in e)t.push({key:n,value:e[n]+""});return t},_kvArrayToObject:function(e){var t={};return e.forEach(function(e){void 0!=e.key&&void 0!=e.value&&(t[e.key]=e.value)}),t},_onShowList:[],_runOnShowCallback:function(e){o("_runOnShowCallback: ",e),i._onShowList.sort(function(e,t){return t.order-e.order}),i._onShowList.slice(0).forEach(function(t){t&&t.callback&&t.callback(e)})},_getRemoteConfigByCdn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._checkWx(n,a,"request")){var i=(new Date).getTime(),r={name:"get_conf",t:(new Date).getTime()};"undefined"!=typeof qq&&(r.login_type="qq"),wx.request({url:"https://datacache.xiaoyouxiqun.com/conf/"+this.game_id+".json",method:"GET",data:r,header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(n){var a=(new Date).getTime();t.needReportTime&&t.reportTime("conf",0,a-i);var r=t.getDataFromRes(n);r?r.verify_version==t.game_version?o("[\u62c9\u53d6\u914d\u7f6eCDN]\u4e3a\u5ba1\u6838\u7248\u672c"):(o("[\u62c9\u53d6\u914d\u7f6eCDN]\u6210\u529f: ",n),t.conf=r.game_config||{},t._processConfigForChannel(r.channel_config),t._processAdsFromConf(),t.onRemoteLoaded&&t.onRemoteLoaded(t.conf)):o("[\u62c9\u53d6\u914d\u7f6eCDN]\u914d\u7f6e\u4e3a\u7a7a"),e&&e(n)},fail:function(e){var a=(new Date).getTime();t.needReportTime&&t.reportTime("conf",1,a-i),o("[\u62c9\u53d6\u914d\u7f6eCDN]\u5931\u8d25: ",e),n&&n(e)},complete:a})}},_processConfigForChannel:function(e){if(e&&Array.isArray(e)){var t=wx.getLaunchOptionsSync(),n=t.query&&t.query.cid?t.query.cid:"",a=e.findIndex(function(e){return e.cid==n});if(-1!=a){var i=this.queryToObject(e[a].conf);o("[\u62c9\u53d6\u914d\u7f6eCDN]\u5f53\u524d\u6e20\u9053\u914d\u7f6e: ",i),this.extend(this.conf,i)}else o("[\u62c9\u53d6\u914d\u7f6eCDN]\u6e20\u9053\u914d\u7f6e\u4e0d\u5305\u542b\u5f53\u524d\u6e20\u9053: ",n)}else o("[\u62c9\u53d6\u914d\u7f6eCDN]\u6e20\u9053\u914d\u7f6e\u4e0d\u5b58\u5728")},queryToObject:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.substring(e.indexOf("?")+1).split("&"),n={},a=0,o=t.length;a<o;a++){var i=t[a].indexOf("=");if(-1!=i){var r=t[a].substring(0,i),c=window.decodeURIComponent(t[a].substring(i+1));n[r]=c}}return n},_getRemoteConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getAddons(!0,!1,!0),c=(new Date).getTime();this.request({url:"https://list.xiaoyouxiqun.com/conf.php",data:r,success:function(n){var a=(new Date).getTime();t.needReportTime&&t.reportTime("conf",0,a-c);var r=t.getDataFromRes(n);r&&0==r.code&&r.conf?(t.conf=r.conf,t._processAdsFromConf(),o("\u8fdc\u7a0b\u62c9\u53d6\u914d\u7f6e\u6210\u529f: ",n),i.onRemoteLoaded&&i.onRemoteLoaded(t.conf)):o("\u8fdc\u7a0b\u62c9\u53d6\u914d\u7f6e\u6210\u529f(\u4f46code!=0\u6216conf\u4e0d\u5b58\u5728): ",n),e&&e(n)},fail:function(e){var a=(new Date).getTime();t.needReportTime&&t.reportTime("conf",1,a-c),o("\u8fdc\u7a0b\u62c9\u53d6\u914d\u7f6e\u5931\u8d25: ",e),n&&n(e)},complete:a})},_processAdsFromConf:function(){(this.conf.video_ids||this.conf.video_id)&&(i._addVideoId(this.conf.video_ids||this.conf.video_id),i.video_ids.length>0&&!i.hasVideo()&&i._loadRewardedVideoAd()),(this.conf.banner_ids||this.conf.banner_id)&&(i._addBannerId(this.conf.banner_ids||this.conf.banner_id),i.banner_ids.length>0&&!i._bannerVisible&&i._bannerHasShow&&i.showBanner())},_shareConfig:null,_getRemoteShareConfig:function(){var e=this;this.request({url:"https://share.xiaoyouxiqun.com/share_list.php",success:function(t){var n=e.getDataFromRes(t);0==n.code&&Array.isArray(n.share)?(o("\u8fdc\u7a0b\u62c9\u53d6\u5206\u4eab\u914d\u7f6e\u6210\u529f: ",n),e._shareConfig=n.share,e._loadShareImage()):(o("\u8fdc\u7a0b\u62c9\u53d6\u5206\u4eab\u914d\u7f6e\u5931\u8d25: ",t),e._shareConfig=null)},fail:function(t){o("\u8fdc\u7a0b\u62c9\u53d6\u5206\u4eab\u914d\u7f6e\u5931\u8d25: ",t),e._shareConfig=null}})},_downloadedFiles:[],_loadShareImage:function(){var e=this,t=this._shareConfig,n=[],a=function(e,a){n.push(e+JSON.stringify(a)),n.length>=t.length&&o("\u4e0b\u8f7d\u5206\u4eab\u56fe\u7247\u5b8c\u6210: ",n)};t.forEach(function(t,n){var o=e._downloadedFiles.findIndex(function(e){return e.url==t.share_pic});if(-1!=o){var i=e._downloadedFiles[o];return t.share_pic_local=i.file,void a("\u4f7f\u7528\u5df2\u7ecf\u4e0b\u597d\u7684\u6587\u4ef6:",i.file)}setTimeout(function(){if("devtools"==e.sys.platform)return t.share_pic_local=t.share_pic,e._downloadedFiles.push({url:t.share_pic,file:t.share_pic}),void a("\u4e0b\u8f7d\u6587\u4ef6\u6210\u529f:",t);wx.downloadFile({url:t.share_pic,header:{},success:function(n){200==n.statusCode?(a("\u4e0b\u8f7d\u6587\u4ef6\u6210\u529f:",n),t.share_pic_local=n.tempFilePath,e._downloadedFiles.push({url:t.share_pic,file:n.tempFilePath})):a("\u4e0b\u8f7d\u6587\u4ef6\u51fa\u9519:",n)},fail:function(e){a("\u4e0b\u8f7d\u6587\u4ef6\u51fa\u9519:",e)}})},200*n)})},_getAds:function(e){this.configUseCdn?this._getAdsCdn(e):this._getAdsNormal(e)},_getAdsCdn:function(e){var t=this;if(this._checkWx(null,null,"request")){var n={name:e.name,t:(new Date).getTime()};"undefined"!=typeof qq&&(n.login_type="qq"),wx.request({url:e.url_cdn+this.game_id+".json",method:"GET",data:n,header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(n){var a=t.getDataFromRes(n);if(a)if(a.verify_version==t.game_version)o("[\u62c9\u53d6"+e.desc+"CDN]\u4e3a\u5ba1\u6838\u7248\u672c");else{if(o("[\u62c9\u53d6"+e.desc+"CDN]\u6210\u529f: ",a),a.mask_channel){var i=wx.getLaunchOptionsSync(),r=i.query&&i.query.cid?i.query.cid:"self";if(a.mask_channel.split(",").indexOf(r)>-1)return o("[\u62c9\u53d6"+e.desc+"CDN]\u4e3a\u5c4f\u853d\u6e20\u9053: ",r),e.list=[],e.conf={},void(e.onChanged&&e.onChanged(e))}e.list=Array.isArray(a.list)?a.list:[],t.isIos()&&(e.list=e.list.filter(function(e){return 1!=e.mask_ios})),1==a.random_flag&&t._shuffle(e.list),e.conf=a.game_config||{},e.onChanged&&e.onChanged(e)}else o("[\u62c9\u53d6"+e.desc+"CDN]\u4e3a\u7a7a")},fail:function(t){o("\u8fdc\u7a0b\u62c9\u53d6"+e.desc+"\u5931\u8d25: ",t)}})}},_getAdsNormal:function(e){var t=this;e.url&&this.getUserIdOrCode(e.name,function(n){var a=t.getAddons(!0,!0,!0,n);t.request({url:e.url,data:a,success:function(n){var a=t.getDataFromRes(n);a&&0==a.code?(t.saveUserId(e.name,n),o("\u8fdc\u7a0b\u62c9\u53d6"+e.desc+"\u6210\u529f: ",a),e.list=Array.isArray(a.list)?a.list:[],e.conf=a.conf||{},e.onChanged&&e.onChanged(e)):o("\u8fdc\u7a0b\u62c9\u53d6"+e.desc+"\u5931\u8d25: ",n)},fail:function(t){o("\u8fdc\u7a0b\u62c9\u53d6"+e.desc+"\u5931\u8d25: ",t)}})},function(t){o("\u8fdc\u7a0b\u62c9\u53d6"+e.desc+"\u5931\u8d25: ",t)})},_bannerResetPosition:!1,_createBannerAd:function(e,t){var n=this;if(o("SDK._createBannerAd"),this._checkWx(null,null,"createBannerAd")){if(0!=this.banner_ids.length){this._banner&&(this._banner.destroy(),this._banner=null);var a=this.banner_ids[this.banner_index];o("\u521b\u5efa\u6a2a\u5e45\u5e7f\u544a("+this.banner_index+"): "+a);var i=this.sys.screenWidth,r=this.sys.screenHeight,c="undefined"!=typeof qq?i:300;return this._bannerResetPosition=!1,this._banner=wx.createBannerAd({adUnitId:a,style:this.onBannerPlaced(i,r,c)}),this._banner.onResize&&this._banner.onResize(function(e){if(!n._bannerResetPosition&&e.height>0){var t=n.onBannerResize(i,r,e.width,e.height,n._banner.style.top,n._banner.style.left);n._banner.style.top!=t.top&&(n._banner.style.top=t.top),n._banner.style.left!=t.left&&(n._banner.style.left=t.left),n._bannerResetPosition=!0}}),this._banner.onLoad(e),this._banner.onError(t),this._banner}o("SDK._createBannerAd: \u65e0\u6a2a\u5e45\u5e7f\u544aID")}else o("\u5fae\u4fe1\u7248\u672c\u4e0d\u652f\u6301\u6a2a\u5e45\u5e7f\u544a!")},_loadRewardedVideoAd:function(){if(o("SDK._loadRewardedVideoAd"),this._checkWx(null,null,"createRewardedVideoAd")){var e=this.video_ids[this.video_index];o("\u521b\u5efa\u89c6\u9891\u5e7f\u544a("+this.video_index+"): "+e),this._videoAd=wx.createRewardedVideoAd({adUnitId:e}),o("\u89c6\u9891\u5e7f\u544a\u5df2\u521b\u5efa: ",this._videoAd),this._bindVideoEvent()}else o("\u5fae\u4fe1\u7248\u672c\u4e0d\u652f\u6301\u89c6\u9891\u5e7f\u544a!")},_bindVideoEvent:function(){var e=this;this._rewardsAdEventBind||(this._videoAd.onClose(function(t){if(o("\u770b\u5b8c\u5e7f\u544a\u56de\u8c03\u53c2\u6570: ",t),e.onRewardsADClosed){var n=!t||void 0===t.isEnded||t.isEnded;e.onRewardsADClosed(n)}}),this._videoAd.onLoad(function(){o("\u4e00\u6761\u89c6\u9891\u5e7f\u544a\u52a0\u8f7d\u6210\u529f!"),e._rewardsAdLoaded=!0,e.onRewardsADLoaded&&e.onRewardsADLoaded()}),this._videoAd.onError(function(t){if(o("\u52a0\u8f7d\u4e00\u6761\u89c6\u9891\u5e7f\u544a\u65f6\u51fa\u9519\u4e86: ",t),e._rewardsAdLoaded=!1,e.video_index+=1,e.video_index<15){var n=e.video_ids[e.video_index%e.video_ids.length];o("\u91cd\u65b0\u52a0\u8f7d\u89c6\u9891\u5e7f\u544a("+e.video_index+"): "+n),e._videoAd=wx.createRewardedVideoAd({adUnitId:n})}}),this._rewardsAdEventBind=!0)},_addBannerId:function(e){this._mergeAdsId(this.banner_ids,e,"banner_index")},_addVideoId:function(e){this._mergeAdsId(this.video_ids,e,"video_index")},_mergeAdsId:function(e,t,n){o("SDK._mergeAdsId: ",t),o("\u6dfb\u52a0\u5e7f\u544aID\u524d: ids("+e+"), "+n+"("+this[n]+")");var a=e.length,i=(t+"").split(",").filter(function(e){return e});if(i.length>0){(i=i.map(function(e){return e.trim?e.trim():e})).forEach(function(t){return e.push(t)});for(var r=e.length-1;r>=0;--r)for(var c=r-1;c>=0;--c)if(!e[r]||e[r]==e[c]){e.splice(r,1);break}}var s=e.length;s>a&&(this[n]%=s),o("\u6dfb\u52a0\u5e7f\u544aID\u540e: ids("+e+"), "+n+"("+this[n]+")")},_shuffle:function(e){for(var t,n,a=e.length;0!==a;)n=Math.floor(Math.random()*a),t=e[a-=1],e[a]=e[n],e[n]=t;return e}};if(void 0!==t&&(t.exports=i),window.SDK=i,"undefined"!=typeof wx&&"function"==typeof wx.getUpdateManager){var r=wx.getUpdateManager();r.onCheckForUpdate(function(e){o("hasUpdate:"+e.hasUpdate)}),r.onUpdateReady(function(){r.applyUpdate()}),r.onUpdateFailed(function(){})}var c={log:console.log,info:console.info,warn:console.warn,debug:console.debug},s=window.wx&&"function"==typeof wx.getLogManager?wx.getLogManager():null;function l(e,t,n){return{width:n,top:t-104,left:.5*(e-n)}}function d(e,t,n,a,o,i){return{top:t-a,left:i}}cc._RF.pop()},{}]},{},["Base64","CommonUils","ConfigID","DataID","DataManager","EventID","MyToast","PlatformMgr","PrefabID","ReportEventID","BuffConfig","DescConfig","DetailConfig","GardenConfig","PlantConfig","TeachConfig","DataStorage","GameHelper","MathUtil","OpenData","ReportLogic","ResourcesManager","ResourcesPool","RewardLogic","Server","ShareLogic","UserInfoBtn","BuffData","GameData","GardenData","PlantData","SignInData","CCActionConvert","InsideAds2","JNodePool","bignumber","sdk","Loading","AtlasLogic","BuffLogic","CollectLogic","EconomicLogic","GardenLogic","PlantLogic","ShopLogic","TeachLogic","Main","BgSoundClip","SoundClip","SoundManager","AtlasCardView","AtlasItem","AtlasView","View","BuffBtn","BuffItem","BuffMotiveView","BuffView","PurchaseView","CollectView","Bubble","ClickCircle","Diamond","Garden","Oxy","Plant","PopupEcoTip","PopupText","Tier","ConfirmView","PlantItem","PlantView","RankItem","RankView","SubDisplay","RewardView","ShopItem","ShopView","SignInItem","SignInView","StoreItem","StoreView","TeachView","TestView","BottomToolBar","MiddleToolBar","TopToolBar","UIManager"]);